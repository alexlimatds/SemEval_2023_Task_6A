RESULTS REPORT
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Chunk layout: Cohan
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 512
Max sentence length: 85
Max sentences per chunk: 7
Batch size: 4
Dropout rate: 0.1
Learning rate: 1e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 01h35m00s
GPU name: NVIDIA GeForce GTX 1080 Ti
GPU memory: 10.92

Averages:
Epoch Train loss    std    Test loss    std    P (micro)  P std  R (micro)  R std  F1 (micro)  F1 std P (weighted)  P std  R (weighted)  R std  F1 (weighted)  F1 std
   1   1.080039   0.016046  0.861538  0.013304   0.7193   0.0032   0.7193   0.0032   0.7193    0.0032    0.6885     0.0072    0.7193     0.0032     0.6886     0.0054
   2   0.840765   0.009107  0.888765  0.018064   0.7265   0.0057   0.7265   0.0057   0.7265    0.0057    0.7093     0.0068    0.7265     0.0057     0.6992     0.0086
   3   0.770550   0.006372  0.886193  0.016107   0.7204   0.0027   0.7204   0.0027   0.7204    0.0027    0.6964     0.0089    0.7204     0.0027     0.6936     0.0041
   4   0.708722   0.008233  0.895146  0.004223   0.7192   0.0052   0.7192   0.0052   0.7192    0.0052    0.6973     0.0087    0.7192     0.0052     0.6961     0.0070

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[817  21  18  48   6   0   1   0  45  13   0  11   6]
 [ 30  26   1   9   0   0   0   0   4   0   0   0   0]
 [ 14  16   5   2   1   0   0   0   0   0   0   0   0]
 [ 75   6   3 468   7  10   7   0   5   0   0   0   0]
 [ 10   0   1  14  23   1   0   0   0   0   0   0   2]
 [ 10   0   0  15   1 122   8   0   2   3   0  31   0]
 [  5   0   0  17   0  25 457   0   5   0   0   0   0]
 [  7   2   0   0   0   0   0   0   0   3   0   0   0]
 [ 74   1   0   1   0   0   0   0  65   0   0   1   0]
 [ 39   0   0   0   0   0   0   0   0  11   0  22   0]
 [ 33   1   0  61   4   6   1   0  10   0   0   0   0]
 [  9   0   0   0   0   3   0   0   0  18   0  62   0]
 [ 16   1   0   1   0   0   0   0   1   0   0   1   9]]
Epoch 2:
[[874   4  11  53   2   1   1   0  18   7   0  12   3]
 [ 39  12   3  11   0   0   0   0   4   0   0   0   1]
 [ 19   6  11   1   1   0   0   0   0   0   0   0   0]
 [ 84   0   5 464   0  10  12   0   1   0   1   0   4]
 [ 13   0   1  17  18   1   0   0   0   0   0   0   1]
 [ 13   0   0  11   1 122   9   0   2   1   3  30   0]
 [  5   0   0   9   0  25 465   0   5   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 95   1   0   6   0   0   0   0  39   0   0   1   0]
 [ 37   0   0   0   0   2   0   0   0   5   0  28   0]
 [ 35   0   0  65   0   2   2   0   4   0   8   0   0]
 [  8   0   0   0   0   4   0   0   0   5   0  75   0]
 [ 19   0   0   1   0   1   0   0   1   0   0   0   7]]
Epoch 3:
[[870  21   3  26   9   2   1   0  27   0   1  23   3]
 [ 32  21   1   9   0   2   0   0   4   0   0   0   1]
 [ 20  14   2   1   1   0   0   0   0   0   0   0   0]
 [ 92   9   0 436  14   7  12   0   1   0  10   0   0]
 [ 10   0   0  12  27   1   0   0   0   0   0   0   1]
 [ 12   0   0  12   2 123   9   0   2   0   2  30   0]
 [ 10   0   0  16   0  23 453   0   0   0   0   0   7]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 88   4   0   1   0   0   0   0  48   0   0   1   0]
 [ 36   0   0   0   0   3   0   0   0   0   0  33   0]
 [ 35   1   0  57   5   4   1   0   9   0   4   0   0]
 [  7   0   0   0   0   6   0   0   0   0   0  79   0]
 [ 16   3   0   0   0   1   0   0   1   0   1   0   7]]
Epoch 4:
[[838  13  11  57   9   2   1   0  26   6   1  19   3]
 [ 34  16   3  10   0   2   0   0   4   0   0   0   1]
 [ 15  10   9   2   1   0   0   0   0   1   0   0   0]
 [ 74   6   0 460   7   7  12   0   1   0  10   0   4]
 [  9   0   0  15  24   1   0   0   0   0   0   0   2]
 [  9   0   0  13   2 113  17   0   2   1   3  32   0]
 [ 10   0   0  16   0  19 457   0   0   0   0   0   7]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 95   1   0   6   0   0   0   0  39   0   0   1   0]
 [ 35   0   0   0   0   2   0   0   0   3   0  32   0]
 [ 39   1   0  58   1   4   1   0   4   0   8   0   0]
 [  6   0   0   0   0   4   0   0   0   6   0  76   0]
 [ 16   0   0   1   0   1   0   0   0   0   1   0  10]]
=> Iteration 1:
Epoch 1:
[[827   2  21  72   6   3   1   0   7   3  16  21   7]
 [ 30  14   3  13   5   0   0   0   4   0   0   0   1]
 [ 16   8  11   2   1   0   0   0   0   0   0   0   0]
 [ 44   0   5 485  10   7  16   0   0   0  10   0   4]
 [  7   0   0  12  29   1   0   0   0   0   0   0   2]
 [  7   0   0  19   1 119   9   0   2   1   0  34   0]
 [ 12   0   0  12   0  22 463   0   0   0   0   0   0]
 [  7   0   0   0   0   0   0   0   0   3   2   0   0]
 [ 96   0   0  12   0   3   0   0  23   1   6   1   0]
 [ 22   0   0   6   0   0   0   0   0  10   0  34   0]
 [ 29   0   0  81   0   0   2   0   0   0   4   0   0]
 [  3   0   0   0   0   4   0   0   0   5   0  80   0]
 [ 14   0   1   0   0   0   0   0   0   1   1   1  11]]
Epoch 2:
[[879   7  11  36   6   0   1   0  12   0   5  26   3]
 [ 38  12   3  12   0   0   0   0   4   0   0   0   1]
 [ 18   8   9   1   1   0   0   0   0   0   0   1   0]
 [ 74   2   0 457  10  15  10   0   1   0  12   0   0]
 [  8   0   0  11  28   2   0   0   0   0   0   0   2]
 [  8   0   0  11   1 125   7   0   2   0   2  36   0]
 [ 17   0   0  11   0  30 451   0   0   0   0   0   0]
 [  9   0   0   0   0   0   0   0   0   3   0   0   0]
 [ 90   0   0   2   0   0   0   0  45   1   0   4   0]
 [ 27   0   0   0   0   0   0   0   0   5   0  40   0]
 [ 35   0   0  56   0   7   2   0   4   0  12   0   0]
 [  2   0   0   0   0   3   0   0   0   2   0  85   0]
 [ 16   0   0   0   0   0   0   0   0   0   1   2  10]]
Epoch 3:
[[884   6   5  18  10   1   1   0  29   3   1  19   9]
 [ 35  16   2  11   0   0   0   0   5   0   0   0   1]
 [ 22  10   4   1   1   0   0   0   0   0   0   0   0]
 [ 78   6   3 437  21   6  15   0   1   0  12   0   2]
 [  8   0   0   8  32   1   0   0   0   0   0   0   2]
 [ 11   0   0  10   4 121  14   0   3   0   2  27   0]
 [ 17   0   0  12   1  22 457   0   0   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 90   1   0   1   0   0   0   0  49   0   0   1   0]
 [ 36   0   0   0   0   2   0   0   0   2   0  32   0]
 [ 43   1   0  52   5   2   2   0   4   0   7   0   0]
 [ 10   0   0   0   0   9   0   0   0   2   0  71   0]
 [ 15   0   1   0   0   1   0   0   0   0   1   0  11]]
Epoch 4:
[[854   6   8  49   6   1   1   0  27   7   0  18   9]
 [ 33  16   3  12   0   0   0   0   5   0   0   0   1]
 [ 19   8   8   1   1   0   0   0   0   1   0   0   0]
 [ 71   4   5 464   8   3  12   0   1   0   7   0   6]
 [  8   0   0  16  24   1   0   0   0   0   0   0   2]
 [ 10   0   0  18   1 116   9   0   3   1   3  31   0]
 [ 17   0   0  16   0  23 453   0   0   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 84   1   0   1   0   0   0   0  54   1   0   1   0]
 [ 31   0   0   0   0   2   0   0   0   6   0  33   0]
 [ 40   1   0  62   0   0   1   0   4   0   8   0   0]
 [  4   0   0   0   0   7   0   0   0   8   0  73   0]
 [ 15   0   1   0   0   1   0   0   0   0   1   0  11]]
=> Iteration 2:
Epoch 1:
[[868   4   0  62   2   0   1   0  22  13   1  11   2]
 [ 38   8   2  18   0   0   0   0   4   0   0   0   0]
 [ 24   8   4   1   1   0   0   0   0   0   0   0   0]
 [ 69   2   0 470   4  10  12   0   1   0   9   0   4]
 [  9   0   0  18  21   1   0   0   0   0   0   0   2]
 [ 10   0   0  15   1 121   9   0   2   3   0  31   0]
 [ 10   0   0  12   0  22 465   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 99   0   0   2   0   0   0   0  40   0   0   1   0]
 [ 36   0   0   0   0   0   0   0   0   7   0  29   0]
 [ 38   0   0  66   0   6   2   0   4   0   0   0   0]
 [  7   0   0   0   0   3   0   0   0   9   0  73   0]
 [ 19   0   0   0   0   0   0   0   0   0   1   1   8]]
Epoch 2:
[[822   6   3 107   6   1   1   0   7  15   1  10   7]
 [ 37  10   3  15   0   0   0   0   4   0   0   0   1]
 [ 18   8   8   2   1   0   0   0   0   1   0   0   0]
 [ 45   0   2 509   8   2   7   0   1   0   3   0   4]
 [  8   0   0  16  24   1   0   0   0   0   0   0   2]
 [  8   0   0  24   1 106  17   0   2   3   1  30   0]
 [ 10   0   0  19   0  16 464   0   0   0   0   0   0]
 [ 10   0   0   2   0   0   0   0   0   0   0   0   0]
 [ 93   0   0  16   0   0   0   0  32   0   0   1   0]
 [ 34   0   0   1   0   2   0   0   0   9   0  26   0]
 [ 29   0   0  78   0   0   1   0   4   0   4   0   0]
 [  6   0   0   0   0   4   0   0   0   8   0  74   0]
 [ 14   0   0   3   0   1   0   0   0   0   0   0  11]]
Epoch 3:
[[895   6  16  32   2   1   1   0   5  10   1  15   2]
 [ 38  14   5   9   0   0   0   0   4   0   0   0   0]
 [ 16   6  13   1   1   0   0   0   0   1   0   0   0]
 [ 89   4   5 443   0   3  16   0   1   0  20   0   0]
 [ 12   0   0  19  18   1   0   0   0   0   0   0   1]
 [ 11   0   0  17   1 109  19   0   2   1   4  28   0]
 [ 10   0   0  16   0  16 467   0   0   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [115   1   0   1   0   0   0   0  24   0   0   1   0]
 [ 35   0   0   0   0   3   0   0   0   4   0  30   0]
 [ 37   1   0  53   0   0   1   0   4   0  20   0   0]
 [  6   0   0   0   0   9   0   0   0   8   0  69   0]
 [ 21   0   1   0   0   1   0   0   0   0   1   0   5]]
Epoch 4:
[[863  10   4  45   6   1   1   0  27  16   1   9   3]
 [ 37  16   3   9   0   0   0   0   4   0   0   0   1]
 [ 19   8   8   1   1   0   0   0   0   1   0   0   0]
 [ 78   4   5 449  10   6  14   0   1   0  10   0   4]
 [  9   0   0  13  26   1   0   0   0   0   0   0   2]
 [ 11   0   0  12   1 112  18   0   2   4   3  29   0]
 [ 10   0   0  19   0  14 459   0   0   0   0   0   7]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 82   1   0   6   0   0   0   0  51   1   0   1   0]
 [ 31   0   0   0   0   2   0   0   0  16   0  23   0]
 [ 37   1   0  58   0   2   1   0   4   0  13   0   0]
 [  4   0   0   0   0   4   0   0   0  15   0  69   0]
 [ 16   0   1   0   0   1   0   0   0   0   1   0  10]]
=> Iteration 3:
Epoch 1:
[[930   4   0  26   6   1   1   0   5   5   1   6   1]
 [ 43  10   0  13   0   0   0   0   4   0   0   0   0]
 [ 24  12   0   1   1   0   0   0   0   0   0   0   0]
 [ 99   2   0 457   1   8  10   0   1   0   3   0   0]
 [ 13   0   0  17  20   1   0   0   0   0   0   0   0]
 [ 12   0   0  17   1 127   8   0   2   2   1  22   0]
 [ 17   0   0  14   0  25 453   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [116   0   0   1   0   0   0   0  24   0   0   1   0]
 [ 46   0   0   0   0   4   0   0   0   4   0  18   0]
 [ 40   0   0  66   0   0   2   0   4   0   4   0   0]
 [ 18   0   0   0   0  13   0   0   0   4   0  57   0]
 [ 24   0   0   1   0   1   0   0   0   0   0   0   3]]
Epoch 2:
[[865  22   5  44   6   1   1   0  15  17   1   6   3]
 [ 28  17   2  18   0   0   0   0   4   0   0   0   1]
 [ 19   8   9   1   1   0   0   0   0   0   0   0   0]
 [ 62   0   5 490   1   2  10   0   1   0  10   0   0]
 [  8   0   0  21  20   1   0   0   0   0   0   0   1]
 [  8   0   0  23   1 108  15   0   3   8   2  24   0]
 [ 17   0   0  16   0  14 462   0   0   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 87   1   0   2   0   0   0   0  51   1   0   0   0]
 [ 40   0   0   0   0   2   0   0   0  24   0   6   0]
 [ 38   0   0  68   0   0   2   0   4   0   4   0   0]
 [  9   0   0   0   0   4   0   0   0  29   0  50   0]
 [ 19   0   1   0   0   1   0   0   0   0   1   0   7]]
Epoch 3:
[[884  15   0  29   6   1   1   0  25  15   1   6   3]
 [ 38  16   2   9   0   0   0   0   4   0   0   0   1]
 [ 18  13   4   1   1   0   0   0   0   1   0   0   0]
 [ 86  14   0 446  10   2  12   0   1   0  10   0   0]
 [ 10   0   0  12  26   1   0   0   0   0   0   0   2]
 [ 12   0   0  19   1 112  11   0   2   4   3  28   0]
 [ 17   0   0  19   0  17 456   0   0   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 93   1   0   1   0   0   0   0  46   0   0   1   0]
 [ 36   0   0   0   0   2   0   0   0  10   0  24   0]
 [ 43   1   0  59   0   0   1   0   4   0   8   0   0]
 [  7   0   0   0   0   4   0   0   0  13   0  68   0]
 [ 16   1   0   0   0   1   0   0   0   0   1   0  10]]
Epoch 4:
[[875  11   5  37   6   1   1   0  22  10   1  14   3]
 [ 38  14   2  11   0   0   0   0   4   0   0   0   1]
 [ 21   8   6   1   1   0   0   0   0   1   0   0   0]
 [ 80   5   5 445  10   2  19   0   1   0  10   0   4]
 [  9   0   0  13  26   1   0   0   0   0   0   0   2]
 [ 11   0   0  19   1 114   9   0   2   2   3  31   0]
 [ 12   0   0  16   0  20 456   0   0   0   0   0   5]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 88   1   0   1   0   0   0   0  51   0   0   1   0]
 [ 35   0   0   0   0   2   0   0   0   5   0  30   0]
 [ 42   0   0  60   0   0   2   0   4   0   8   0   0]
 [  9   0   0   0   0   4   0   0   0   7   0  72   0]
 [ 16   0   1   0   0   1   0   0   0   0   1   0  10]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.069092   0.857841   0.714533   0.714533    0.714533      0.681276      0.714533       0.694679
Iteration 1    1.075317   0.860983   0.718339   0.718339    0.718339      0.698338      0.718339       0.691669
Iteration 2    1.068315   0.845158   0.721453   0.721453    0.721453      0.681775      0.721453       0.687995
Iteration 3    1.107431   0.882172   0.722837   0.722837    0.722837      0.692445      0.722837       0.680143

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.837346   0.911508   0.726644   0.726644    0.726644      0.711343      0.726644       0.696524
Iteration 1    0.831130   0.878815   0.732872   0.732872    0.732872      0.718803      0.732872       0.708156
Iteration 2    0.838865   0.899794   0.717301   0.717301    0.717301      0.700130      0.717301       0.686341
Iteration 3    0.855718   0.864944   0.729066   0.729066    0.729066      0.706898      0.729066       0.705740

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.762694   0.889643   0.716263   0.716263    0.716263      0.681443      0.716263       0.688062
Iteration 1    0.771063   0.863649   0.723529   0.723529    0.723529      0.698247      0.723529       0.697056
Iteration 2    0.768159   0.908688   0.720069   0.720069    0.720069      0.701724      0.720069       0.691296
Iteration 3    0.780283   0.882794   0.721799   0.721799    0.721799      0.704274      0.721799       0.698176

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.700048   0.893377   0.710381   0.710381    0.710381      0.683666      0.710381       0.685215
Iteration 1    0.704852   0.891217   0.722145   0.722145    0.722145      0.702306      0.722145       0.699257
Iteration 2    0.707845   0.902270   0.723875   0.723875    0.723875      0.706906      0.723875       0.704382
Iteration 3    0.722144   0.893719   0.720415   0.720415    0.720415      0.696225      0.720415       0.695555

