RESULTS REPORT
Model: Longformer
Encoder: allenai/longformer-base-4096
Chunk layout: Cohan
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 1024
Max sentence length: 90
Max sentences per chunk: 16
Batch size: 2
Dropout rate: 0.1
Learning rate: 2e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 03h34m54s
GPU name: NVIDIA GeForce GTX 1080 Ti
GPU memory: 10.92

Averages:
Epoch Train loss    std    Test loss    std    P (micro)  P std  R (micro)  R std  F1 (micro)  F1 std P (weighted)  P std  R (weighted)  R std  F1 (weighted)  F1 std
   1   1.270443   0.018802  0.956609  0.067123   0.7141   0.0287   0.7141   0.0287   0.7141    0.0287    0.7038     0.0187    0.7141     0.0287     0.6761     0.0339
   2   0.945083   0.014190  0.842770  0.023548   0.7365   0.0100   0.7365   0.0100   0.7365    0.0100    0.7371     0.0062    0.7365     0.0100     0.7206     0.0067
   3   0.839680   0.013135  0.878907  0.113188   0.7441   0.0218   0.7441   0.0218   0.7441    0.0218    0.7414     0.0102    0.7441     0.0218     0.7217     0.0254
   4   0.736806   0.012394  0.787177  0.019410   0.7636   0.0042   0.7636   0.0042   0.7636    0.0042    0.7495     0.0042    0.7636     0.0042     0.7487     0.0045

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[939   1   0  28   0   1   8   0   4   2   0   3   0]
 [ 54   3   0   9   0   3   0   0   1   0   0   0   0]
 [ 28   8   0   2   0   0   0   0   0   0   0   0   0]
 [114   0   0 438   5   4  20   0   0   0   0   0   0]
 [ 12   0   0   4  31   0   4   0   0   0   0   0   0]
 [ 12   0   0   8   2 141  22   0   4   0   0   3   0]
 [  1   0   0   5   0   1 502   0   0   0   0   0   0]
 [ 11   0   0   0   0   0   0   0   0   1   0   0   0]
 [102   0   0  13   0   1   4   0  19   2   1   0   0]
 [ 53   0   0   0   0   0   0   0   0  16   0   3   0]
 [ 43   0   0  58   1   0   3   0   0   0  11   0   0]
 [ 13   0   0   2   0   7   0   0   0   8   0  62   0]
 [ 27   0   0   1   0   0   1   0   0   0   0   0   0]]
Epoch 2:
[[743  50   0 109   3  30   0   0  19  13   4   4  11]
 [ 25  19   1  14   1   4   0   0   5   0   0   1   0]
 [  8  25   1   2   0   1   0   0   0   0   0   1   0]
 [ 59  11   0 458   5  12  11   0   0   0  22   0   3]
 [  6   0   0   4  35   5   1   0   0   0   0   0   0]
 [  4   0   0   4   0 176   3   0   4   0   0   1   0]
 [  2   0   0   5   0  23 478   0   0   0   1   0   0]
 [  9   2   0   0   0   0   0   0   1   0   0   0   0]
 [ 51   7   0   6   0   1   0   0  62   1  11   1   2]
 [ 38   0   0   0   0   3   0   0   0  24   0   7   0]
 [ 31   0   0  33   1   1   3   0   0   0  47   0   0]
 [  3   1   0   0   0  18   0   0   0   4   0  66   0]
 [  9   1   0   1   0   1   0   0   0   0   0   0  17]]
Epoch 3:
[[905  20   1  21   3   0   1   0  10  13   0   6   6]
 [ 48  14   0   2   2   2   0   0   2   0   0   0   0]
 [ 15  19   0   1   1   1   0   0   0   0   0   1   0]
 [138  17   0 373   6   4  20   0   0   2  18   1   2]
 [  9   0   0   5  36   0   1   0   0   0   0   0   0]
 [ 10   1   0  12   4 114  41   0   4   0   0   6   0]
 [  1   1   0   4   0   1 502   0   0   0   0   0   0]
 [  8   2   0   0   0   0   0   0   1   1   0   0   0]
 [ 94   1   0   0   0   1   0   0  43   2   0   1   0]
 [ 35   0   0   0   0   1   0   0   0  31   0   5   0]
 [ 38   0   0  32   1   0   3   0   1   0  41   0   0]
 [  5   1   0   1   0   1   0   0   0  10   0  74   0]
 [ 17   0   0   0   0   1   0   0   0   0   0   0  11]]
Epoch 4:
[[846  20   3  68   2   3   0   0  15  14   1   8   6]
 [ 34  16   0  10   2   3   0   0   5   0   0   0   0]
 [ 13  20   1   2   0   1   0   0   0   0   0   1   0]
 [ 82   9   0 449   5   6   9   0   0   2  16   1   2]
 [  9   0   0   7  34   0   1   0   0   0   0   0   0]
 [  8   1   0   9   3 151   8   0   4   0   0   8   0]
 [  0   1   0   9   0  11 488   0   0   0   0   0   0]
 [  9   2   0   0   0   0   0   0   1   0   0   0   0]
 [ 72   2   0   6   0   1   0   0  58   1   1   1   0]
 [ 28   1   0   1   0   1   0   0   0  33   0   8   0]
 [ 35   0   0  45   1   0   2   0   0   0  32   1   0]
 [  3   1   0   0   0   3   0   0   0  10   0  75   0]
 [ 12   0   0   1   0   1   0   0   0   0   0   0  15]]
=> Iteration 1:
Epoch 1:
[[957  15   0  12   0   0   2   0   0   0   0   0   0]
 [ 63   4   0   3   0   0   0   0   0   0   0   0   0]
 [ 20  17   0   1   0   0   0   0   0   0   0   0   0]
 [216  16   0 320   5   3  18   0   0   0   3   0   0]
 [ 21   0   0   2  27   0   1   0   0   0   0   0   0]
 [ 49   2   0   8   0  77  54   0   0   0   0   2   0]
 [  2   0   0   0   0   0 506   0   1   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [135   0   0   0   0   0   0   0   7   0   0   0   0]
 [ 70   0   0   0   0   0   0   0   0   2   0   0   0]
 [ 82   0   0  13   0   0   5   0   2   0  14   0   0]
 [ 65   0   0   0   0   0   0   0   0   3   0  24   0]
 [ 29   0   0   0   0   0   0   0   0   0   0   0   0]]
Epoch 2:
[[933   7   0  20   1   0   5   0   4  10   0   2   4]
 [ 50   6   0  11   1   2   0   0   0   0   0   0   0]
 [ 20  14   0   2   0   1   0   0   0   1   0   0   0]
 [107   2   0 423   5   2  37   0   0   0   3   0   2]
 [  8   0   0   7  34   0   2   0   0   0   0   0   0]
 [  9   0   0  15   2 117  41   0   3   2   0   3   0]
 [  0   0   0   1   0   0 508   0   0   0   0   0   0]
 [ 10   1   0   0   0   0   0   0   0   1   0   0   0]
 [ 95   0   0   8   0   0   1   0  33   2   3   0   0]
 [ 39   0   0   0   0   0   1   0   0  32   0   0   0]
 [ 36   0   0  55   1   0   5   0   2   0  17   0   0]
 [  8   0   0   1   0   1   0   0   0  22   0  60   0]
 [ 17   1   0   1   0   0   1   0   0   1   0   0   8]]
Epoch 3:
[[860  12   0  50   1   0   1   0  33  12   1  12   4]
 [ 30  13   0  15   2   2   0   0   8   0   0   0   0]
 [ 18  16   0   2   0   1   0   0   0   0   0   1   0]
 [ 91   2   0 435   6   5  12   0   1   0  24   3   2]
 [  9   0   0   4  37   0   1   0   0   0   0   0   0]
 [  7   0   0   9   3 144  16   0   4   0   0   9   0]
 [  1   0   0   5   0   3 498   0   0   0   2   0   0]
 [  7   1   0   0   0   0   0   0   3   1   0   0   0]
 [ 68   1   0   0   0   0   0   0  69   0   3   0   1]
 [ 33   0   0   0   0   0   0   0   1  27   0  11   0]
 [ 35   0   0  34   1   0   2   0   7   0  37   0   0]
 [  3   0   0   0   0   2   0   0   0   7   0  80   0]
 [ 11   0   0   1   0   1   0   0   0   0   0   0  16]]
Epoch 4:
[[857  29   1  37   1   5   1   0  22  18   1   8   6]
 [ 33  14   0  12   1   3   0   0   7   0   0   0   0]
 [ 17  17   0   2   0   1   0   0   0   0   0   1   0]
 [ 95   8   0 432   5   6  12   0   0   1  18   2   2]
 [  8   0   0   5  35   2   1   0   0   0   0   0   0]
 [  6   1   0   7   2 151  17   0   4   0   0   4   0]
 [  2   1   0   7   0   4 495   0   0   0   0   0   0]
 [  6   2   0   0   0   0   0   0   2   2   0   0   0]
 [ 71   1   0   2   0   0   0   0  63   3   1   0   1]
 [ 32   1   0   0   0   1   0   0   0  30   0   8   0]
 [ 36   0   0  45   1   0   2   0   3   0  29   0   0]
 [  2   0   0   0   0   3   0   0   0  11   0  76   0]
 [  9   1   0   2   0   1   0   0   0   1   0   0  15]]
=> Iteration 2:
Epoch 1:
[[741  53   0 123   4   7   4   0  40   7   0   2   5]
 [ 10  22   0  28   2   3   0   0   5   0   0   0   0]
 [  7  27   0   3   0   1   0   0   0   0   0   0   0]
 [ 45   6   0 495   6   9  16   0   1   0   0   0   3]
 [  5   0   0  11  35   0   0   0   0   0   0   0   0]
 [  4   0   0   6   1 128  49   0   4   0   0   0   0]
 [  0   0   0   1   0   5 503   0   0   0   0   0   0]
 [  3   3   0   3   0   0   0   0   3   0   0   0   0]
 [ 39   4   0  36   0   1   0   0  61   1   0   0   0]
 [ 45   2   0   2   0   3   0   0   0  14   0   6   0]
 [ 27   0   0  85   1   0   3   0   0   0   0   0   0]
 [  9   0   0   2   0  44   0   0   0   3   0  34   0]
 [  7   1   0   3   0   1   0   0   2   0   0   0  15]]
Epoch 2:
[[851  37   9  35   1  19   0   0   2  14   0   5  13]
 [ 30  25   2   9   1   3   0   0   0   0   0   0   0]
 [  4  28   3   2   0   0   0   0   0   0   0   1   0]
 [ 96  28   0 405   5   7  10   0   0   1  24   0   5]
 [  7   0   0   7  33   4   0   0   0   0   0   0   0]
 [  6   0   0   9   0 134  37   0   2   0   0   4   0]
 [  0   1   0   8   0   1 498   0   0   0   1   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [100   4   0   0   0   1   0   0  32   2   0   0   3]
 [ 35   0   1   0   0   2   0   0   0  26   0   8   0]
 [ 39   0   0  37   1   0   3   0   0   0  36   0   0]
 [  2   0   0   0   0  10   0   0   0  10   0  70   0]
 [ 10   3   0   0   0   1   0   0   0   0   0   0  15]]
Epoch 3:
[[911  11   4  33   0   2   0   0   6   9   0   3   7]
 [ 42   9   0  14   1   1   0   0   3   0   0   0   0]
 [ 20   9   6   2   0   0   0   0   0   0   0   1   0]
 [ 84   8   0 467   5   5   7   0   0   0   2   0   3]
 [  8   0   0   9  34   0   0   0   0   0   0   0   0]
 [ 10   0   0  18   3 119  28   0   3   0   0  11   0]
 [  2   0   0  28   0   3 476   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 91   0   0   1   0   0   0   0  49   1   0   0   0]
 [ 38   0   0   0   0   0   0   0   0  28   0   6   0]
 [ 37   0   0  62   1   0   1   0   6   0   9   0   0]
 [  5   0   0   0   0   2   0   0   0  14   0  71   0]
 [ 15   0   0   1   0   1   0   0   0   0   0   0  12]]
Epoch 4:
[[878  17   2  42   2   4   0   0  14  12   1   7   7]
 [ 37  14   0  11   1   2   0   0   5   0   0   0   0]
 [ 14  20   0   2   0   1   0   0   0   0   0   1   0]
 [ 78  13   0 446   5   6   9   0   0   0  19   3   2]
 [  7   0   0   8  36   0   0   0   0   0   0   0   0]
 [  7   0   0   8   3 152  11   0   3   1   0   7   0]
 [  2   0   0  16   0   8 482   0   0   0   1   0   0]
 [  8   2   0   0   0   0   0   0   1   1   0   0   0]
 [ 71   0   0   0   0   1   0   0  67   2   1   0   0]
 [ 33   0   0   0   0   1   0   0   1  30   0   7   0]
 [ 35   0   0  41   1   0   1   0   1   0  37   0   0]
 [  2   0   0   0   0   5   0   0   0  11   0  74   0]
 [ 14   1   0   2   0   1   0   0   0   0   0   0  11]]
=> Iteration 3:
Epoch 1:
[[818   3   0  81   1  16   5   0  17  14   0  12  19]
 [ 33   3   0  24   1   4   0   0   4   0   0   0   1]
 [ 14   8   0  14   0   1   0   0   0   0   0   1   0]
 [ 96   0   0 443   7   6  13   0   3   0   7   0   6]
 [ 10   0   0   6  31   4   0   0   0   0   0   0   0]
 [  5   0   0   7   0 154  17   0   3   0   0   6   0]
 [ 11   0   0   5   0   3 488   0   1   0   1   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 88   0   0   7   3   1   0   0  38   1   1   1   2]
 [ 38   0   0   2   0   0   0   0   1  16   0  15   0]
 [ 51   0   0  41   1   1   1   0   5   0  13   3   0]
 [  2   0   0   0   0   5   0   0   0   3   0  82   0]
 [  6   0   0   0   0   0   0   0   1   0   0   1  21]]
Epoch 2:
[[733 106   0  89   1  18   1   0  20   4   0  14   0]
 [ 16  27   0  18   1   4   0   0   4   0   0   0   0]
 [  1  33   0   2   0   1   0   0   0   0   0   1   0]
 [ 44  14   0 477   5   9  12   0   0   0  12   8   0]
 [  9   1   0   8  30   3   0   0   0   0   0   0   0]
 [  3   0   0   8   0 165   6   0   4   0   0   6   0]
 [  2   0   0  11   0  14 481   0   0   0   1   0   0]
 [  6   4   0   0   0   0   0   0   1   0   0   1   0]
 [ 66  14   0   3   0   1   0   0  56   0   0   2   0]
 [ 36   2   0   1   0   3   0   0   0   4   0  26   0]
 [ 32   0   0  40   1   2   2   0   6   0  31   2   0]
 [  1   0   0   0   0   6   0   0   0   0   0  85   0]
 [ 23   3   0   2   0   1   0   0   0   0   0   0   0]]
Epoch 3:
[[940  12   0   9   0   1   0   0   2  16   0   6   0]
 [ 59   6   0   1   1   2   0   0   1   0   0   0   0]
 [ 16  18   0   1   1   1   0   0   0   0   0   1   0]
 [177  16   0 360   7   5   5   0   0   2   4   4   1]
 [ 12   0   0   4  35   0   0   0   0   0   0   0   0]
 [ 16   0   0   6   0 154   3   0   2   0   0  11   0]
 [ 29   0   0  24   0  45 409   0   0   0   0   2   0]
 [ 11   0   0   0   0   0   0   0   0   1   0   0   0]
 [120   0   0   0   0   1   0   0  19   2   0   0   0]
 [ 41   0   0   0   0   1   0   0   0  26   0   4   0]
 [ 57   0   0  30   0   0   0   0   3   0  25   1   0]
 [  5   0   0   0   0   3   0   0   0   9   0  75   0]
 [ 26   0   0   0   0   1   0   0   0   0   0   0   2]]
Epoch 4:
[[858  18   1  53   1   3   0   0  19  16   1  10   6]
 [ 40  10   0  12   2   2   0   0   4   0   0   0   0]
 [ 12  21   1   1   1   1   0   0   0   0   0   1   0]
 [ 78   8   0 460   5   5   9   0   0   2  11   1   2]
 [  9   0   0   5  35   1   1   0   0   0   0   0   0]
 [  5   0   0  11   1 153  10   0   4   0   0   8   0]
 [  3   0   0  15   0   7 484   0   0   0   0   0   0]
 [  9   1   0   0   0   0   0   0   1   1   0   0   0]
 [ 73   0   0   1   0   1   0   0  63   3   1   0   0]
 [ 34   0   0   2   0   1   0   0   0  27   0   8   0]
 [ 38   0   0  48   1   0   2   0   0   0  27   0   0]
 [  4   0   0   0   0   3   0   0   0   9   0  76   0]
 [ 15   0   0   2   0   1   0   0   0   0   0   0  11]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.239753   0.971443   0.748097   0.748097    0.748097      0.730209      0.748097       0.703049
Iteration 1    1.272130   1.058463   0.670588   0.670588    0.670588      0.708426      0.670588       0.618760
Iteration 2    1.289882   0.915863   0.708651   0.708651    0.708651      0.678476      0.708651       0.683590
Iteration 3    1.280008   0.880666   0.729066   0.729066    0.729066      0.698085      0.729066       0.699197

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.932376   0.802955   0.735640   0.735640    0.735640      0.738880      0.735640       0.729438
Iteration 1    0.939556   0.848231   0.751211   0.751211    0.751211      0.740311      0.751211       0.718559
Iteration 2    0.969153   0.857408   0.736332   0.736332    0.736332      0.742463      0.736332       0.723332
Iteration 3    0.939247   0.862484   0.722837   0.722837    0.722837      0.726622      0.722837       0.711197

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.819151   0.825148   0.741869   0.741869    0.741869      0.738357      0.741869       0.722795
Iteration 1    0.838665   0.792852   0.766782   0.766782    0.766782      0.746125      0.766782       0.751176
Iteration 2    0.854666   0.823961   0.758131   0.758131    0.758131      0.754456      0.758131       0.731485
Iteration 3    0.846239   1.073668   0.709689   0.709689    0.709689      0.726684      0.709689       0.681542

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.728501   0.773914   0.760554   0.760554    0.760554      0.748905      0.760554       0.746740
Iteration 1    0.722626   0.798498   0.760208   0.760208    0.760208      0.743151      0.760208       0.745665
Iteration 2    0.741281   0.763643   0.770588   0.770588    0.770588      0.754480      0.770588       0.756395
Iteration 3    0.754816   0.812653   0.762976   0.762976    0.762976      0.751629      0.762976       0.746029

