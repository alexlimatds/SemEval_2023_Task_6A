RESULTS REPORT
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Chunk layout: VanBerg
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 487
Max sentence length: 80
Max sentences per chunk: 2
Window length: 2
Batch size: 4
Dropout rate: 0.1
Learning rate: 1e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 04h45m33s
GPU name: NVIDIA GeForce GTX 1080 Ti
GPU memory: 10.92

Averages:
Epoch Train loss    std    Test loss    std    P (micro)  P std  R (micro)  R std  F1 (micro)  F1 std P (weighted)  P std  R (weighted)  R std  F1 (weighted)  F1 std
   1   0.999080   0.016264  0.922386  0.061836   0.7106   0.0179   0.7106   0.0179   0.7106    0.0179    0.7171     0.0076    0.7106     0.0179     0.6923     0.0182
   2   0.925059   0.022281  1.037458  0.096271   0.6755   0.0254   0.6755   0.0254   0.6755    0.0254    0.6818     0.0158    0.6755     0.0254     0.6533     0.0316
   3   0.937323   0.015561  1.071787  0.037409   0.6795   0.0069   0.6795   0.0069   0.6795    0.0069    0.6636     0.0225    0.6795     0.0069     0.6451     0.0124
   4   0.869984   0.011714  1.005968  0.005972   0.6958   0.0055   0.6958   0.0055   0.6958    0.0055    0.6759     0.0101    0.6958     0.0055     0.6684     0.0050

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[843  13   0  46   6   4   1   0  47   7   8   7   4]
 [ 38   7   3   4   3   2   0   0   9   0   3   1   0]
 [ 19   8   9   1   1   0   0   0   0   0   0   0   0]
 [113   3   0 388  13  16   6   0  13   0  22   3   4]
 [  8   0   0   8  32   2   0   0   0   0   0   0   1]
 [  7   0   0   4   2 148   5   0   4   0   0  22   0]
 [ 12   1   0   7   0  15 465   0   6   0   3   0   0]
 [ 10   1   0   0   0   0   0   0   0   1   0   0   0]
 [ 60   0   0   0   0   0   0   0  80   0   0   2   0]
 [ 32   0   0   0   0   0   2   0   0  18   0  20   0]
 [ 39   0   0  29   1   8   2   0   8   0  26   3   0]
 [  2   0   0   0   0   2   0   0   0   0   0  88   0]
 [ 21   0   0   0   0   0   0   0   0   0   1   1   6]]
Epoch 2:
[[696  19   1 113   4   4   6   0 111   1   4   6  21]
 [ 30   6   1  14   1   0   1   0  10   0   6   0   1]
 [ 16  14   2   3   1   0   0   0   0   0   0   0   2]
 [ 63   4   0 459   3   5  12   0  15   0  12   4   4]
 [  6   0   0  17  25   0   0   0   0   0   1   0   2]
 [  3   0   0  24   0 138   9   0   3   0   0  15   0]
 [  7   0   0  22   0  11 462   0   5   0   1   0   1]
 [  4   2   0   0   0   0   0   0   6   0   0   0   0]
 [ 31   0   0   7   0   0   1   0  96   0   2   0   5]
 [ 33   0   0   5   0   0   2   0   7   1   0  24   0]
 [ 34   0   0  54   0   2   3   0  11   0  12   0   0]
 [  4   0   0   0   0  10   0   0   1   1   0  76   0]
 [ 10   0   0   0   0   1   0   0   4   0   0   0  14]]
Epoch 3:
[[748   5   0 195  12   2   7   0   6   0   0   4   7]
 [ 40   3   0  24   3   0   0   0   0   0   0   0   0]
 [ 27   2   0   8   1   0   0   0   0   0   0   0   0]
 [ 68   2   0 487   8   3   4   0   0   0   2   3   4]
 [  8   0   0   9  33   0   0   0   0   0   0   0   1]
 [  8   0   0  29   1 118   9   0   0   0   0  27   0]
 [ 14   0   0  30   0  17 448   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [117   0   0  16   1   0   1   0   6   1   0   0   0]
 [ 46   0   0   7   0   0   0   0   0   0   0  19   0]
 [ 38   0   0  74   0   1   2   0   0   0   1   0   0]
 [  6   0   0   0   1   1   0   0   0   0   0  84   0]
 [ 20   0   0   1   0   1   0   0   0   0   0   0   7]]
Epoch 4:
[[807  23   0 100   6   3   3   0  35   0   3   4   2]
 [ 38  10   0  14   3   1   0   0   4   0   0   0   0]
 [ 22   9   2   4   1   0   0   0   0   0   0   0   0]
 [105   9   1 435   6  10   5   0   1   1   4   2   2]
 [ 11   0   0   8  29   2   0   0   0   0   0   0   1]
 [  9   0   0  21   1 129  14   0   1   0   0  17   0]
 [ 18   0   0  20   0  12 457   0   2   0   0   0   0]
 [  7   1   0   0   0   0   0   0   4   0   0   0   0]
 [ 86   0   0   4   1   0   0   0  50   1   0   0   0]
 [ 40   0   0   4   0   0   0   0   4   4   0  20   0]
 [ 47   0   0  54   0   5   2   0   2   0   6   0   0]
 [  6   0   0   0   1   9   0   0   0   0   0  76   0]
 [ 24   0   0   0   0   1   0   0   1   0   0   0   3]]
=> Iteration 1:
Epoch 1:
[[920  14   0  34   5   0   1   0   4   3   1   0   4]
 [ 52  13   0   5   0   0   0   0   0   0   0   0   0]
 [ 21  14   1   1   1   0   0   0   0   0   0   0   0]
 [158   8   0 385   9   7   2   0   0   0   8   0   4]
 [ 10   0   0   8  31   1   0   0   0   0   0   0   1]
 [ 12   1   1   1   2 144  13   0   0   2   0  16   0]
 [ 20   0   0  13   0   6 469   0   1   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [114   3   0   1   0   0   0   0  22   1   1   0   0]
 [ 51   0   0   0   0   0   0   0   0  16   0   5   0]
 [ 53   1   0  43   0   3   2   0   1   0  13   0   0]
 [  6   0   0   0   0   5   0   0   0  17   0  64   0]
 [ 24   0   0   0   0   1   0   0   0   0   0   0   4]]
Epoch 2:
[[847  12   1  41   8   3   0   0  65   4   4   0   1]
 [ 44   8   0   4   2   0   0   0  12   0   0   0   0]
 [ 24  10   1   2   1   0   0   0   0   0   0   0   0]
 [146   8   1 367   8   6   1   0  13   1  26   2   2]
 [ 11   0   0   5  33   1   0   0   0   0   1   0   0]
 [  7   0   1   4   2 153   5   0   3   1   2  14   0]
 [ 17   0   0  15   0  18 446   0  11   0   2   0   0]
 [  7   0   0   0   0   0   0   0   5   0   0   0   0]
 [ 59   0   0   0   0   0   0   0  82   1   0   0   0]
 [ 37   0   0   2   0   1   0   0  12  15   1   4   0]
 [ 50   0   0  24   0   6   0   0  10   1  25   0   0]
 [  7   0   0   0   1  11   0   0   2   9   0  62   0]
 [ 21   0   0   0   0   1   0   0   5   0   0   0   2]]
Epoch 3:
[[888  30   0  37   4   0   1   0  24   0   0   0   2]
 [ 51  15   0   2   1   0   0   0   1   0   0   0   0]
 [ 19  17   0   1   1   0   0   0   0   0   0   0   0]
 [195  28   0 335   6   6   5   0   1   0   1   2   2]
 [ 21   0   0   4  25   1   0   0   0   0   0   0   0]
 [ 15   3   0  15   0 130  13   0   1   1   0  14   0]
 [ 24   5   0  12   0  10 452   0   6   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [104   0   0   0   0   0   0   0  38   0   0   0   0]
 [ 54   0   0   3   0   1   0   0   2   7   0   5   0]
 [ 63   2   0  37   0   3   3   0   1   0   7   0   0]
 [ 18   0   0   0   0  11   0   0   0   3   0  60   0]
 [ 25   0   0   0   0   1   0   0   0   0   0   0   3]]
Epoch 4:
[[823  16   1  90   7   3   3   0  30   3   5   3   2]
 [ 44   9   0  10   2   1   0   0   4   0   0   0   0]
 [ 24   9   1   3   1   0   0   0   0   0   0   0   0]
 [106  11   0 425   7   9   7   0   1   1   7   3   4]
 [ 10   0   0  10  28   1   1   0   0   0   0   0   1]
 [  9   1   0  18   1 132  13   0   1   2   0  15   0]
 [ 16   0   0  19   0  11 461   0   2   0   0   0   0]
 [  7   2   0   0   0   0   0   0   3   0   0   0   0]
 [ 91   0   0   3   0   0   1   0  43   2   2   0   0]
 [ 42   0   0   3   0   0   0   0   2  10   1  14   0]
 [ 48   0   0  52   0   3   1   0   2   0   9   1   0]
 [  7   0   0   0   0  14   0   0   0   3   0  68   0]
 [ 22   0   0   0   0   1   1   0   1   0   0   0   4]]
=> Iteration 2:
Epoch 1:
[[811  10   0  23   3   6   0   0 105   1   0   3  24]
 [ 39  12   0   3   1   0   0   0  15   0   0   0   0]
 [ 20  16   0   1   1   0   0   0   0   0   0   0   0]
 [164   6   0 348  10  10   7   0  25   0   3   2   6]
 [ 10   0   0   7  30   2   0   0   0   0   0   0   2]
 [  9   0   0   2   2 147   4   0   5   0   0  23   0]
 [ 10   0   0  24   0  31 402   0  33   0   0   0   9]
 [  0   2   0   0   0   0   0   0  10   0   0   0   0]
 [ 23   1   0   0   0   0   0   0 116   1   0   0   1]
 [ 44   0   0   0   0   0   2   0   4   3   0  19   0]
 [ 42   1   0  33   1   6   7   0  19   0   6   1   0]
 [  6   0   0   0   0   1   0   0   1   0   0  84   0]
 [ 12   0   0   0   0   0   0   0   3   0   0   1  13]]
Epoch 2:
[[891  20   0  21   5  12  11   0   7  13   0   4   2]
 [ 52  14   0   1   3   0   0   0   0   0   0   0   0]
 [ 25  11   0   1   1   0   0   0   0   0   0   0   0]
 [214  21   0 283  13  24   0   0   1   3   5  14   3]
 [ 13   0   0   3  32   3   0   0   0   0   0   0   0]
 [  7   1   0   1   2 154   1   0   0   2   2  22   0]
 [ 48   5   0  29   0  86 336   0   4   0   1   0   0]
 [ 10   1   0   0   0   0   1   0   0   0   0   0   0]
 [118   1   0   0   0   0   4   0  17   2   0   0   0]
 [ 33   0   0   0   0   0   2   0   0  22   0  15   0]
 [ 62   0   0  20   2   6   0   0   2   3  10  11   0]
 [  3   0   0   0   0   2   0   0   0   9   0  78   0]
 [ 24   0   0   0   0   1   0   0   0   0   0   0   4]]
Epoch 3:
[[848   1   9  68   4  12  14   0  19   4   0   5   2]
 [ 55   3   2   6   3   1   0   0   0   0   0   0   0]
 [ 32   1   2   2   1   0   0   0   0   0   0   0   0]
 [117   4   4 408   7  25   5   0   1   1   2   4   3]
 [ 10   0   0   7  29   4   0   0   0   0   0   0   1]
 [  8   0   1   5   1 151  10   0   0   0   0  16   0]
 [ 19   0   0  24   0  34 428   0   4   0   0   0   0]
 [ 10   0   0   0   0   0   2   0   0   0   0   0   0]
 [ 93   0   0   1   0   1   8   0  37   2   0   0   0]
 [ 34   0   0   2   0   0   2   0   2   8   0  24   0]
 [ 41   0   0  49   0  18   0   0   3   2   1   2   0]
 [  5   0   0   0   0  14   0   0   0   1   0  72   0]
 [ 22   0   0   1   0   1   1   0   0   0   0   0   4]]
Epoch 4:
[[821  18   1  80   6   5  15   0  22   7   4   2   5]
 [ 47   9   0  10   3   1   0   0   0   0   0   0   0]
 [ 22  12   0   3   1   0   0   0   0   0   0   0   0]
 [111  13   0 414   8   8  10   0   2   2   5   2   6]
 [ 10   0   0   7  30   3   0   0   0   0   0   0   1]
 [  8   1   0  17   1 125  23   0   0   1   0  16   0]
 [ 10   0   0  26   0  10 456   0   6   0   1   0   0]
 [  8   1   0   0   0   0   1   0   2   0   0   0   0]
 [ 90   0   0   4   1   0   8   0  37   2   0   0   0]
 [ 37   0   0   3   0   1   2   0   2  13   0  14   0]
 [ 42   0   0  53   0   5   0   0   3   1  12   0   0]
 [  5   0   0   0   1  12   0   0   0   6   0  68   0]
 [ 22   0   0   1   0   1   1   0   0   0   0   0   4]]
=> Iteration 3:
Epoch 1:
[[704  37   0 155  11   3   9   0  30   4  18   7   8]
 [ 12  30   0  14   3   0   2   0   7   0   2   0   0]
 [  9  23   2   3   1   0   0   0   0   0   0   0   0]
 [ 32   9   0 471  10   8   7   0   0   0  38   2   4]
 [  5   0   0  11  33   1   0   0   0   0   0   0   1]
 [  5   1   0   8   3 150   8   0   1   0   2  14   0]
 [  5   0   0  10   0  12 473   0   6   0   3   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 61   3   0  12   0   1   1   0  62   0   1   1   0]
 [ 34   0   0   2   0   0   2   0   0   7   0  27   0]
 [ 33   0   0  34   1   4   3   0   4   0  36   1   0]
 [  1   0   0   1   0  15   0   0   0   0   0  75   0]
 [ 17   2   0   0   1   1   0   0   0   0   1   0   7]]
Epoch 2:
[[922  17   0  20   4   1   2   0  13   2   0   0   5]
 [ 59   9   0   1   1   0   0   0   0   0   0   0   0]
 [ 26  10   0   1   1   0   0   0   0   0   0   0   0]
 [256  16   0 275   8   4   1   0   0   0  15   2   4]
 [ 17   0   0   5  28   0   0   0   0   0   0   0   1]
 [ 12   3   0   9   1 147   5   0   1   1   1  12   0]
 [ 17   3   0  12   0  25 447   0   4   0   1   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [123   0   0   0   0   0   0   0  18   1   0   0   0]
 [ 54   0   0   0   0   0   2   0   0  15   0   1   0]
 [ 65   0   1  18   1   4   2   0   1   0  24   0   0]
 [ 17   0   0   0   0  13   0   0   0  13   0  49   0]
 [ 21   0   0   0   0   1   0   0   1   0   0   0   6]]
Epoch 3:
[[862  20   0  39   5   4   4   0  47   1   1   0   3]
 [ 47  10   0   2   3   0   0   0   8   0   0   0   0]
 [ 25  11   0   1   1   0   0   0   0   0   0   0   0]
 [173  12   0 344   9   8  13   0  11   0   5   2   4]
 [ 14   0   0   5  29   1   0   0   0   0   1   0   1]
 [ 12   1   0   9   1 134  24   0   1   0   0  10   0]
 [ 16   0   0  13   0   7 468   0   5   0   0   0   0]
 [  7   1   0   0   0   0   0   0   4   0   0   0   0]
 [ 87   0   0   0   0   0   1   0  53   1   0   0   0]
 [ 52   0   0   3   0   1   0   0   4   2   0  10   0]
 [ 56   0   0  38   0   4   4   0   5   0   9   0   0]
 [ 15   0   0   0   0  24   0   0   0   1   0  52   0]
 [ 20   0   0   0   0   1   0   0   2   0   0   0   6]]
Epoch 4:
[[846  19   1  68   6   4   3   0  29   0   4   4   2]
 [ 44   9   0  10   3   1   0   0   3   0   0   0   0]
 [ 25   8   1   3   1   0   0   0   0   0   0   0   0]
 [114  13   0 416   7   7  10   0   2   0   5   4   3]
 [  9   0   0  11  30   0   0   0   0   0   0   0   1]
 [ 10   1   0  17   1 134  12   0   1   1   0  15   0]
 [ 13   0   0  21   0  10 462   0   3   0   0   0   0]
 [ 10   1   0   0   0   0   0   0   1   0   0   0   0]
 [ 91   0   0   4   0   0   1   0  45   1   0   0   0]
 [ 41   0   0   3   0   0   0   0   2   7   0  19   0]
 [ 48   0   0  49   0   6   2   0   2   0   9   0   0]
 [  7   0   0   0   0  12   0   0   0   2   0  71   0]
 [ 22   1   0   0   0   1   0   0   1   0   0   0   4]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.976942   0.892113   0.730104   0.730104    0.730104      0.724385      0.730104       0.715556
Iteration 1    0.990054   0.877387   0.720415   0.720415    0.720415      0.723024      0.720415       0.690212
Iteration 2    1.014015   1.029016   0.682353   0.682353    0.682353      0.705277      0.682353       0.664912
Iteration 3    1.015310   0.891027   0.709343   0.709343    0.709343      0.715573      0.709343       0.698357

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.906990   0.943382   0.687543   0.687543    0.687543      0.683069      0.687543       0.671371
Iteration 1    0.904746   0.958331   0.706228   0.706228    0.706228      0.703414      0.706228       0.691794
Iteration 2    0.960221   1.183057   0.637024   0.637024    0.637024      0.658776      0.637024       0.607800
Iteration 3    0.928278   1.065061   0.671280   0.671280    0.671280      0.681842      0.671280       0.642081

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.926092   1.130573   0.669550   0.669550    0.669550      0.631780      0.669550       0.623724
Iteration 1    0.929575   1.059639   0.678201   0.678201    0.678201      0.695255      0.678201       0.650827
Iteration 2    0.964165   1.027173   0.688927   0.688927    0.688927      0.661107      0.688927       0.653634
Iteration 3    0.929459   1.069762   0.681315   0.681315    0.681315      0.666143      0.681315       0.652303

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.863447   1.014293   0.694810   0.694810    0.694810      0.681484      0.694810       0.666211
Iteration 1    0.861628   1.001741   0.696540   0.696540    0.696540      0.673256      0.696540       0.670137
Iteration 2    0.890186   0.999066   0.688235   0.688235    0.688235      0.660791      0.688235       0.661795
Iteration 3    0.864674   1.008772   0.703806   0.703806    0.703806      0.687929      0.703806       0.675332

