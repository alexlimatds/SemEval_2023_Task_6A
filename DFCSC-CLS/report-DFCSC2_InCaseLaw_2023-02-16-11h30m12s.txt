RESULTS REPORT
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 512
Min context length: 350
Batch size: 4
Dropout rate: 0.1
Learning rate: 1e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 02h22m07s
GPU name: NVIDIA GeForce GTX 1080 Ti
GPU memory: 10.92

Averages:
Epoch Train loss    std    Test loss    std    P (micro)  P std  R (micro)  R std  F1 (micro)  F1 std P (weighted)  P std  R (weighted)  R std  F1 (weighted)  F1 std
   1   0.997347   0.008329  0.802258  0.033361   0.7337   0.0087   0.7337   0.0087   0.7337    0.0087    0.7125     0.0091    0.7337     0.0087     0.7078     0.0089
   2   0.790067   0.006453  0.822662  0.026609   0.7374   0.0083   0.7374   0.0083   0.7374    0.0083    0.7225     0.0129    0.7374     0.0083     0.7146     0.0130
   3   0.753053   0.005609  0.828880  0.015840   0.7332   0.0066   0.7332   0.0066   0.7332    0.0066    0.7267     0.0044    0.7332     0.0066     0.7204     0.0082
   4   0.699518   0.003966  0.794512  0.004531   0.7420   0.0030   0.7420   0.0030   0.7420    0.0030    0.7249     0.0021    0.7420     0.0030     0.7256     0.0040

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[897   4  13  18   7   4   1   0  18   2   1  12   9]
 [ 27   1  25  11   1   0   0   0   5   0   0   0   0]
 [  9   0  25   2   0   2   0   0   0   0   0   0   0]
 [ 66   0   0 486   5   3   7   0   0   0  13   0   1]
 [  7   0   0  19  23   2   0   0   0   0   0   0   0]
 [ 18   0   0  19   2 115  24   0   2   3   0   9   0]
 [  0   0   0  19   0  11 474   0   5   0   0   0   0]
 [ 11   0   1   0   0   0   0   0   0   0   0   0   0]
 [ 78   0   0   0   0   0   0   0  59   1   0   4   0]
 [ 57   0   0   0   0   9   0   0   0   2   0   4   0]
 [ 43   0   0  56   3   2   0   0   0   0  12   0   0]
 [ 27   0   0   0   0  26   0   0   0   3   0  36   0]
 [ 16   0   0   0   0   0   0   0   0   0   0   0  13]]
Epoch 2:
[[832   3  37  64  11   5   3   0   6   0   4  11  10]
 [ 21   3  25  20   1   0   0   0   0   0   0   0   0]
 [  6   3  24   3   0   2   0   0   0   0   0   0   0]
 [ 37   4   2 500   9   6   8   0   0   0  10   0   5]
 [  7   0   0  19  23   2   0   0   0   0   0   0   0]
 [ 12   0   0  18   2 127  15   0   0   0   0  18   0]
 [  0   0   0  15   0  11 483   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [119   0   0   8   0   0   1   0  14   0   0   0   0]
 [ 45   0   0   0   0   4   0   0   0   0   0  23   0]
 [ 26   0   0  61   2   6   0   0   0   0  21   0   0]
 [ 10   0   0   0   0  20   0   0   0   0   0  62   0]
 [ 10   0   1   1   0   0   0   0   0   0   0   0  17]]
Epoch 3:
[[860  19   8  20   1   0   1   0  19  38   0  13   7]
 [ 42  10  13   5   0   0   0   0   0   0   0   0   0]
 [  8   6  20   2   0   0   0   0   0   0   0   2   0]
 [ 98  17   0 442   4   6   8   0   0   0   5   0   1]
 [ 12   0   0  19  18   2   0   0   0   0   0   0   0]
 [  7   0   0  18   1 104  24   0   4   4   0  30   0]
 [  4   0   0  19   0   9 471   0   6   0   0   0   0]
 [  8   1   0   0   0   0   0   0   3   0   0   0   0]
 [ 75   0   0   0   0   0   0   0  58   9   0   0   0]
 [ 28   0   0   0   0   0   0   0   0  25   0  19   0]
 [ 38   7   0  59   2   2   0   0   0   0   8   0   0]
 [  1   0   0   0   0   5   0   0   0  13   0  73   0]
 [ 15   0   0   1   0   0   0   0   0   0   0   0  13]]
Epoch 4:
[[850   9   6  43  11   1   1   0  28  16   6   3  12]
 [ 27  11  11   9   3   0   0   0   7   0   2   0   0]
 [ 13   9  13   3   0   0   0   0   0   0   0   0   0]
 [ 51  10   0 468  15   6   9   0   0   0  17   0   5]
 [  9   0   0  15  25   2   0   0   0   0   0   0   0]
 [  5   0   0  10   2 115  27   0   4   4   0  25   0]
 [  0   0   0   6   0   9 484   0  10   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 57   0   0   3   0   0   0   0  74   3   0   0   5]
 [ 41   0   0   0   0   2   0   0   2  13   0  14   0]
 [ 26   0   0  51   3   6   3   0   5   0  22   0   0]
 [  5   0   0   0   0   9   0   0   2  10   0  66   0]
 [ 12   0   0   1   0   0   0   0   0   0   0   0  16]]
=> Iteration 1:
Epoch 1:
[[801  32   0  56  12   1   1   0  40   3   0  29  11]
 [ 14  29   0  16   1   0   0   0  10   0   0   0   0]
 [ 10  25   0   3   0   0   0   0   0   0   0   0   0]
 [ 39   4   0 503   7   7   9   0   0   0  11   0   1]
 [  7   0   0  18  24   2   0   0   0   0   0   0   0]
 [  9   1   0   7   3 104  41   0   4   0   0  23   0]
 [  0   0   0   5   0   4 500   0   0   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 46   0   0   3   0   3   0   0  87   0   0   3   0]
 [ 24   1   0   0   0   5   0   0   2   6   0  34   0]
 [ 36   0   0  64   2   6   0   0   0   0   8   0   0]
 [ 10   1   0   0   0  14   0   0   2   1   0  64   0]
 [ 15   0   0   1   0   0   0   0   0   0   0   1  12]]
Epoch 2:
[[869  12   0  30  11   1   1   0  42   4   0  14   2]
 [ 31   9   0  19   1   0   0   0  10   0   0   0   0]
 [ 20  15   0   3   0   0   0   0   0   0   0   0   0]
 [ 69   4   0 476   8   3   7   0   5   0   9   0   0]
 [  8   0   0  20  20   2   0   0   1   0   0   0   0]
 [  7   0   0  21   1  76  32   0   5   3   3  44   0]
 [  0   0   0  11   0   4 494   0   0   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 53   0   0   0   0   0   0   0  85   4   0   0   0]
 [ 38   0   0   0   0   3   0   0   2  11   0  18   0]
 [ 21   0   0  61   2   0   0   0  16   0  16   0   0]
 [  9   0   0   0   0   2   0   0   2   6   0  73   0]
 [ 19   0   0   1   0   0   0   0   0   0   0   0   9]]
Epoch 3:
[[747  65  15  55   6   2   1   0  38  16   4  29   8]
 [  6  39   4   9   3   0   0   0   9   0   0   0   0]
 [  6  12  15   3   0   2   0   0   0   0   0   0   0]
 [ 42  16   0 480   9   6   8   0   0   0  15   0   5]
 [  8   1   0  15  25   2   0   0   0   0   0   0   0]
 [  7   0   0  25   1 108  19   0   4   1   0  27   0]
 [  0   0   0  11   0   6 492   0   0   0   0   0   0]
 [  3   3   0   0   0   0   0   0   6   0   0   0   0]
 [ 52   2   0   0   0   0   0   0  80   5   0   3   0]
 [ 32   0   0   0   0   1   0   0   2  11   0  26   0]
 [ 32   1   0  62   3   2   0   0   5   0  11   0   0]
 [  0   0   0   0   0   6   0   0   2   4   0  80   0]
 [ 11   1   0   1   0   0   0   0   0   0   0   0  16]]
Epoch 4:
[[861  25   3  46   7   1   1   0  29   7   0   4   2]
 [ 39  17   2   3   3   0   0   0   6   0   0   0   0]
 [ 18  11   7   2   0   0   0   0   0   0   0   0   0]
 [ 59  14   2 464  13   6   9   0   0   0  13   0   1]
 [  9   0   0  14  26   2   0   0   0   0   0   0   0]
 [  9   0   0  15   2 114  23   0   4   0   0  25   0]
 [  0   0   0   9   0  10 490   0   0   0   0   0   0]
 [  8   1   0   0   0   0   0   0   3   0   0   0   0]
 [ 77   0   0   0   0   0   0   0  65   0   0   0   0]
 [ 42   0   0   0   0   2   0   0   2   9   0  17   0]
 [ 32   1   0  56   4   4   0   0   5   0  14   0   0]
 [  7   0   0   0   0  10   0   0   2   5   0  68   0]
 [ 16   0   1   1   0   0   0   0   0   0   0   0  11]]
=> Iteration 2:
Epoch 1:
[[778   4  10 104  14   0   1   0  51   1   4   1  18]
 [ 15   4  14  24   1   0   0   0  12   0   0   0   0]
 [ 11   4  19   4   0   0   0   0   0   0   0   0   0]
 [ 17   0   0 536   7   3   4   0   1   0   8   0   5]
 [  6   0   0  18  24   2   0   0   0   0   0   0   1]
 [ 18   0   0  26   4 104  21   0   5   2   1  11   0]
 [  0   0   0  31   0   6 467   0   5   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 42   0   0   8   0   0   3   0  89   0   0   0   0]
 [ 58   0   0   0   0   1   0   0   2   5   1   5   0]
 [ 20   0   0  73   2   2   0   0  11   0   8   0   0]
 [ 42   0   0   0   0   8   4   0   2   8   1  27   0]
 [  7   0   0   1   0   0   0   0   3   0   0   0  18]]
Epoch 2:
[[834   6   2  15   8   1   1   0  49  39   0   9  22]
 [ 41   9   2   3   3   0   0   0  12   0   0   0   0]
 [ 22   7   7   0   2   0   0   0   0   0   0   0   0]
 [115  14   0 393  17   7   8   0   5   0  17   0   5]
 [  8   0   0   4  35   2   0   0   0   0   0   0   2]
 [  8   0   0  10   2 105  21   0   4   3   0  39   0]
 [  0   0   0   8   0   9 482   0  10   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 44   0   0   0   0   0   0   0  90   8   0   0   0]
 [ 14   0   0   0   0   1   0   0   2  43   0  12   0]
 [ 41   1   0  32   3   6   0   0  11   0  20   0   2]
 [  0   0   0   0   0   4   0   0   2  11   0  75   0]
 [  9   0   0   0   0   0   0   0   0   0   0   0  20]]
Epoch 3:
[[802   7   2  56  12   2   1   0  40  29   5  10  20]
 [ 34   5   4  15   3   0   0   0   9   0   0   0   0]
 [ 19   6   7   4   0   2   0   0   0   0   0   0   0]
 [ 46  10   0 470  19   6   7   0   1   0  17   0   5]
 [  6   0   0  11  31   2   0   0   0   0   0   0   1]
 [  5   0   0  17   3 119  15   0   4   2   0  27   0]
 [  0   0   0  18   0  11 470   0  10   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 51   0   0   0   0   0   0   0  84   4   0   0   3]
 [ 29   0   0   0   0   2   0   0   2  21   0  18   0]
 [ 26   0   0  51   4   6   0   0  11   0  18   0   0]
 [  3   0   0   0   0   9   0   0   2   5   0  73   0]
 [  8   0   0   1   0   0   0   0   0   0   0   0  20]]
Epoch 4:
[[836  14   9  38  12   2   1   0  33  30   1   2   8]
 [ 28  12  11  10   3   0   0   0   6   0   0   0   0]
 [ 16   8   9   3   0   2   0   0   0   0   0   0   0]
 [ 64  10   2 452  17   6   9   0   0   0  16   0   5]
 [  8   0   0  11  30   2   0   0   0   0   0   0   0]
 [  5   0   0   9   3 114  27   0   4   4   0  26   0]
 [  0   0   0   6   0   9 484   0  10   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 67   0   0   3   0   0   1   0  67   4   0   0   0]
 [ 29   0   0   0   0   1   0   0   2  26   0  14   0]
 [ 32   0   0  48   4   6   0   0   5   0  21   0   0]
 [  5   0   0   0   0   6   0   0   2  13   0  66   0]
 [ 11   0   1   0   0   0   0   0   0   0   1   0  16]]
=> Iteration 3:
Epoch 1:
[[875   9  13  20   6   0   1   0  27  22   0   0  13]
 [ 28   5  16  12   1   0   0   0   8   0   0   0   0]
 [ 13   5  18   2   0   0   0   0   0   0   0   0   0]
 [ 55   5   7 476   5   7  17   0   0   0   4   0   5]
 [  7   0   0  20  22   2   0   0   0   0   0   0   0]
 [ 14   1   0   6   1 116  21   0   4  15   0  14   0]
 [ 12   0   0   6   0  13 467   0  11   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 73   0   0   0   0   0   0   0  68   1   0   0   0]
 [ 39   1   0   0   0   0   0   0   2  28   0   2   0]
 [ 43   1   0  54   3   6   4   0   0   0   5   0   0]
 [ 17   1   0   0   0   1   0   0   2  48   0  23   0]
 [ 11   0   0   0   0   0   0   0   0   0   0   0  18]]
Epoch 2:
[[817   4   2  47  11   2   1   0  20  31   4  24  23]
 [ 45   2   4  14   3   0   0   0   2   0   0   0   0]
 [ 21   3  10   0   2   2   0   0   0   0   0   0   0]
 [ 43   0   0 487  14   7  17   0   0   0   8   0   5]
 [  6   0   0  12  30   2   0   0   0   0   0   0   1]
 [  5   0   0   7   2 124  27   0   3   2   0  22   0]
 [  0   0   0   6   0   9 489   0   5   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 55   0   0   0   0   0   0   0  70   9   0   3   5]
 [ 12   0   0   0   0   2   0   0   0  37   0  21   0]
 [ 32   0   0  62   2   6   4   0   0   0  10   0   0]
 [  0   0   0   0   0  15   0   0   0   7   0  70   0]
 [  7   0   0   1   0   0   0   0   0   0   0   0  21]]
Epoch 3:
[[811  12   2  52   6   2   1   0  25  33   8  18  16]
 [ 35  11   0  14   3   0   0   0   7   0   0   0   0]
 [ 17  13   3   1   2   2   0   0   0   0   0   0   0]
 [ 43   4   0 463  15   7  18   0   0   0  26   0   5]
 [  9   0   0  13  27   2   0   0   0   0   0   0   0]
 [  6   0   0   7   1 121  27   0   4   2   0  24   0]
 [  0   0   0   5   0   9 486   0   9   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 54   0   0   0   0   0   1   0  75   9   0   3   0]
 [ 11   0   0   0   0   2   0   0   0  37   0  22   0]
 [ 26   0   0  47   4   6   4   0   0   0  29   0   0]
 [  0   0   0   0   0  15   0   0   0   9   0  68   0]
 [  8   0   0   0   0   0   0   0   0   0   1   1  19]]
Epoch 4:
[[874  15   3  27   1   1   1   0  27  31   0   2   4]
 [ 44  11   5   4   2   0   0   0   4   0   0   0   0]
 [ 21   8   7   0   2   0   0   0   0   0   0   0   0]
 [ 67  14   0 454  13   6   9   0   0   0  17   0   1]
 [ 12   0   0  13  24   2   0   0   0   0   0   0   0]
 [  8   0   0  14   1 114  26   0   4   2   0  23   0]
 [  0   0   0   7   0   9 483   0  10   0   0   0   0]
 [  8   1   0   0   0   0   0   0   3   0   0   0   0]
 [ 74   0   0   0   0   0   0   0  67   1   0   0   0]
 [ 37   0   0   0   0   2   0   0   2  18   0  13   0]
 [ 32   1   0  55   4   4   0   0   5   0  15   0   0]
 [  6   0   0   0   0  11   0   0   2  11   0  62   0]
 [ 16   0   0   0   0   0   0   0   0   0   1   0  12]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.986172   0.788733   0.741522   0.741522    0.741522      0.706451      0.741522       0.709227
Iteration 1    0.992503   0.762728   0.739792   0.739792    0.739792      0.720236      0.739792       0.716670
Iteration 2    1.004706   0.854270   0.719377   0.719377    0.719377      0.700810      0.719377       0.693032
Iteration 3    1.006006   0.803300   0.733910   0.733910    0.733910      0.722516      0.733910       0.712421

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.784332   0.866350   0.728720   0.728720    0.728720      0.702871      0.728720       0.694657
Iteration 1    0.787279   0.809004   0.739792   0.739792    0.739792      0.719566      0.739792       0.712818
Iteration 2    0.801021   0.819605   0.731142   0.731142    0.731142      0.736464      0.731142       0.720858
Iteration 3    0.787635   0.795688   0.749827   0.749827    0.749827      0.731237      0.749827       0.729875

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.755358   0.854217   0.727336   0.727336    0.727336      0.725001      0.727336       0.709750
Iteration 1    0.753218   0.828303   0.728028   0.728028    0.728028      0.727138      0.728028       0.718735
Iteration 2    0.759481   0.821734   0.733564   0.733564    0.733564      0.721372      0.733564       0.720477
Iteration 3    0.744154   0.811267   0.743945   0.743945    0.743945      0.733351      0.743945       0.732826

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.697032   0.796470   0.746367   0.746367    0.746367      0.727196      0.746367       0.731751
Iteration 1    0.694830   0.796548   0.742561   0.742561    0.742561      0.724681      0.742561       0.721576
Iteration 2    0.705232   0.786764   0.738062   0.738062    0.738062      0.726266      0.738062       0.726276
Iteration 3    0.700976   0.798267   0.740830   0.740830    0.740830      0.721653      0.740830       0.722739

