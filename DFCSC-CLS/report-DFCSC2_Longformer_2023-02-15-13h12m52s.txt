RESULTS REPORT
Model: Longformer
Encoder: allenai/longformer-base-4096
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 1024
Min context length: 350
Use Malik dataset: False
Batch size: 4
Dropout rate: 0.1
Learning rate: 2e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 02h16m28s
GPU name: NVIDIA GeForce GTX 1080 Ti
GPU memory: 10.92

Averages:
Epoch Train loss    std    Test loss    std    P (micro)  P std  R (micro)  R std  F1 (micro)  F1 std P (weighted)  P std  R (weighted)  R std  F1 (weighted)  F1 std
   1   1.178760   0.025101  0.784468  0.115099   0.7650   0.0158   0.7650   0.0158   0.7650    0.0158    0.7422     0.0250    0.7650     0.0158     0.7307     0.0280
   2   0.757916   0.015650  0.615281  0.019985   0.7985   0.0092   0.7985   0.0092   0.7985    0.0092    0.7935     0.0084    0.7985     0.0092     0.7881     0.0112
   3   0.610982   0.006871  0.580714  0.017947   0.8117   0.0039   0.8117   0.0039   0.8117    0.0039    0.8021     0.0058    0.8117     0.0039     0.7982     0.0077
   4   0.511116   0.005470  0.552510  0.011512   0.8211   0.0033   0.8211   0.0033   0.8211    0.0033    0.8126     0.0029    0.8211     0.0033     0.8139     0.0026

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[904  45   3  28   3   0   1   0   0   0   1   1   0]
 [ 36  25   1   8   0   0   0   0   0   0   0   0   0]
 [  7  26   3   2   0   0   0   0   0   0   0   0   0]
 [ 53  11   2 501   5   4   0   0   0   0   5   0   0]
 [  7   1   0   9  34   0   0   0   0   0   0   0   0]
 [  8   0   0  16   2 159   5   0   0   0   0   2   0]
 [  1   0   0  15   0   6 487   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [134   0   0   7   0   0   0   0   1   0   0   0   0]
 [ 51   0   0   1   0   0   0   0   0   5   0  15   0]
 [ 35   1   0  76   0   1   0   0   0   0   3   0   0]
 [  2   0   0   0   0   6   0   0   0   1   0  83   0]
 [ 27   1   0   0   0   0   0   0   0   0   0   1   0]]
Epoch 2:
[[776  29   0  64   2   1   0   0  37  67   2   1   7]
 [ 22  21   0  14   1   0   0   0  11   0   0   0   1]
 [  5  27   4   2   0   0   0   0   0   0   0   0   0]
 [ 19  15   5 520   6   3   1   0   0   0   8   0   4]
 [  6   0   0   8  37   0   0   0   0   0   0   0   0]
 [  3   0   0  12   2 154  14   0   4   0   0   3   0]
 [  0   0   0   4   0   0 505   0   0   0   0   0   0]
 [  8   1   0   0   0   0   0   0   0   3   0   0   0]
 [ 38   0   0   4   2   0   0   0  93   1   2   2   0]
 [ 10   0   0   1   0   0   0   0   0  57   0   4   0]
 [ 22   0   0  71   0   0   0   0  12   0  11   0   0]
 [  0   0   0   0   0   1   0   0   0   7   0  84   0]
 [ 13   0   0   1   0   0   0   0   1   1   0   1  12]]
Epoch 3:
[[835  19   9  58   1   1   1   0  38  14   1   0   9]
 [ 25  17   6  13   1   0   0   0   7   0   0   0   1]
 [  4  19  13   2   0   0   0   0   0   0   0   0   0]
 [ 21   8   9 516   5   4   0   0   0   0  13   0   5]
 [  5   0   0   6  40   0   0   0   0   0   0   0   0]
 [  3   0   0   9   1 165   8   0   4   0   0   2   0]
 [  0   0   0   1   0   1 507   0   0   0   0   0   0]
 [ 10   0   1   0   0   0   0   0   1   0   0   0   0]
 [ 31   0   0   1   0   0   0   0 107   2   1   0   0]
 [ 31   0   0   0   0   0   0   0   0  38   0   3   0]
 [ 24   0   0  55   0   1   0   0  10   0  26   0   0]
 [  1   0   0   0   0   2   0   0   0   7   0  82   0]
 [  9   0   0   1   0   0   0   0   1   1   0   1  16]]
Epoch 4:
[[863  17   1  34   3   3   0   0  20  30   4   0  11]
 [ 26  19   3  13   1   0   0   0   7   0   0   0   1]
 [  8  18   9   3   0   0   0   0   0   0   0   0   0]
 [ 27   9   4 512   6   4   0   0   0   0  15   0   4]
 [  5   0   0   6  40   0   0   0   0   0   0   0   0]
 [  3   0   0   8   1 172   3   0   3   0   0   2   0]
 [  0   0   0   5   0   4 500   0   0   0   0   0   0]
 [ 10   1   0   0   0   0   0   0   0   1   0   0   0]
 [ 45   0   0   4   0   0   0   0  89   2   2   0   0]
 [ 21   0   0   0   0   0   0   0   0  48   0   3   0]
 [ 29   0   0  53   1   0   0   0   2   0  31   0   0]
 [  0   0   0   0   0   1   0   0   0   5   0  86   0]
 [  6   0   0   1   0   0   0   0   0   1   0   1  20]]
=> Iteration 1:
Epoch 1:
[[852   1   4  74   3   0   1   0  29  20   1   1   0]
 [ 27   7   1  27   0   0   0   0   8   0   0   0   0]
 [ 18   8   9   3   0   0   0   0   0   0   0   0   0]
 [ 42   0   0 517   5   2   1   0   0   0  14   0   0]
 [  7   0   0  10  34   0   0   0   0   0   0   0   0]
 [  2   0   0  18   1 146  18   0   4   0   0   3   0]
 [  0   0   0  11   0   1 497   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 46   0   0   7   3   0   0   0  81   3   0   2   0]
 [ 31   0   0   0   0   0   0   0   0  37   0   4   0]
 [ 35   0   0  69   0   0   0   0   6   0   6   0   0]
 [  0   0   0   0   0   1   0   0   0   9   0  82   0]
 [ 27   0   0   0   0   0   0   0   0   2   0   0   0]]
Epoch 2:
[[878   6  11  21   1   3   0   0  24  29   5   2   6]
 [ 29  17   9   3   1   0   0   0   8   0   2   0   1]
 [ 12   8  16   2   0   0   0   0   0   0   0   0   0]
 [ 52   1   3 495   6   3   0   0   0   0  18   0   3]
 [  5   0   0   6  40   0   0   0   0   0   0   0   0]
 [  2   0   0   7   1 173   1   0   4   0   1   3   0]
 [  0   0   0  15   0  12 482   0   0   0   0   0   0]
 [ 10   0   1   0   0   0   0   0   1   0   0   0   0]
 [ 50   0   0   1   0   0   0   0  83   4   3   1   0]
 [ 25   0   0   0   0   0   0   0   0  40   0   7   0]
 [ 24   0   0  50   1   0   0   0  10   0  31   0   0]
 [  0   0   0   0   0   2   0   0   0   7   0  83   0]
 [ 15   0   0   1   0   0   0   0   1   1   0   1  10]]
Epoch 3:
[[838  43   0  17   5   1   0   0  20  43   8   0  11]
 [ 31  31   0   2   1   0   0   0   4   0   0   0   1]
 [  5  31   0   2   0   0   0   0   0   0   0   0   0]
 [ 40  16   0 493   8   3   0   0   0   0  18   0   3]
 [  5   0   0   5  41   0   0   0   0   0   0   0   0]
 [  5   0   0   7   2 164   9   0   3   0   0   2   0]
 [  0   0   0   9   0   0 500   0   0   0   0   0   0]
 [  7   1   0   0   0   0   0   0   3   1   0   0   0]
 [ 49   0   0   0   0   0   0   0  88   3   2   0   0]
 [ 21   0   0   0   0   0   0   0   0  48   0   3   0]
 [ 22   0   0  53   1   0   0   0  12   0  28   0   0]
 [  0   0   0   0   0   1   0   0   0   7   0  84   0]
 [  9   0   0   1   0   0   0   0   0   2   0   0  17]]
Epoch 4:
[[839  26   2  49   4   1   0   0  16  29   9   0  11]
 [ 25  22   1  11   1   0   0   0   7   0   2   0   1]
 [ 12  18   6   2   0   0   0   0   0   0   0   0   0]
 [ 29   3   0 517   6   4   0   0   0   0  18   0   4]
 [  5   0   0   6  40   0   0   0   0   0   0   0   0]
 [  2   0   0   5   1 176   2   0   4   0   0   2   0]
 [  0   0   0   9   0   3 497   0   0   0   0   0   0]
 [ 10   0   1   0   0   0   0   0   1   0   0   0   0]
 [ 50   0   0   1   0   0   0   0  86   3   2   0   0]
 [ 26   0   0   0   0   0   0   0   0  41   0   5   0]
 [ 23   0   0  45   0   0   0   0  10   0  38   0   0]
 [  0   0   0   0   0   1   0   0   0   7   0  84   0]
 [  7   0   0   1   0   0   0   0   0   1   0   1  19]]
=> Iteration 2:
Epoch 1:
[[963   1   0   8   2   0   1   0   0  10   0   1   0]
 [ 63   5   0   0   1   0   0   0   0   0   0   0   1]
 [ 26  10   0   2   0   0   0   0   0   0   0   0   0]
 [193   1   0 364   6   5   5   0   0   0   1   2   4]
 [ 13   0   0   2  35   0   1   0   0   0   0   0   0]
 [ 11   0   0   3   2 156  15   0   0   0   0   5   0]
 [  0   0   0   8   0   2 499   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [137   0   0   0   0   0   0   0   0   4   0   1   0]
 [ 37   0   0   0   0   0   0   0   0  29   0   6   0]
 [ 58   0   0  47   0   2   0   0   0   1   1   7   0]
 [  0   0   0   0   0   0   0   0   0   8   0  84   0]
 [ 22   0   0   0   0   0   0   0   0   0   0   1   6]]
Epoch 2:
[[837  45   9  26   2   1   1   0  27  19   0   3  16]
 [ 12  35   4  13   1   0   0   0   4   0   0   0   1]
 [  2  20  14   2   0   0   0   0   0   0   0   0   0]
 [ 30  23   4 490   5  11   0   0   0   0  13   0   5]
 [  4   0   0   6  37   3   0   0   1   0   0   0   0]
 [  3   0   0   4   1 168   9   0   5   0   0   2   0]
 [  0   0   0   7   0   6 496   0   0   0   0   0   0]
 [  9   1   1   0   0   0   0   0   1   0   0   0   0]
 [ 49   9   0   1   2   0   0   0  75   3   3   0   0]
 [ 29   0   0   0   0   0   0   0   0  36   0   7   0]
 [ 25   3   0  53   0   2   0   0   9   0  24   0   0]
 [  0   0   0   0   0   2   0   0   0  12   0  78   0]
 [  6   1   0   1   0   0   0   0   0   1   0   1  19]]
Epoch 3:
[[900   9   0  21   0   1   0   0  18  22   1   3  11]
 [ 36  19   0  10   1   0   0   0   3   0   0   0   1]
 [ 16  19   1   2   0   0   0   0   0   0   0   0   0]
 [ 58   2   0 505   5   4   0   0   0   0   4   0   3]
 [  5   0   0   8  38   0   0   0   0   0   0   0   0]
 [  4   0   0   8   0 173   1   0   4   0   0   2   0]
 [  0   0   0  10   0  10 489   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 64   0   0   3   0   0   0   0  73   1   0   1   0]
 [ 33   0   0   0   0   0   0   0   0  31   0   8   0]
 [ 21   0   0  75   0   0   0   0  10   0  10   0   0]
 [  0   0   0   0   0   1   0   0   0   6   0  85   0]
 [ 10   0   0   1   0   0   0   0   0   1   0   1  16]]
Epoch 4:
[[867  23   5  18   3   0   1   0  23  22   7   3  14]
 [ 22  24   3  13   1   0   0   0   4   0   2   0   1]
 [ 13  16   7   2   0   0   0   0   0   0   0   0   0]
 [ 39   5   0 498   6   4   0   0   0   0  24   0   5]
 [  5   0   0   8  38   0   0   0   0   0   0   0   0]
 [  3   0   0   4   0 175   4   0   4   0   0   2   0]
 [  0   0   0   9   0   5 495   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 51   0   0   3   0   0   0   0  81   3   4   0   0]
 [ 31   0   0   0   0   0   0   0   0  34   0   7   0]
 [ 20   0   0  39   0   0   0   0  11   0  46   0   0]
 [  0   0   0   0   0   1   0   0   0   6   0  85   0]
 [  9   0   0   0   0   0   0   0   0   1   0   1  18]]
=> Iteration 3:
Epoch 1:
[[846  30   1  28   0   8   0   0  11  34   8   8  12]
 [ 32  21   0   9   1   0   0   0   3   0   3   0   1]
 [ 13  23   0   0   0   2   0   0   0   0   0   0   0]
 [ 77   5   0 459  10   5   4   0   0   0  16   0   5]
 [  6   1   0   5  35   1   2   0   0   0   0   0   1]
 [  3   0   0   4   3 163   9   0   3   0   0   7   0]
 [  0   0   0   9   0   1 499   0   0   0   0   0   0]
 [ 10   1   0   0   0   0   0   0   0   1   0   0   0]
 [ 70   4   0   5   2   1   0   0  48   4   6   2   0]
 [ 19   0   0   0   0   0   0   0   0  41   0  12   0]
 [ 40   1   0  48   0   3   0   0   0   0  19   5   0]
 [  0   0   0   0   0   0   0   0   0   4   0  88   0]
 [ 17   0   0   0   0   0   0   0   1   1   0   1   9]]
Epoch 2:
[[910   4   3  18   0   0   1   0   9  23   7   2   9]
 [ 45  16   0   3   1   0   0   0   4   0   0   0   1]
 [ 19  16   1   2   0   0   0   0   0   0   0   0   0]
 [ 80   0   0 468   5   1   2   0   0   0  21   0   4]
 [  6   0   0   9  35   0   1   0   0   0   0   0   0]
 [  4   0   0  16   1 147  18   0   3   0   0   3   0]
 [  0   0   0   4   0   0 505   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 85   0   0   0   0   0   0   0  52   4   0   1   0]
 [ 29   0   0   0   0   0   0   0   0  36   0   7   0]
 [ 33   0   0  46   0   0   0   0   1   0  36   0   0]
 [  0   0   0   0   0   1   0   0   0   5   0  86   0]
 [ 19   0   0   0   0   0   0   0   0   1   0   1   8]]
Epoch 3:
[[904   6   1  21   0   1   0   0   9  23   8   3  10]
 [ 35  17   1  10   1   1   0   0   2   0   2   0   1]
 [ 19  17   0   2   0   0   0   0   0   0   0   0   0]
 [ 58   1   0 496   5   5   0   0   0   0  13   0   3]
 [  6   0   0   7  38   0   0   0   0   0   0   0   0]
 [  4   0   0   7   0 173   2   0   3   0   0   3   0]
 [  0   0   0  11   0   3 495   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 74   0   0   1   0   0   0   0  61   4   1   1   0]
 [ 30   0   0   1   0   0   0   0   0  31   0  10   0]
 [ 31   0   0  46   0   1   0   0   1   0  37   0   0]
 [  0   0   0   0   0   1   0   0   0   4   0  87   0]
 [ 17   0   0   1   0   0   0   0   0   0   0   1  10]]
Epoch 4:
[[851  14  19  23   3   3   0   0  17  27   8   3  18]
 [ 22  21   3  11   1   1   0   0   7   0   3   0   1]
 [ 12  17   7   2   0   0   0   0   0   0   0   0   0]
 [ 36   1   6 501   6   5   0   0   0   0  21   0   5]
 [  5   0   0   8  38   0   0   0   0   0   0   0   0]
 [  3   0   0   5   0 175   3   0   4   0   0   2   0]
 [  0   0   0   8   0   3 498   0   0   0   0   0   0]
 [  7   1   0   0   0   0   0   0   4   0   0   0   0]
 [ 46   0   0   2   0   0   0   0  91   2   0   1   0]
 [ 26   0   0   1   0   0   0   0   0  37   0   8   0]
 [ 23   0   0  40   0   1   0   0   5   0  47   0   0]
 [  0   0   0   0   0   1   0   0   0   4   0  87   0]
 [  9   0   0   1   0   0   0   0   0   0   0   2  17]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.180496   0.750399   0.762976   0.762976    0.762976      0.760281      0.762976       0.717290
Iteration 1    1.159966   0.697977   0.784775   0.784775    0.784775      0.755702      0.784775       0.759153
Iteration 2    1.155519   0.980915   0.741176   0.741176    0.741176      0.699132      0.741176       0.691298
Iteration 3    1.219058   0.708582   0.770934   0.770934    0.770934      0.753780      0.770934       0.755237

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.742305   0.632563   0.786851   0.786851    0.786851      0.787768      0.786851       0.776800
Iteration 1    0.743154   0.581253   0.812457   0.812457    0.812457      0.801392      0.812457       0.802715
Iteration 2    0.767770   0.624275   0.798962   0.798962    0.798962      0.802101      0.798962       0.795263
Iteration 3    0.778434   0.623034   0.795848   0.795848    0.795848      0.782912      0.795848       0.777620

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.599082   0.550727   0.817301   0.817301    0.817301      0.810520      0.817301       0.808732
Iteration 1    0.614892   0.584940   0.806920   0.806920    0.806920      0.801627      0.806920       0.800839
Iteration 2    0.614895   0.598037   0.809689   0.809689    0.809689      0.802094      0.809689       0.787517
Iteration 3    0.615061   0.589152   0.812803   0.812803    0.812803      0.794147      0.812803       0.795522

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.502708   0.537280   0.826644   0.826644    0.826644      0.817430      0.826644       0.817706
Iteration 1    0.512069   0.568661   0.818339   0.818339    0.818339      0.810459      0.818339       0.810680
Iteration 2    0.511659   0.547755   0.819377   0.819377    0.819377      0.810278      0.819377       0.812630
Iteration 3    0.518028   0.556345   0.820069   0.820069    0.820069      0.812118      0.820069       0.814613

