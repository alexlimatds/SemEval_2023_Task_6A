RESULTS REPORT
Model: Longformer
Encoder: allenai/longformer-base-4096
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 1024
Min context length: 2
Use Malik dataset: False
Batch size: 4
Dropout rate: 0.1
Learning rate: 2e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 01h13m02s
GPU name: Quadro RTX 6000
GPU memory: 22.17

Averages:
Epoch Train loss   std    Test loss   std    P (micro) P std  R (micro) R std  F1 (micro) F1 std P (weighted) P std  R (weighted) R std  F1 (weighted) F1 std
  1    1.272359  0.023855  0.777284 0.026516   0.7563  0.0085   0.7563  0.0085   0.7563   0.0085    0.7428    0.0125    0.7563    0.0085     0.7218    0.0162
  2    0.795634  0.009776  0.679539 0.015463   0.7851  0.0082   0.7851  0.0082   0.7851   0.0082    0.7688    0.0099    0.7851    0.0082     0.7638    0.0065
  3    0.661613  0.002849  0.630854 0.026149   0.8024  0.0077   0.8024  0.0077   0.8024   0.0077    0.7966    0.0059    0.8024    0.0077     0.7907    0.0085
  4    0.545510  0.004910  0.600163 0.007442   0.8112  0.0053   0.8112  0.0053   0.8112   0.0053    0.8010    0.0048    0.8112    0.0053     0.8009    0.0055

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[899  22   0  27   2   1   0   0  33   1   0   1   0]
 [ 37  12   0  11   0   0   0   0  10   0   0   0   0]
 [ 23  12   1   2   0   0   0   0   0   0   0   0   0]
 [101   9   0 446   5   6   0   0   0   0  12   0   2]
 [  8   0   0   7  34   2   0   0   0   0   0   0   0]
 [  5   0   0  10   2 166   4   0   3   0   0   2   0]
 [  0   0   0  11   0  18 480   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 78   4   0   2   0   0   0   0  51   3   4   0   0]
 [ 53   0   0   0   0   0   0   0   0   9   0  10   0]
 [ 39   0   0  54   0   1   0   0   2   0  20   0   0]
 [  2   0   0   0   0  10   0   0   0   1   0  79   0]
 [ 22   1   0   0   0   0   0   0   3   0   0   1   2]]
Epoch 2:
[[896   6   0  25   1   1   0   0  44   8   2   0   3]
 [ 37   8   0   9   2   0   0   0  14   0   0   0   0]
 [ 18  16   1   3   0   0   0   0   0   0   0   0   0]
 [ 82   2   0 475   5   1   0   0   2   0  12   0   2]
 [  6   0   0  10  35   0   0   0   0   0   0   0   0]
 [  3   0   0  18   2 154   7   0   5   0   1   2   0]
 [  0   0   0   5   0   0 498   0   4   0   2   0   0]
 [ 10   0   0   0   0   0   0   0   2   0   0   0   0]
 [ 46   0   0   5   4   0   0   0  82   4   1   0   0]
 [ 39   0   0   0   0   0   0   0   1  30   0   2   0]
 [ 37   0   0  53   0   0   0   0   1   0  25   0   0]
 [  2   0   0   0   0   2   0   0   0  11   1  76   0]
 [ 18   0   0   0   0   0   0   0   5   0   0   0   6]]
Epoch 3:
[[802  27   3  47   1   7   0   0  40  36  13   0  10]
 [ 13  29   0  13   1   1   0   0  12   0   0   0   1]
 [  8  24   4   2   0   0   0   0   0   0   0   0   0]
 [ 39  14   0 479   6   5   0   0   1   0  32   0   5]
 [  6   0   0   7  38   0   0   0   0   0   0   0   0]
 [  2   0   0   5   2 175   0   0   5   0   0   3   0]
 [  0   0   0   3   0   8 493   0   1   0   4   0   0]
 [  9   1   0   0   0   0   0   0   0   2   0   0   0]
 [ 42   2   0   4   2   0   0   0  87   5   0   0   0]
 [ 26   0   0   0   0   0   0   0   0  41   1   4   0]
 [ 33   0   0  41   0   1   0   0   2   0  39   0   0]
 [  0   0   0   0   0   1   0   0   0   6   0  85   0]
 [ 11   1   0   0   0   0   0   0   2   2   0   0  13]]
Epoch 4:
[[875   7   9  34   1   2   0   0   8  25   8   0  17]
 [ 31  23   0   6   1   0   0   0   8   0   0   0   1]
 [ 14  17   4   3   0   0   0   0   0   0   0   0   0]
 [ 64   7   1 473   5   4   0   0   0   0  23   0   4]
 [  6   0   0   7  38   0   0   0   0   0   0   0   0]
 [  4   0   0   8   2 169   3   0   3   0   0   3   0]
 [  0   0   0   3   0   0 502   0   0   0   4   0   0]
 [ 10   0   1   0   0   0   0   0   0   1   0   0   0]
 [ 68   0   0   3   0   0   0   0  65   6   0   0   0]
 [ 28   0   0   0   0   0   0   0   0  39   0   5   0]
 [ 34   0   0  43   0   0   0   0   0   0  39   0   0]
 [  0   0   0   0   0   1   0   0   0   5   0  86   0]
 [ 14   0   0   0   0   0   0   0   0   2   0   0  13]]
=> Iteration 1:
Epoch 1:
[[891   0   5  64   3   2   0   0   0  14   1   2   4]
 [ 42   3   6  15   2   0   0   0   0   0   0   1   1]
 [ 22   2  10   3   1   0   0   0   0   0   0   0   0]
 [ 67   0   0 497  10   4   0   0   0   1   0   0   2]
 [  6   0   1  10  34   0   0   0   0   0   0   0   0]
 [  8   0   0   7   3 165   0   0   0   0   0   9   0]
 [  9   0   0  18   0  53 429   0   0   0   0   0   0]
 [ 11   0   0   0   0   0   0   0   0   1   0   0   0]
 [108   0   0  22   0   0   0   0   4   2   2   4   0]
 [ 28   0   0   0   0   0   0   0   0  21   0  23   0]
 [ 37   0   0  71   0   0   0   0   0   0   5   3   0]
 [  0   0   0   0   0   1   0   0   0   2   0  89   0]
 [ 20   0   0   0   0   0   0   0   0   0   0   3   6]]
Epoch 2:
[[834  18   2  91   0   9   1   0  14   8   5   2   2]
 [ 17  18   6  17   1   1   0   0   8   0   1   0   1]
 [  7  10  18   3   0   0   0   0   0   0   0   0   0]
 [ 51   0   0 507   5   3   0   0   0   0  13   0   2]
 [  6   0   0  10  35   0   0   0   0   0   0   0   0]
 [  2   0   0  13   1 155  16   0   3   0   0   2   0]
 [  0   0   0  11   0   0 498   0   0   0   0   0   0]
 [ 10   1   0   0   0   0   0   0   1   0   0   0   0]
 [ 65   0   0  15   0   0   0   0  56   0   2   4   0]
 [ 35   0   0   1   0   0   1   0   0  19   0  16   0]
 [ 35   0   0  72   0   0   0   0   0   0   9   0   0]
 [  0   0   0   0   0   4   0   0   0   3   0  85   0]
 [ 19   0   0   0   0   0   0   0   1   0   0   2   7]]
Epoch 3:
[[896  11   0  35   0   1   0   0   4  32   2   1   4]
 [ 37  25   0   4   1   0   0   0   2   0   0   0   1]
 [ 14  20   1   3   0   0   0   0   0   0   0   0   0]
 [ 66   0   0 497   5   4   0   0   0   0   7   0   2]
 [  7   0   0   9  35   0   0   0   0   0   0   0   0]
 [  4   0   0  12   2 167   2   0   3   0   0   2   0]
 [  0   0   0  11   0   1 497   0   0   0   0   0   0]
 [ 10   1   0   0   0   0   0   0   0   1   0   0   0]
 [ 73   0   0  10   0   0   0   0  53   5   0   1   0]
 [ 23   0   0   0   0   0   0   0   0  42   0   7   0]
 [ 34   0   0  71   0   0   0   0   0   0  11   0   0]
 [  0   0   0   0   0   1   0   0   0   7   0  84   0]
 [ 16   0   0   0   0   0   0   0   0   1   0   1  11]]
Epoch 4:
[[906  15   4  16   0   2   0   0  13  19   4   0   7]
 [ 31  22   6   4   1   0   0   0   5   0   0   0   1]
 [ 11  18   6   3   0   0   0   0   0   0   0   0   0]
 [ 73   2   0 469   5   4   0   0   0   0  25   0   3]
 [  7   0   0   9  35   0   0   0   0   0   0   0   0]
 [  3   0   0   5   2 176   0   0   4   0   0   2   0]
 [  0   0   0  11   0   2 496   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 63   0   0   1   0   0   0   0  71   4   2   1   0]
 [ 27   0   0   0   0   0   0   0   1  39   0   5   0]
 [ 34   0   0  52   0   0   0   0   0   0  30   0   0]
 [  0   0   0   0   0   2   0   0   0   8   0  82   0]
 [ 14   0   0   0   0   0   0   0   0   1   0   1  13]]
=> Iteration 2:
Epoch 1:
[[873  15  12  71   0   1   0   0   4   7   2   1   0]
 [ 17  24   7  14   0   0   0   0   5   0   2   0   1]
 [ 14  14   7   3   0   0   0   0   0   0   0   0   0]
 [ 57   6   1 502   5   2   0   0   0   0   6   0   2]
 [  8   0   0  12  31   0   0   0   0   0   0   0   0]
 [  6   0   0  19   1 157   2   0   4   1   0   2   0]
 [  7   0   0  24   0   1 476   0   1   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 92   0   0   8   0   0   0   0  34   1   5   2   0]
 [ 35   0   0   1   0   0   0   0   0  26   0  10   0]
 [ 42   0   0  71   0   0   0   0   0   0   2   1   0]
 [  1   0   0   0   0   2   0   0   0   4   0  85   0]
 [ 26   0   0   0   0   0   0   0   1   0   0   1   1]]
Epoch 2:
[[939   7   0  19   0   0   1   0  13   7   0   0   0]
 [ 42  11   0  10   0   0   0   0   7   0   0   0   0]
 [ 19  16   0   3   0   0   0   0   0   0   0   0   0]
 [ 83   0   0 479   5   2   0   0   0   0  10   0   2]
 [  8   0   0  10  33   0   0   0   0   0   0   0   0]
 [  5   0   0  14   1 153  12   0   5   0   0   2   0]
 [  0   0   0   8   0   0 501   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 67   0   0   1   0   0   0   0  72   2   0   0   0]
 [ 42   0   0   0   0   0   0   0   2  25   0   3   0]
 [ 42   0   0  68   0   0   0   0   0   0   6   0   0]
 [  0   0   0   0   0   2   0   0   0  15   0  75   0]
 [ 23   0   0   0   0   0   0   0   1   0   0   1   4]]
Epoch 3:
[[867  17   1  34   0   2   0   0  16  24  10   4  11]
 [ 16  30   1  12   1   0   0   0   7   1   0   1   1]
 [ 10  22   3   3   0   0   0   0   0   0   0   0   0]
 [ 55   3   0 483   5   4   0   0   0   0  25   1   5]
 [  6   0   0   8  37   0   0   0   0   0   0   0   0]
 [  2   0   0   8   1 167   7   0   5   0   0   2   0]
 [  0   0   0   1   0   1 506   0   1   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 54   2   0   4   0   0   0   0  76   4   2   0   0]
 [ 27   0   0   0   0   0   0   0   1  36   0   8   0]
 [ 29   0   0  33   0   0   0   0   1   0  46   7   0]
 [  0   0   0   0   0   1   0   0   0   8   0  83   0]
 [ 14   0   0   0   0   0   0   0   0   1   0   1  13]]
Epoch 4:
[[886  14   9  36   0   3   0   0   8  14   7   2   7]
 [ 15  29   4  13   1   0   0   0   6   1   0   0   1]
 [  7  14  14   3   0   0   0   0   0   0   0   0   0]
 [ 51   7   1 485   5   5   0   0   0   0  21   1   5]
 [  5   0   0   7  39   0   0   0   0   0   0   0   0]
 [  3   0   0   4   1 176   2   0   4   0   0   2   0]
 [  0   0   0   2   0   1 505   0   1   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 60   2   0   3   1   0   0   0  70   3   3   0   0]
 [ 30   0   0   0   0   0   0   0   1  32   0   9   0]
 [ 29   0   0  44   0   1   0   0   1   0  37   4   0]
 [  0   0   0   0   0   2   0   0   0   7   0  83   0]
 [ 15   0   0   0   0   0   0   0   0   1   0   1  12]]
=> Iteration 3:
Epoch 1:
[[948   5   0  14   0   1   0   0   4  11   0   1   2]
 [ 55   2   0  10   0   0   0   0   2   0   0   0   1]
 [ 26   8   0   4   0   0   0   0   0   0   0   0   0]
 [160   1   0 400   5   5   0   0   0   0   7   0   3]
 [  9   0   0   8  30   1   3   0   0   0   0   0   0]
 [  5   0   0   7   2 158   8   0   3   0   0   9   0]
 [  0   0   0  12   0   2 495   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [110   0   0   1   0   0   0   0  26   2   0   3   0]
 [ 34   0   0   0   0   0   0   0   0  15   0  23   0]
 [ 49   0   0  61   0   2   0   0   0   0   4   0   0]
 [  0   0   0   0   0   2   0   0   0   2   0  88   0]
 [ 21   0   0   0   0   0   0   0   1   0   0   1   6]]
Epoch 2:
[[930   8   0   7   0   1   0   0  21   2   1   1  15]
 [ 41  14   0   5   2   0   0   0   7   0   0   0   1]
 [ 14  21   0   3   0   0   0   0   0   0   0   0   0]
 [119   6   0 406  11   4   0   0   1   0  29   0   5]
 [ 11   0   0   4  34   1   0   0   0   0   0   0   1]
 [ 19   0   0   5   2 156   2   0   4   0   0   4   0]
 [  7   0   0   7   0   3 488   0   0   0   4   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 68   0   0   0   0   0   0   0  72   1   0   1   0]
 [ 49   0   0   0   0   0   0   0   0  18   0   5   0]
 [ 43   0   0  30   0   1   0   0   6   0  36   0   0]
 [  3   0   0   0   0   1   0   0   0   4   0  84   0]
 [ 14   1   0   0   0   0   0   0   1   0   0   0  13]]
Epoch 3:
[[867   5  18  41   0   2   0   0  18  19   8   1   7]
 [ 25  10  17  10   1   0   0   0   5   1   0   0   1]
 [  5   8  22   3   0   0   0   0   0   0   0   0   0]
 [ 52   1   1 497   5   3   0   0   0   0  18   0   4]
 [  7   0   0  10  34   0   0   0   0   0   0   0   0]
 [  3   0   0   8   1 171   1   0   4   1   0   3   0]
 [  1   0   0   9   0   4 495   0   0   0   0   0   0]
 [ 11   0   1   0   0   0   0   0   0   0   0   0   0]
 [ 64   0   0   2   1   0   0   0  68   4   2   1   0]
 [ 28   0   0   1   0   0   0   0   0  38   0   5   0]
 [ 32   0   0  57   0   0   0   0   0   0  27   0   0]
 [  0   0   0   0   0   1   0   0   0   5   0  86   0]
 [ 17   0   0   0   0   0   0   0   0   1   0   1  10]]
Epoch 4:
[[889  20   5  25   1   2   0   0  18  12   4   0  10]
 [ 27  25   5   5   1   0   0   0   6   0   0   0   1]
 [  4  23   8   3   0   0   0   0   0   0   0   0   0]
 [ 63   6   0 479   6   4   0   0   0   0  20   0   3]
 [  6   0   0  10  35   0   0   0   0   0   0   0   0]
 [  4   0   0   6   2 172   2   0   4   0   0   2   0]
 [  0   0   0   7   0   1 501   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 66   3   0   0   2   0   0   0  67   4   0   0   0]
 [ 35   0   0   1   0   0   0   0   0  33   0   3   0]
 [ 34   0   0  47   0   1   0   0   0   0  34   0   0]
 [  0   0   0   0   0   2   0   0   0   8   0  82   0]
 [ 13   0   0   0   0   0   0   0   0   2   0   0  14]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.293243   0.743153   0.760900   0.760900    0.760900      0.752732      0.760900       0.735236
Iteration 1    1.240573   0.815105   0.745329   0.745329    0.745329      0.754141      0.745329       0.701841
Iteration 2    1.258183   0.765188   0.767474   0.767474    0.767474      0.741380      0.767474       0.740102
Iteration 3    1.297436   0.785691   0.751557   0.751557    0.751557      0.722863      0.751557       0.710077

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.796419   0.654371   0.791003   0.791003    0.791003      0.782440      0.791003       0.772375
Iteration 1    0.797313   0.681073   0.775433   0.775433    0.775433      0.755096      0.775433       0.754262
Iteration 2    0.780694   0.695904   0.795156   0.795156    0.795156      0.765702      0.795156       0.765922
Iteration 3    0.808108   0.686807   0.778893   0.778893    0.778893      0.771880      0.778893       0.762543

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.662405   0.630233   0.790657   0.790657    0.790657      0.790373      0.790657       0.787577
Iteration 1    0.661957   0.673734   0.802422   0.802422    0.802422      0.799582      0.802422       0.780241
Iteration 2    0.664986   0.608460   0.812111   0.812111    0.812111      0.804795      0.812111       0.803595
Iteration 3    0.657103   0.610990   0.804498   0.804498    0.804498      0.791811      0.804498       0.791550

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.546131   0.610208   0.804844   0.804844    0.804844      0.795439      0.804844       0.794867
Iteration 1    0.550981   0.599261   0.811419   0.811419    0.811419      0.799438      0.811419       0.799498
Iteration 2    0.537589   0.589346   0.819377   0.819377    0.819377      0.808588      0.819377       0.809836
Iteration 3    0.547341   0.601838   0.809343   0.809343    0.809343      0.800559      0.809343       0.799338

