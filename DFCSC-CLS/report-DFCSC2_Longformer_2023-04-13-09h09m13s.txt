RESULTS REPORT
Model: Longformer
Encoder: allenai/longformer-base-4096
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 1024
Min context length: 100
Use Malik dataset: False
Batch size: 4
Dropout rate: 0.1
Learning rate: 2e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 01h19m17s
GPU name: Quadro RTX 6000
GPU memory: 22.17

Averages:
Epoch Train loss   std    Test loss   std    P (micro) P std  R (micro) R std  F1 (micro) F1 std P (weighted) P std  R (weighted) R std  F1 (weighted) F1 std
  1    1.221482  0.011497  0.735041 0.042957   0.7700  0.0218   0.7700  0.0218   0.7700   0.0218    0.7634    0.0103    0.7700    0.0218     0.7526    0.0090
  2    0.792468  0.007619  0.651567 0.026062   0.7896  0.0079   0.7896  0.0079   0.7896   0.0079    0.7922    0.0094    0.7896    0.0079     0.7813    0.0044
  3    0.633900  0.015262  0.606036 0.022257   0.8121  0.0035   0.8121  0.0035   0.8121   0.0035    0.8029    0.0087    0.8121    0.0035     0.7981    0.0045
  4    0.535565  0.013176  0.559848 0.012884   0.8218  0.0040   0.8218  0.0040   0.8218   0.0040    0.8153    0.0046    0.8218    0.0040     0.8155    0.0038

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[925   6   1  25   0   1   0   0  24   3   0   1   0]
 [ 45   7   2   7   0   0   0   0   9   0   0   0   0]
 [ 20  11   5   2   0   0   0   0   0   0   0   0   0]
 [ 82   0   0 488   5   2   0   0   0   0   1   0   3]
 [  8   0   0  10  33   0   0   0   0   0   0   0   0]
 [  4   0   0  21   2 155   3   0   4   0   0   3   0]
 [  0   0   0  16   0   6 487   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 61   1   0   6   0   0   0   0  70   4   0   0   0]
 [ 42   0   0   0   0   0   0   0   4  21   0   5   0]
 [ 40   0   0  76   0   0   0   0   0   0   0   0   0]
 [  3   0   0   0   0   5   0   0   0   6   0  78   0]
 [ 22   0   0   0   0   0   0   0   1   0   0   0   6]]
Epoch 2:
[[870  43   0  13   0   1   0   0  51   3   5   0   0]
 [ 16  34   0   5   1   0   0   0  12   0   1   0   1]
 [  2  34   0   2   0   0   0   0   0   0   0   0   0]
 [ 83  16   0 450   5   4   0   0   3   0  19   0   1]
 [  6   1   0   8  36   0   0   0   0   0   0   0   0]
 [  3   0   0  13   2 167   0   0   4   0   1   2   0]
 [  0   0   0   8   0   5 495   0   1   0   0   0   0]
 [  3   3   0   0   0   0   0   0   6   0   0   0   0]
 [ 36   8   0   0   0   0   0   0  97   1   0   0   0]
 [ 47   0   0   0   0   0   0   0   2  19   0   4   0]
 [ 26   1   0  41   0   0   0   0   8   0  40   0   0]
 [  4   0   0   0   0   6   0   0   0   9   0  73   0]
 [ 21   0   0   0   0   0   0   0   2   0   0   0   6]]
Epoch 3:
[[884   3   2  51   0   1   0   0  23   4   2   1  15]
 [ 27   7  11  13   1   0   0   0  10   0   0   0   1]
 [  9   7  19   3   0   0   0   0   0   0   0   0   0]
 [ 40   0   0 515   5   4   0   0   1   0  12   0   4]
 [  6   0   0   9  36   0   0   0   0   0   0   0   0]
 [  3   0   0  12   1 164   6   0   4   0   0   2   0]
 [  0   0   0   2   0   0 507   0   0   0   0   0   0]
 [  9   0   1   0   0   0   0   0   2   0   0   0   0]
 [ 49   0   0   6   2   0   0   0  82   1   2   0   0]
 [ 46   0   0   0   0   0   0   0   0  19   0   7   0]
 [ 30   0   0  64   0   0   0   0   4   0  18   0   0]
 [  2   0   0   0   0   2   0   0   0   4   0  84   0]
 [ 11   0   0   1   0   0   0   0   0   1   0   1  15]]
Epoch 4:
[[866  21   7  33   0   2   0   0  17  20  12   4   4]
 [ 17  22   8  13   1   0   0   0   6   0   2   0   1]
 [  1  24  11   2   0   0   0   0   0   0   0   0   0]
 [ 31   5   1 506   7   5   0   0   0   0  22   0   4]
 [  6   0   0   7  38   0   0   0   0   0   0   0   0]
 [  3   0   0  10   1 171   1   0   4   0   0   2   0]
 [  0   0   0   4   0   2 501   0   0   0   2   0   0]
 [  9   2   0   0   0   0   0   0   1   0   0   0   0]
 [ 58   2   0   2   2   0   0   0  69   5   4   0   0]
 [ 29   0   0   0   0   0   0   0   0  37   0   6   0]
 [ 29   0   0  41   0   0   0   0   3   0  43   0   0]
 [  0   0   0   0   0   1   0   0   0   5   0  86   0]
 [ 14   0   0   1   0   0   0   0   0   1   0   1  12]]
=> Iteration 1:
Epoch 1:
[[903  15   0  46   1   2   0   0   0  10   3   4   2]
 [ 37  21   1  10   0   0   0   0   0   0   0   0   1]
 [ 12  20   4   2   0   0   0   0   0   0   0   0   0]
 [ 64   6   0 476   5  11   0   0   0   0  17   0   2]
 [  9   1   0   7  32   2   0   0   0   0   0   0   0]
 [  4   0   0   4   2 177   0   0   3   0   0   2   0]
 [  0   0   0  12   0  10 487   0   0   0   0   0   0]
 [ 11   0   0   0   0   0   0   0   0   1   0   0   0]
 [104   0   0   3   0   0   0   0  27   2   3   3   0]
 [ 31   0   0   0   0   0   0   0   0  15   0  26   0]
 [ 41   0   0  50   0   7   0   0   1   0  12   5   0]
 [  0   0   0   0   0  13   0   0   0   1   0  78   0]
 [ 20   1   0   0   0   0   0   0   0   1   0   1   6]]
Epoch 2:
[[780   0 100  23   1   1   0   0  38  31   5   1   6]
 [  7   1  37   9   1   0   0   0  12   0   2   0   1]
 [  1   0  35   2   0   0   0   0   0   0   0   0   0]
 [ 43   2  31 477   5   2   0   0   1   0  16   0   4]
 [  7   0   1  10  33   0   0   0   0   0   0   0   0]
 [  3   0   0  13   2 153  11   0   4   0   0   6   0]
 [  0   0   0   9   0   0 500   0   0   0   0   0   0]
 [  7   0   1   0   0   0   0   0   3   1   0   0   0]
 [ 40   0   3   0   0   0   0   0  93   3   1   2   0]
 [ 22   0   0   0   0   0   0   0   1  45   0   4   0]
 [ 22   0   7  44   0   0   0   0   9   0  34   0   0]
 [  0   0   0   0   0   1   0   0   0   8   0  83   0]
 [ 13   0   1   0   0   0   0   0   0   1   0   1  13]]
Epoch 3:
[[859  34   0  26   2   9   0   0  13  36   3   0   4]
 [ 22  32   0   7   1   1   0   0   4   0   2   0   1]
 [  3  33   0   2   0   0   0   0   0   0   0   0   0]
 [ 50   7   0 497   5   6   0   0   0   0  12   0   4]
 [  7   0   0   8  36   0   0   0   0   0   0   0   0]
 [  2   0   0   4   1 179   0   0   4   0   0   2   0]
 [  0   0   0  10   0   6 493   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 64   2   0   0   0   0   0   0  71   5   0   0   0]
 [ 25   0   0   0   0   0   0   0   0  44   0   3   0]
 [ 35   0   0  54   0   1   0   0   3   0  23   0   0]
 [  0   0   0   0   0   3   0   0   0   7   0  82   0]
 [ 13   0   0   0   0   0   0   0   0   1   0   1  14]]
Epoch 4:
[[864  24   1  33   0   1   0   0  20  28   7   1   7]
 [ 21  28   2   8   1   0   0   0   7   0   2   0   1]
 [  2  21  13   2   0   0   0   0   0   0   0   0   0]
 [ 39   3   0 512   5   4   0   0   1   0  13   0   4]
 [  6   0   0   8  37   0   0   0   0   0   0   0   0]
 [  4   0   0   6   1 175   0   0   4   0   0   2   0]
 [  0   0   0   5   0   2 502   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 52   2   0   0   0   0   0   0  81   4   2   1   0]
 [ 28   0   0   0   0   0   0   0   0  38   0   6   0]
 [ 29   0   0  48   0   0   0   0   1   0  38   0   0]
 [  0   0   0   0   0   2   0   0   0   6   0  84   0]
 [ 13   0   0   1   0   0   0   0   0   1   0   1  13]]
=> Iteration 2:
Epoch 1:
[[630 146   6  60   4   1   0   0  87  36  10   1   5]
 [  1  39   0  12   2   0   0   0  13   0   2   0   1]
 [  0  36   0   2   0   0   0   0   0   0   0   0   0]
 [ 20  20   0 495   6   7   1   0   0   0  27   0   5]
 [  5   2   0   8  34   1   0   0   1   0   0   0   0]
 [  3   0   0   9   3 164   2   0   4   1   0   6   0]
 [  0   0   0  12   0  11 486   0   0   0   0   0   0]
 [  7   2   0   0   0   0   0   0   2   1   0   0   0]
 [ 22   3   0   3   2   0   0   0 103   5   4   0   0]
 [ 20   0   0   0   0   0   0   0   4  43   0   5   0]
 [ 25   2   0  40   0   2   0   0   8   0  39   0   0]
 [  0   0   0   0   0   2   0   0   0  11   0  79   0]
 [ 14   2   0   0   0   0   0   0   3   1   1   1   7]]
Epoch 2:
[[849  27   1  14   0   2   0   0  62  27   0   0   4]
 [ 19  30   1   4   2   0   0   0  13   0   0   0   1]
 [  2  33   1   2   0   0   0   0   0   0   0   0   0]
 [ 67   7   0 484   7   5   0   0   0   0   6   0   5]
 [  6   0   0   8  37   0   0   0   0   0   0   0   0]
 [  4   0   0   4   1 176   0   0   5   0   0   2   0]
 [  0   0   0   7   0   8 494   0   0   0   0   0   0]
 [  6   1   0   0   0   0   0   0   5   0   0   0   0]
 [ 32   0   0   0   0   0   0   0 107   3   0   0   0]
 [ 22   0   0   0   0   0   0   0   6  41   0   3   0]
 [ 25   0   0  68   0   1   0   0  15   0   7   0   0]
 [  0   0   0   0   0   1   0   0   0  16   0  75   0]
 [ 14   0   0   0   0   0   0   0   3   1   0   1  10]]
Epoch 3:
[[862  32   0  55   2   3   0   0   8  14   3   1   6]
 [ 12  32   0  14   1   1   0   0   8   0   1   0   1]
 [  4  28   4   2   0   0   0   0   0   0   0   0   0]
 [ 39   3   0 519   5   5   0   0   0   0   6   0   4]
 [  5   0   0   8  38   0   0   0   0   0   0   0   0]
 [  2   0   0   7   1 176   0   0   4   0   0   2   0]
 [  0   0   0   7   0  10 492   0   0   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 55   1   0   6   4   0   0   0  71   2   2   1   0]
 [ 31   0   0   0   0   0   0   0   0  37   0   4   0]
 [ 29   0   0  56   0   1   0   0   1   0  29   0   0]
 [  0   0   0   0   0   2   0   0   0   7   0  83   0]
 [ 14   0   0   0   0   0   0   0   0   1   0   1  13]]
Epoch 4:
[[880  18   4  21   1   2   0   0  18  25   8   2   7]
 [ 19  28   3   7   1   0   0   0   9   0   2   0   1]
 [  3  20  13   2   0   0   0   0   0   0   0   0   0]
 [ 44   3   0 502   6   4   0   0   0   0  18   0   4]
 [  5   0   0   8  38   0   0   0   0   0   0   0   0]
 [  3   0   0   7   1 174   0   0   5   0   0   2   0]
 [  0   0   0   3   0   9 495   0   0   0   2   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 54   0   0   1   3   0   0   0  78   4   2   0   0]
 [ 27   0   0   0   0   0   0   0   0  40   0   5   0]
 [ 26   0   0  45   0   0   0   0   2   0  43   0   0]
 [  0   0   0   0   0   2   0   0   0   9   0  81   0]
 [ 11   0   0   0   0   0   0   0   0   1   0   1  16]]
=> Iteration 3:
Epoch 1:
[[888   5   9  30   0   4   0   0  14  26   0   4   6]
 [ 28  12  10  12   1   1   0   0   5   0   0   0   1]
 [ 11  14  11   0   0   0   0   0   0   0   2   0   0]
 [ 80   0   1 463   8  11   2   0   1   0  12   0   3]
 [  7   1   0   6  34   3   0   0   0   0   0   0   0]
 [  3   0   0   3   3 174   1   0   4   0   0   4   0]
 [  0   0   0   0   0  10 499   0   0   0   0   0   0]
 [ 11   0   0   0   0   0   0   0   0   1   0   0   0]
 [ 82   0   0   1   0   0   0   0  53   4   0   2   0]
 [ 29   0   0   0   0   0   0   0   0  33   0  10   0]
 [ 46   0   0  50   0   3   0   0   0   0  17   0   0]
 [  0   0   0   0   0   6   0   0   0   8   0  78   0]
 [ 17   1   0   0   0   0   0   0   2   1   0   1   7]]
Epoch 2:
[[900  18   2  17   1   0   1   0  15  23   5   0   4]
 [ 30  19   8   4   2   0   0   0   6   0   0   0   1]
 [  2  23  11   2   0   0   0   0   0   0   0   0   0]
 [ 74   5   2 466  10   4   3   0   1   0  13   0   3]
 [  7   0   0   5  37   0   2   0   0   0   0   0   0]
 [  3   0   0   4   4 136  37   0   5   0   0   3   0]
 [  0   0   0   5   0   0 504   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 69   0   0   0   2   0   0   0  67   3   0   1   0]
 [ 28   0   0   0   0   0   0   0   0  36   0   8   0]
 [ 35   0   0  53   0   0   2   0   5   0  20   1   0]
 [  0   0   0   0   0   1   0   0   0  10   0  81   0]
 [ 20   0   0   0   0   0   0   0   1   1   0   1   6]]
Epoch 3:
[[902  17   0  20   1   1   0   0  10  21   8   1   5]
 [ 27  25   6   5   1   0   0   0   5   0   0   0   1]
 [  3  20  13   2   0   0   0   0   0   0   0   0   0]
 [ 60   1   0 490   7   4   0   0   0   0  15   0   4]
 [  6   0   0   8  37   0   0   0   0   0   0   0   0]
 [  5   0   0  10   1 168   1   0   4   0   0   3   0]
 [  0   0   0   9   0   3 497   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 78   0   0   0   0   0   0   0  60   3   0   1   0]
 [ 27   0   0   0   0   0   0   0   0  36   0   9   0]
 [ 35   0   0  49   0   1   0   0   1   0  30   0   0]
 [  0   0   0   0   0   1   0   0   0   7   0  84   0]
 [ 17   0   0   1   0   0   0   0   0   0   0   1  10]]
Epoch 4:
[[854  32   1  31   1   4   0   0  17  24  12   1   9]
 [ 16  31   1  11   1   0   0   0   7   0   2   0   1]
 [  2  23  11   2   0   0   0   0   0   0   0   0   0]
 [ 36   4   1 504   6   5   0   0   0   0  21   0   4]
 [  6   0   0   9  36   0   0   0   0   0   0   0   0]
 [  3   0   0   5   1 176   0   0   4   0   0   3   0]
 [  0   0   0   6   0   2 499   0   0   0   2   0   0]
 [ 10   1   0   0   0   0   0   0   1   0   0   0   0]
 [ 50   2   0   3   4   0   0   0  74   3   5   1   0]
 [ 27   0   0   0   0   0   0   0   0  36   0   9   0]
 [ 25   0   0  40   0   0   0   0   4   0  47   0   0]
 [  0   0   0   0   0   1   0   0   0   8   0  83   0]
 [ 12   0   0   1   0   0   0   0   0   1   0   1  14]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.211048   0.708708   0.787197   0.787197    0.787197      0.747241      0.787197       0.755647
Iteration 1    1.211036   0.736716   0.774394   0.774394    0.774394      0.763164      0.774394       0.745079
Iteration 2    1.225113   0.803855   0.733218   0.733218    0.733218      0.775022      0.733218       0.743681
Iteration 3    1.238730   0.690887   0.785121   0.785121    0.785121      0.768362      0.785121       0.765917

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.781734   0.641975   0.791349   0.791349    0.791349      0.792022      0.791349       0.783991
Iteration 1    0.794955   0.683069   0.777509   0.777509    0.777509      0.803301      0.777509       0.780221
Iteration 2    0.790393   0.614225   0.799654   0.799654    0.799654      0.796013      0.799654       0.786185
Iteration 3    0.802788   0.666998   0.789965   0.789965    0.789965      0.777400      0.789965       0.774612

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.609247   0.629945   0.813149   0.813149    0.813149      0.794849      0.813149       0.793022
Iteration 1    0.650792   0.618955   0.806228   0.806228    0.806228      0.795684      0.806228       0.794360
Iteration 2    0.635726   0.570818   0.815225   0.815225    0.815225      0.816431      0.815225       0.803464
Iteration 3    0.639836   0.604424   0.813841   0.813841    0.813841      0.804452      0.813841       0.801370

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.513559   0.567311   0.817301   0.817301    0.817301      0.808031      0.817301       0.810413
Iteration 1    0.543043   0.565434   0.825260   0.825260    0.825260      0.819561      0.825260       0.818167
Iteration 2    0.537890   0.537640   0.826298   0.826298    0.826298      0.818886      0.826298       0.819942
Iteration 3    0.547768   0.569008   0.818339   0.818339    0.818339      0.814753      0.818339       0.813555

