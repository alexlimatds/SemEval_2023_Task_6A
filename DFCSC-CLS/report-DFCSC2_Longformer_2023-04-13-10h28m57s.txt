RESULTS REPORT
Model: Longformer
Encoder: allenai/longformer-base-4096
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 1024
Min context length: 250
Use Malik dataset: False
Batch size: 4
Dropout rate: 0.1
Learning rate: 2e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 01h33m45s
GPU name: Quadro RTX 6000
GPU memory: 22.17

Averages:
Epoch Train loss   std    Test loss   std    P (micro) P std  R (micro) R std  F1 (micro) F1 std P (weighted) P std  R (weighted) R std  F1 (weighted) F1 std
  1    1.189124  0.019019  0.727335 0.008721   0.7721  0.0036   0.7721  0.0036   0.7721   0.0036    0.7644    0.0085    0.7721    0.0036     0.7484    0.0135
  2    0.765216  0.015679  0.664403 0.066957   0.7978  0.0128   0.7978  0.0128   0.7978   0.0128    0.7883    0.0167    0.7978    0.0128     0.7761    0.0242
  3    0.618912  0.015138  0.595395 0.020079   0.8136  0.0106   0.8136  0.0106   0.8136   0.0106    0.8066    0.0073    0.8136    0.0106     0.7969    0.0109
  4    0.515008  0.008258  0.548518 0.008608   0.8248  0.0046   0.8248  0.0046   0.8248   0.0046    0.8185    0.0020    0.8248    0.0046     0.8188    0.0035

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[942  16   0  10   0   1   0   0   8   2   0   1   6]
 [ 44  21   0   2   0   0   0   0   2   0   0   0   1]
 [ 14  22   0   2   0   0   0   0   0   0   0   0   0]
 [124   7   0 434   5   4   0   0   0   0   2   0   5]
 [ 10   0   0   7  34   0   0   0   0   0   0   0   0]
 [  9   0   0   3   2 166   6   0   3   0   0   3   0]
 [  2   0   0   8   0   3 496   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 95   3   0   1   0   0   0   0  41   1   0   1   0]
 [ 48   0   0   0   0   0   0   0   0  13   0  11   0]
 [ 49   0   0  65   0   0   0   0   0   0   1   1   0]
 [  3   0   0   0   0   0   0   0   0   2   0  87   0]
 [ 21   0   0   0   0   0   0   0   0   0   0   1   7]]
Epoch 2:
[[896  29   1  31   0   0   1   0  14  10   3   1   0]
 [ 23  29   0  13   0   0   0   0   5   0   0   0   0]
 [  3  29   3   3   0   0   0   0   0   0   0   0   0]
 [ 32   8   0 520   5   1   0   0   0   0  11   0   4]
 [  6   0   0  12  33   0   0   0   0   0   0   0   0]
 [  3   0   0  32   0 140  11   0   4   0   0   2   0]
 [  0   0   0   8   0   0 501   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 64   3   0   5   0   0   0   0  68   1   1   0   0]
 [ 39   0   0   0   0   0   0   0   0  26   0   7   0]
 [ 30   0   0  67   0   0   0   0   0   0  19   0   0]
 [  0   0   0   0   0   1   0   0   0   6   0  85   0]
 [ 17   0   0   1   0   0   0   0   1   1   0   1   8]]
Epoch 3:
[[917   2   5  14   0   1   0   0  12  28   3   0   4]
 [ 38  10   2  13   1   0   0   0   5   0   0   0   1]
 [ 12  12  12   2   0   0   0   0   0   0   0   0   0]
 [ 46   4   0 497   6   3   0   0   0   0  21   0   4]
 [  6   0   0   7  38   0   0   0   0   0   0   0   0]
 [  8   0   0  10   1 164   2   0   4   1   0   2   0]
 [  0   0   0   9   0   2 498   0   0   0   0   0   0]
 [ 10   1   0   0   0   0   0   0   0   1   0   0   0]
 [ 69   0   0   3   0   0   0   0  63   3   4   0   0]
 [ 27   0   0   0   0   0   0   0   0  44   0   1   0]
 [ 30   0   0  47   0   0   0   0   0   0  39   0   0]
 [  0   0   0   0   0   1   0   0   0  13   0  78   0]
 [ 12   0   0   1   0   0   0   0   0   2   0   0  14]]
Epoch 4:
[[904   9   8  14   0   1   0   0  17  22   6   1   4]
 [ 21  17   8  14   1   0   0   0   8   0   0   0   1]
 [  5  14  17   2   0   0   0   0   0   0   0   0   0]
 [ 29   9   2 505   6   3   0   0   0   0  23   0   4]
 [  6   0   0   7  38   0   0   0   0   0   0   0   0]
 [  3   0   0   9   1 171   2   0   4   0   0   2   0]
 [  0   0   0   6   0   6 496   0   0   0   1   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 53   3   1   1   0   0   0   0  75   2   6   1   0]
 [ 28   0   0   0   0   0   0   0   0  39   0   5   0]
 [ 29   0   0  45   0   0   0   0   0   0  42   0   0]
 [  0   0   0   0   0   1   0   0   0   5   0  86   0]
 [ 11   0   0   1   0   0   0   0   0   1   0   1  15]]
=> Iteration 1:
Epoch 1:
[[823  28   0  12   5   0   2   0  58  41   6   1  10]
 [ 21  29   0   3   2   0   1   0  12   0   1   0   1]
 [  5  31   0   0   2   0   0   0   0   0   0   0   0]
 [ 92   9   0 437  12   1   7   0   1   1  15   1   5]
 [  5   1   0   7  36   0   1   0   1   0   0   0   0]
 [  3   0   0   4   3 132  42   0   4   0   0   4   0]
 [  0   0   0   0   0   0 509   0   0   0   0   0   0]
 [  8   1   0   0   0   0   0   0   2   1   0   0   0]
 [ 19   3   0   0   1   0   0   0 113   4   0   2   0]
 [ 20   0   0   0   0   0   0   0   4  34   0  14   0]
 [ 30   0   0  47   0   1   2   0  12   0  18   6   0]
 [  0   0   0   0   0   1   0   0   0   2   0  89   0]
 [ 13   0   0   0   0   0   0   0   4   1   0   1  10]]
Epoch 2:
[[882  33   0  10   1  18   0   0  12  19   1   4   6]
 [ 30  27   0   5   1   2   0   0   4   0   0   0   1]
 [  5  31   0   2   0   0   0   0   0   0   0   0   0]
 [ 53  16   1 460   5  13   1   0   0   2  24   1   5]
 [  8   0   0   5  38   0   0   0   0   0   0   0   0]
 [  4   0   0   1   0 180   2   0   4   0   0   1   0]
 [  0   0   0   0   0   0 509   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 63   5   0   1   0   0   0   0  68   5   0   0   0]
 [ 27   0   0   0   0   0   0   0   0  39   0   6   0]
 [ 29   5   0  29   1   1   0   0   6   0  41   4   0]
 [  0   0   0   0   0   3   0   0   0   4   0  85   0]
 [ 16   0   0   0   0   0   0   0   0   1   0   1  11]]
Epoch 3:
[[938   1   0  14   0   1   0   0  17   9   0   0   6]
 [ 37  12   1  12   1   0   0   0   6   0   0   0   1]
 [ 14  17   5   2   0   0   0   0   0   0   0   0   0]
 [ 51   2   0 503   5   3   0   0   1   0  11   0   5]
 [  8   0   0   6  37   0   0   0   0   0   0   0   0]
 [  9   0   0   8   2 163   3   0   5   0   0   2   0]
 [  0   0   0   7   0   2 500   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 64   0   0   0   0   0   0   0  75   3   0   0   0]
 [ 41   0   0   0   0   0   0   0   0  29   0   2   0]
 [ 30   0   0  48   0   0   0   0   7   0  31   0   0]
 [  1   0   0   0   0   1   0   0   0  12   0  78   0]
 [ 17   0   0   0   0   0   0   0   0   0   0   1  11]]
Epoch 4:
[[870  22   2  22   1   6   0   0  24  22  10   0   7]
 [ 18  24   3  14   1   1   0   0   8   0   0   0   1]
 [  5  20  11   2   0   0   0   0   0   0   0   0   0]
 [ 21  11   1 516   5   3   0   0   0   0  19   0   5]
 [  6   0   0   8  37   0   0   0   0   0   0   0   0]
 [  3   0   0   7   1 173   2   0   4   0   0   2   0]
 [  0   0   0   9   0   3 497   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 50   3   0   3   0   0   0   0  77   5   4   0   0]
 [ 27   0   0   0   0   0   0   0   0  41   0   4   0]
 [ 27   0   0  46   0   0   0   0   3   0  40   0   0]
 [  0   0   0   0   0   1   0   0   0   7   0  84   0]
 [ 11   0   0   1   0   0   0   0   0   1   0   1  15]]
=> Iteration 2:
Epoch 1:
[[908  46   0  27   1   1   0   0   0   1   1   1   0]
 [ 24  35   1  10   0   0   0   0   0   0   0   0   0]
 [  0  36   0   2   0   0   0   0   0   0   0   0   0]
 [ 56  24   0 491   5   1   0   0   0   0   3   0   1]
 [  8   1   0   9  33   0   0   0   0   0   0   0   0]
 [  8   0   0  16   2 162   2   0   0   0   0   2   0]
 [  0   0   0  22   0  12 475   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [113   3   0  21   2   0   0   0   2   1   0   0   0]
 [ 47   0   0   0   0   0   0   0   0  22   0   3   0]
 [ 36   1   0  74   0   0   0   0   0   0   5   0   0]
 [  3   0   0   0   0   3   0   0   0   7   0  79   0]
 [ 25   0   0   1   0   0   0   0   0   0   0   0   3]]
Epoch 2:
[[934  17   0  10   0   1   0   0  11   8   0   1   4]
 [ 41  20   0   3   1   0   0   0   4   0   0   0   1]
 [  8  28   0   2   0   0   0   0   0   0   0   0   0]
 [ 85   7   0 469   5   2   0   0   0   0   8   0   5]
 [  9   0   0   7  35   0   0   0   0   0   0   0   0]
 [  6   0   0   9   1 163   6   0   5   0   0   2   0]
 [  0   0   0  12   0   4 492   0   1   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 76   0   0   1   0   0   0   0  64   0   0   1   0]
 [ 45   0   0   0   0   0   0   0   0  24   0   3   0]
 [ 43   0   0  53   0   0   0   0   2   0  18   0   0]
 [  2   0   0   0   0   2   0   0   0   7   0  81   0]
 [ 17   0   0   0   0   0   0   0   0   0   0   1  11]]
Epoch 3:
[[812  26   0  95   0  14   0   0   5  21   3   1   9]
 [ 11  28   1  22   1   2   0   0   3   0   1   0   1]
 [  4  29   2   3   0   0   0   0   0   0   0   0   0]
 [  6   7   0 541   5   3   0   0   0   0  14   0   5]
 [  5   0   0  10  36   0   0   0   0   0   0   0   0]
 [  3   0   0   6   0 177   1   0   3   0   0   2   0]
 [  0   0   0   2   0   8 499   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 72   2   0   9   0   0   0   0  51   3   4   1   0]
 [ 30   0   0   1   0   0   0   0   0  34   0   7   0]
 [ 22   0   0  70   0   0   0   0   0   0  24   0   0]
 [  0   0   0   0   0   2   0   0   0   6   0  84   0]
 [  9   1   0   1   0   0   0   0   0   1   0   1  16]]
Epoch 4:
[[845  36   6  24   0   6   0   0  25  29   9   1   5]
 [ 10  30   3  12   1   1   0   0  10   0   2   0   1]
 [  3  25   8   2   0   0   0   0   0   0   0   0   0]
 [ 28  12   0 502   6   4   0   0   0   0  24   0   5]
 [  5   0   0   9  37   0   0   0   0   0   0   0   0]
 [  2   0   0   6   1 175   1   0   5   0   0   2   0]
 [  0   0   0   4   0   8 495   0   0   0   2   0   0]
 [ 10   1   0   0   0   0   0   0   0   1   0   0   0]
 [ 43   3   0   1   1   0   0   0  87   3   4   0   0]
 [ 25   0   0   0   0   0   0   0   0  41   0   6   0]
 [ 28   0   0  37   0   0   0   0   0   0  51   0   0]
 [  0   0   0   0   0   1   0   0   0   7   0  84   0]
 [ 10   0   0   1   0   0   0   0   0   1   0   1  16]]
=> Iteration 3:
Epoch 1:
[[804  35   0  55   5   1   0   0  56  12   6   1  11]
 [ 14  22   0  17   1   0   0   0  13   0   2   0   1]
 [  1  35   0   2   0   0   0   0   0   0   0   0   0]
 [ 32  14   0 517   5   1   0   0   0   0   7   0   5]
 [  5   1   0  11  34   0   0   0   0   0   0   0   0]
 [  3   0   0  24   2 152   4   0   5   0   0   2   0]
 [  0   0   0  15   0   2 490   0   2   0   0   0   0]
 [  4   1   0   0   0   0   0   0   6   1   0   0   0]
 [ 20   2   0  16   5   0   0   0  90   4   4   1   0]
 [ 27   0   0   1   0   0   0   0   6  35   0   3   0]
 [ 30   1   0  79   0   0   0   0   5   0   1   0   0]
 [  0   0   0   0   0   3   0   0   0   7   0  82   0]
 [  8   1   0   2   0   0   0   0   6   1   0   0  11]]
Epoch 2:
[[963   1   3  10   0   1   0   0   1   6   0   1   0]
 [ 56   9   2   2   0   0   0   0   0   0   0   0   1]
 [ 17   3  16   2   0   0   0   0   0   0   0   0   0]
 [134   0   4 427   5   5   0   0   0   0   2   1   3]
 [ 13   0   0   4  33   1   0   0   0   0   0   0   0]
 [ 16   0   0   1   0 164   7   0   2   0   0   2   0]
 [  2   0   0   2   0   0 505   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [128   0   0   0   0   0   0   0  11   3   0   0   0]
 [ 42   0   0   0   0   0   0   0   0  28   0   2   0]
 [ 63   0   0  50   0   1   0   0   0   0   0   2   0]
 [  2   0   0   0   0   0   0   0   0   8   0  82   0]
 [ 22   0   0   0   0   0   0   0   0   1   0   0   6]]
Epoch 3:
[[952   8   0   9   0   2   0   0   3   7   2   1   2]
 [ 48  10   5   2   1   1   0   0   2   0   0   0   1]
 [ 12  18   6   2   0   0   0   0   0   0   0   0   0]
 [ 68   8   3 466   6   8   0   0   0   0  18   1   3]
 [  8   0   0   4  37   2   0   0   0   0   0   0   0]
 [  5   0   0   1   0 177   3   0   4   0   0   2   0]
 [  0   0   0   2   0   2 505   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [101   3   0   0   0   0   0   0  35   2   1   0   0]
 [ 42   0   0   0   0   0   0   0   0  27   0   3   0]
 [ 39   1   0  34   1   1   0   0   0   0  39   1   0]
 [  0   0   0   0   0   2   0   0   0   7   0  83   0]
 [ 20   0   0   0   0   0   0   0   0   0   0   1   8]]
Epoch 4:
[[861  23   1  34   1   4   0   0  30  19   3   1   9]
 [ 16  26   3  15   1   1   0   0   7   0   0   0   1]
 [  4  29   3   2   0   0   0   0   0   0   0   0   0]
 [ 18  14   0 518   5   4   0   0   0   0  17   0   5]
 [  6   0   0   8  37   0   0   0   0   0   0   0   0]
 [  3   0   0   6   1 174   1   0   5   0   0   2   0]
 [  0   0   0   7   0   4 498   0   0   0   0   0   0]
 [ 10   1   0   0   0   0   0   0   1   0   0   0   0]
 [ 41   3   0   4   1   0   0   0  86   5   2   0   0]
 [ 34   0   0   0   0   0   0   0   0  34   0   4   0]
 [ 28   0   0  47   0   0   0   0   3   0  38   0   0]
 [  0   0   0   0   0   1   0   0   0   9   0  82   0]
 [  8   1   0   1   0   0   0   0   0   1   0   1  17]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.179268   0.717816   0.775779   0.775779    0.775779      0.756241      0.775779       0.742176
Iteration 1    1.176373   0.728055   0.771626   0.771626    0.771626      0.766051      0.771626       0.760831
Iteration 2    1.178845   0.741073   0.766436   0.766436    0.766436      0.777752      0.766436       0.729270
Iteration 3    1.222010   0.722396   0.774394   0.774394    0.774394      0.757713      0.774394       0.761518

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.760455   0.624817   0.805536   0.805536    0.805536      0.801171      0.805536       0.788245
Iteration 1    0.784464   0.592189   0.809689   0.809689    0.809689      0.803047      0.809689       0.800846
Iteration 2    0.742396   0.670801   0.799654   0.799654    0.799654      0.787919      0.799654       0.779012
Iteration 3    0.773548   0.769807   0.776471   0.776471    0.776471      0.761203      0.776471       0.736350

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.601791   0.577935   0.821453   0.821453    0.821453      0.811225      0.821453       0.808448
Iteration 1    0.619099   0.600415   0.824221   0.824221    0.824221      0.814919      0.824221       0.806345
Iteration 2    0.611884   0.626162   0.797232   0.797232    0.797232      0.795749      0.797232       0.782458
Iteration 3    0.642873   0.577066   0.811419   0.811419    0.811419      0.804607      0.811419       0.790424

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.514379   0.545900   0.832180   0.832180    0.832180      0.820784      0.832180       0.823799
Iteration 1    0.522768   0.550281   0.825260   0.825260    0.825260      0.818028      0.825260       0.818844
Iteration 2    0.501780   0.560906   0.820415   0.820415    0.820415      0.819812      0.820415       0.818512
Iteration 3    0.521107   0.536986   0.821453   0.821453    0.821453      0.815490      0.821453       0.814048

