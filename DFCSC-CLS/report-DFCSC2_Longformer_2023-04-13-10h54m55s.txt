RESULTS REPORT
Model: Longformer
Encoder: allenai/longformer-base-4096
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 1024
Min context length: 512
Use Malik dataset: False
Batch size: 4
Dropout rate: 0.1
Learning rate: 2e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 02h20m28s
GPU name: Quadro RTX 6000
GPU memory: 22.17

Averages:
Epoch Train loss   std    Test loss   std    P (micro) P std  R (micro) R std  F1 (micro) F1 std P (weighted) P std  R (weighted) R std  F1 (weighted) F1 std
  1    1.136197  0.022415  0.697821 0.031536   0.7772  0.0106   0.7772  0.0106   0.7772   0.0106    0.7645    0.0088    0.7772    0.0106     0.7558    0.0097
  2    0.753309  0.017009  0.693167 0.080030   0.7814  0.0156   0.7814  0.0156   0.7814   0.0156    0.7805    0.0114    0.7814    0.0156     0.7569    0.0235
  3    0.611864  0.017408  0.588200 0.017822   0.8151  0.0040   0.8151  0.0040   0.8151   0.0040    0.8008    0.0053    0.8151    0.0040     0.8005    0.0056
  4    0.503652  0.016075  0.554673 0.015401   0.8269  0.0014   0.8269  0.0014   0.8269   0.0014    0.8160    0.0035    0.8269    0.0014     0.8163    0.0008

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[876   0  12  11   0   6   1   0  59  21   0   0   0]
 [ 38   0  13   2   1   0   0   0  16   0   0   0   0]
 [ 14   0  22   2   0   0   0   0   0   0   0   0   0]
 [105   0   4 426   5  14   0   0  10   1  12   0   4]
 [ 11   0   0   4  33   2   0   0   1   0   0   0   0]
 [  5   0   0   1   0 172   6   0   5   1   0   2   0]
 [  0   0   0   9   0   6 494   0   0   0   0   0   0]
 [ 10   0   0   0   0   0   0   0   1   1   0   0   0]
 [ 34   0   0   1   0   0   0   0 103   4   0   0   0]
 [ 27   0   0   0   0   0   0   0   2  40   0   3   0]
 [ 34   0   0  43   0   1   0   0  16   0  22   0   0]
 [  0   0   0   0   0   2   0   0   0   9   0  81   0]
 [ 18   0   0   0   0   0   0   0   4   1   0   0   6]]
Epoch 2:
[[781  18   0 170   1   3   0   0   0   5   6   1   1]
 [ 11  22   0  29   1   1   0   0   2   0   3   0   1]
 [  5  23   5   5   0   0   0   0   0   0   0   0   0]
 [  8   0   0 545   5   5   0   0   0   0  15   0   3]
 [  6   0   0   9  36   0   0   0   0   0   0   0   0]
 [  6   0   0  11   1 172   0   0   0   0   0   2   0]
 [  1   0   0   7   0   7 494   0   0   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 96   0   0   6   0   0   0   0  34   2   4   0   0]
 [ 45   0   0   1   0   0   0   0   0  21   0   5   0]
 [ 27   0   0  52   0   0   0   0   0   0  37   0   0]
 [  2   0   0   0   0   4   0   0   0   3   0  83   0]
 [ 19   0   0   1   0   0   0   0   0   0   0   1   8]]
Epoch 3:
[[862   9   2  56   2   2   1   0  20  17  10   1   4]
 [ 21  14   6  19   1   1   0   0   4   0   3   0   1]
 [  7  17  11   3   0   0   0   0   0   0   0   0   0]
 [ 32   0   0 520   6   3   0   0   0   0  16   0   4]
 [  5   0   0   5  39   2   0   0   0   0   0   0   0]
 [  3   0   0   3   1 176   3   0   4   0   0   2   0]
 [  0   0   0   4   0   3 500   0   0   0   2   0   0]
 [  9   2   0   0   0   0   0   0   0   1   0   0   0]
 [ 52   0   0   5   0   0   0   0  79   1   4   1   0]
 [ 24   0   0   1   0   0   0   0   0  34   0  13   0]
 [ 27   0   0  49   0   1   0   0   1   0  38   0   0]
 [  0   0   0   0   0   4   0   0   0   3   0  85   0]
 [ 14   0   0   1   0   0   0   0   0   1   0   1  12]]
Epoch 4:
[[894   8   7  30   0   2   1   0  14  16  10   0   4]
 [ 32  13  11   5   1   1   0   0   4   0   2   0   1]
 [  8  17  11   2   0   0   0   0   0   0   0   0   0]
 [ 38   0   0 513   6   3   0   0   0   0  17   0   4]
 [  6   0   0   6  39   0   0   0   0   0   0   0   0]
 [  4   0   0   4   0 176   3   0   3   0   0   2   0]
 [  0   0   0   5   0   3 499   0   0   0   2   0   0]
 [  9   2   0   0   0   0   0   0   1   0   0   0   0]
 [ 63   0   0   3   0   0   0   0  70   1   5   0   0]
 [ 29   0   0   0   0   0   0   0   0  37   0   6   0]
 [ 32   0   0  45   0   0   0   0   0   0  39   0   0]
 [  1   0   0   0   0   1   0   0   0   4   0  86   0]
 [ 12   0   0   1   0   0   0   0   0   1   0   1  14]]
=> Iteration 1:
Epoch 1:
[[905   0  13  19   0   2   0   0   6  27   0   1  13]
 [ 39   3  11   8   1   0   0   0   7   0   0   0   1]
 [ 18   3  15   2   0   0   0   0   0   0   0   0   0]
 [ 92   0   0 469   5   4   0   0   0   1   4   1   5]
 [  8   0   0   7  34   1   0   0   0   0   0   0   1]
 [  4   0   0   6   2 172   1   0   4   0   0   3   0]
 [  2   0   0  10   0  21 476   0   0   0   0   0   0]
 [ 11   0   1   0   0   0   0   0   0   0   0   0   0]
 [ 81   0   0   0   0   0   0   0  55   4   0   2   0]
 [ 28   0   0   0   0   0   0   0   0  32   0  12   0]
 [ 43   0   0  64   0   1   0   0   3   0   3   2   0]
 [  0   0   0   0   0   3   0   0   0   3   0  86   0]
 [ 16   0   0   0   0   0   0   0   0   1   0   1  11]]
Epoch 2:
[[973   0   0   6   0   0   1   0   1   4   0   1   0]
 [ 63   0   3   1   1   0   0   0   1   0   0   0   1]
 [ 29   5   2   2   0   0   0   0   0   0   0   0   0]
 [188   0   0 375   5   3   0   0   0   0   8   0   2]
 [ 11   0   0   5  35   0   0   0   0   0   0   0   0]
 [ 13   0   0   2   1 162  11   0   1   0   0   2   0]
 [  0   0   0   0   0   1 508   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [124   0   0   0   0   0   0   0  14   3   0   1   0]
 [ 44   0   0   0   0   0   0   0   0  25   0   3   0]
 [ 57   0   0  43   0   0   0   0   0   0  16   0   0]
 [  0   0   0   0   0   5   0   0   0   9   0  78   0]
 [ 23   0   0   0   0   0   0   0   0   0   0   0   6]]
Epoch 3:
[[911  18   3  19   1   1   1   0   7  14   2   1   8]
 [ 19  29   3  10   1   1   0   0   6   0   0   0   1]
 [  5  30   1   2   0   0   0   0   0   0   0   0   0]
 [ 55  15   0 486   5   3   0   0   0   0  13   0   4]
 [  8   0   0   6  37   0   0   0   0   0   0   0   0]
 [  4   1   0   6   1 172   3   0   3   0   0   2   0]
 [  0   0   0   0   0   5 504   0   0   0   0   0   0]
 [ 10   1   1   0   0   0   0   0   0   0   0   0   0]
 [ 70   0   0   0   0   0   0   0  67   4   1   0   0]
 [ 36   0   0   0   0   0   0   0   0  31   0   5   0]
 [ 31   4   0  54   0   0   0   0   1   0  26   0   0]
 [  0   0   0   0   0   3   0   0   0  10   0  79   0]
 [ 11   0   0   1   0   0   0   0   0   0   0   1  16]]
Epoch 4:
[[879  18   0  21   1   1   1   0  21  25   9   1   9]
 [ 23  23   0  13   1   1   0   0   6   0   2   0   1]
 [  5  29   2   2   0   0   0   0   0   0   0   0   0]
 [ 39   2   0 505   6   3   0   0   0   0  22   0   4]
 [  7   0   0   6  38   0   0   0   0   0   0   0   0]
 [  4   0   0   8   2 170   3   0   3   0   0   2   0]
 [  0   0   0   0   0   6 503   0   0   0   0   0   0]
 [  6   2   0   0   0   0   0   0   3   1   0   0   0]
 [ 57   0   0   0   0   0   0   0  80   4   1   0   0]
 [ 28   0   0   0   0   0   0   0   0  37   0   7   0]
 [ 27   0   0  41   0   0   0   0   0   0  48   0   0]
 [  0   0   0   0   0   2   0   0   0  10   0  80   0]
 [  8   0   0   1   0   0   0   0   0   1   0   1  18]]
=> Iteration 2:
Epoch 1:
[[944   7   1  15   0   0   1   0  14   2   2   0   0]
 [ 42  14   0   7   1   0   0   0   5   0   0   0   1]
 [ 22  12   2   2   0   0   0   0   0   0   0   0   0]
 [128   0   3 420   5   3   4   0   0   0  16   0   2]
 [ 10   0   0   5  34   2   0   0   0   0   0   0   0]
 [  6   0   0   3   0 167  10   0   4   0   0   2   0]
 [  0   0   0   6   0   4 499   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 79   0   0   1   0   0   0   0  61   1   0   0   0]
 [ 51   0   0   0   0   0   0   0   0  18   0   3   0]
 [ 44   0   0  55   0   1   0   0   0   0  16   0   0]
 [  4   0   0   0   0   3   0   0   0  10   0  75   0]
 [ 24   0   0   0   0   0   0   0   1   0   0   0   4]]
Epoch 2:
[[931   6   0  11   0   0   1   0  23   9   0   0   5]
 [ 45  12   0   3   1   0   0   0   8   0   0   0   1]
 [ 17  19   0   2   0   0   0   0   0   0   0   0   0]
 [ 94   1   0 472   5   2   0   0   0   0   3   0   4]
 [  8   0   0   7  36   0   0   0   0   0   0   0   0]
 [  5   0   0  17   2 150  11   0   3   0   0   4   0]
 [  0   0   0   7   0   2 500   0   0   0   0   0   0]
 [  9   0   0   0   0   0   0   0   3   0   0   0   0]
 [ 65   0   0   0   0   0   0   0  76   1   0   0   0]
 [ 41   0   0   0   0   0   0   0   1  22   0   8   0]
 [ 34   0   0  69   0   0   0   0   5   0   8   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0  87   0]
 [ 17   0   0   0   0   0   0   0   0   0   0   1  11]]
Epoch 3:
[[842  21   0  54   0   7   1   0  28   8   8   2  15]
 [ 13  27   0  15   1   1   0   0  11   0   1   0   1]
 [  6  29   0   2   0   0   0   0   0   0   0   0   1]
 [ 24   6   0 517   5   5   0   0   0   0  20   0   4]
 [  6   0   0   7  37   0   0   0   0   0   0   0   1]
 [  2   0   0   7   0 172   5   0   4   0   0   2   0]
 [  0   0   0   5   0   2 500   0   0   0   2   0   0]
 [  6   2   0   0   0   0   0   0   4   0   0   0   0]
 [ 56   0   0   1   0   0   0   0  78   1   5   1   0]
 [ 36   0   0   0   0   0   0   0   2  23   1  10   0]
 [ 27   0   0  47   0   0   0   0   2   0  40   0   0]
 [  0   0   0   0   0   3   0   0   0   6   0  83   0]
 [  8   0   0   1   0   0   0   0   0   0   0   1  19]]
Epoch 4:
[[902  16   0  16   2   0   1   0  18  14   7   0  10]
 [ 29  21   2  10   1   0   0   0   6   0   0   0   1]
 [ 11  20   4   2   0   0   0   0   0   0   0   0   1]
 [ 41   0   1 509   5   4   0   0   0   0  17   0   4]
 [  5   0   0   7  38   0   0   0   0   0   0   0   1]
 [  4   0   0   7   0 171   4   0   4   0   0   2   0]
 [  0   0   0   4   0   3 502   0   0   0   0   0   0]
 [  8   1   1   0   0   0   0   0   2   0   0   0   0]
 [ 65   0   0   1   0   0   0   0  74   2   0   0   0]
 [ 33   0   0   0   0   0   0   0   1  32   1   5   0]
 [ 23   0   0  47   0   0   0   0   5   0  41   0   0]
 [  0   0   0   0   0   2   0   0   0   7   0  83   0]
 [ 10   0   0   1   0   0   0   0   0   0   0   1  17]]
=> Iteration 3:
Epoch 1:
[[868  42   0  13   4   7   1   0  12  28   0   0  11]
 [ 34  22   0   6   1   0   0   0   6   0   0   0   1]
 [  3  33   0   2   0   0   0   0   0   0   0   0   0]
 [121  19   0 415   6   7   0   0   0   0   8   0   5]
 [  6   1   0   7  34   2   0   0   0   0   0   0   1]
 [  3   0   0   6   2 167   7   0   4   1   0   2   0]
 [  0   0   0   9   0   2 498   0   0   0   0   0   0]
 [ 10   1   0   0   0   0   0   0   0   1   0   0   0]
 [ 73   0   0   0   5   0   0   0  59   5   0   0   0]
 [ 29   0   0   0   0   0   0   0   0  41   0   2   0]
 [ 50   0   0  59   0   0   0   0   1   0   6   0   0]
 [  0   0   0   0   0   4   0   0   0  13   0  75   0]
 [ 17   0   0   0   0   0   0   0   1   1   0   0  10]]
Epoch 2:
[[796  39   6  49   0   2   0   0  40  32   1   0  21]
 [ 16  31   0  12   3   0   0   0   6   0   1   0   1]
 [  2  33   1   2   0   0   0   0   0   0   0   0   0]
 [ 35   9   0 522   5   3   0   0   0   0   2   0   5]
 [  6   0   0   9  36   0   0   0   0   0   0   0   0]
 [  3   0   0  13   2 166   2   0   4   0   0   2   0]
 [  0   0   0   7   0   1 501   0   0   0   0   0   0]
 [  4   2   0   0   0   0   0   0   6   0   0   0   0]
 [ 38   0   0   7   5   0   0   0  90   2   0   0   0]
 [ 23   1   0   0   0   0   0   0   0  43   0   5   0]
 [ 36   0   0  72   0   0   0   0   0   0   8   0   0]
 [  0   0   0   0   0   4   0   0   0   5   0  83   0]
 [  8   0   0   1   0   0   0   0   0   0   0   1  19]]
Epoch 3:
[[923   3   0  16   1   0   1   0  16  23   0   1   2]
 [ 54   5   1   2   2   0   0   0   5   0   0   0   1]
 [ 21  13   2   2   0   0   0   0   0   0   0   0   0]
 [ 71   0   0 486   5   4   0   0   0   0  12   0   3]
 [  6   0   0   7  36   2   0   0   0   0   0   0   0]
 [  5   0   0   4   1 174   2   0   3   0   0   3   0]
 [  0   0   0   6   0   4 499   0   0   0   0   0   0]
 [ 10   0   0   0   0   0   0   0   2   0   0   0   0]
 [ 66   0   0   0   4   0   0   0  70   2   0   0   0]
 [ 27   0   0   0   0   0   0   0   0  38   0   7   0]
 [ 36   0   0  56   0   0   0   0   0   0  24   0   0]
 [  0   0   0   0   0   2   0   0   0   4   0  86   0]
 [ 14   0   0   1   0   0   0   0   0   0   0   1  13]]
Epoch 4:
[[883   9   8  27   1   3   0   0  20  23   6   1   5]
 [ 33  18   4   5   1   1   0   0   7   0   0   0   1]
 [ 11  18   7   2   0   0   0   0   0   0   0   0   0]
 [ 41   5   0 502   6   4   0   0   0   0  19   0   4]
 [  7   0   0   5  38   1   0   0   0   0   0   0   0]
 [  3   0   0   3   0 179   1   0   4   0   0   2   0]
 [  0   0   0   1   0   2 506   0   0   0   0   0   0]
 [  7   1   0   0   0   0   0   0   4   0   0   0   0]
 [ 48   0   0   1   4   0   0   0  85   2   2   0   0]
 [ 29   0   0   0   0   0   0   0   0  38   0   5   0]
 [ 27   0   0  46   1   0   0   0   1   0  41   0   0]
 [  0   0   0   0   0   2   0   0   0  10   0  80   0]
 [ 13   0   0   1   0   0   0   0   0   0   0   1  14]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.112313   0.665314   0.787197   0.787197    0.787197      0.775269      0.787197       0.770489
Iteration 1    1.122767   0.677601   0.782353   0.782353    0.782353      0.765746      0.782353       0.755221
Iteration 2    1.138081   0.700497   0.779931   0.779931    0.779931      0.766395      0.779931       0.754250
Iteration 3    1.171629   0.747874   0.759516   0.759516    0.759516      0.750695      0.759516       0.743105

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.771983   0.727915   0.774394   0.774394    0.774394      0.785515      0.774394       0.755920
Iteration 1    0.747655   0.808092   0.759170   0.759170    0.759170      0.762971      0.759170       0.719481
Iteration 2    0.728202   0.617176   0.797578   0.797578    0.797578      0.779406      0.797578       0.770292
Iteration 3    0.765397   0.619483   0.794464   0.794464    0.794464      0.794299      0.794464       0.781807

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.612100   0.574000   0.820069   0.820069    0.820069      0.804524      0.820069       0.808266
Iteration 1    0.625331   0.615082   0.816263   0.816263    0.816263      0.806313      0.816263       0.802736
Iteration 2    0.583370   0.570330   0.808997   0.808997    0.808997      0.792467      0.808997       0.797738
Iteration 3    0.626656   0.593387   0.815225   0.815225    0.815225      0.800092      0.815225       0.793265

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.508944   0.555241   0.827336   0.827336    0.827336      0.812585      0.827336       0.815503
Iteration 1    0.505849   0.577773   0.824567   0.824567    0.824567      0.821797      0.824567       0.815822
Iteration 2    0.477854   0.551044   0.828374   0.828374    0.828374      0.815475      0.828374       0.816411
Iteration 3    0.521961   0.534633   0.827336   0.827336    0.827336      0.813973      0.827336       0.817590

