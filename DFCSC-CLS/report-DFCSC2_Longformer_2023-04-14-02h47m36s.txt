RESULTS REPORT
Model: Longformer
Encoder: allenai/longformer-base-4096
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 1024
Min context length: 350
Use Malik dataset: False
Batch size: 4
Dropout rate: 0.1
Learning rate: 2e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 01h46m48s
GPU name: Quadro RTX 6000
GPU memory: 22.17

Averages:
Epoch Train loss   std    Test loss   std    P (micro) P std  R (micro) R std  F1 (micro) F1 std P (weighted) P std  R (weighted) R std  F1 (weighted) F1 std
  1    1.175709  0.029942  0.714741 0.019536   0.7757  0.0095   0.7757  0.0095   0.7757   0.0095    0.7525    0.0074    0.7757    0.0095     0.7532    0.0043
  2    0.756781  0.007520  0.751759 0.075990   0.7763  0.0128   0.7763  0.0128   0.7763   0.0128    0.7798    0.0101    0.7763    0.0128     0.7446    0.0150
  3    0.612549  0.010699  0.566257 0.006964   0.8189  0.0031   0.8189  0.0031   0.8189   0.0031    0.8049    0.0040    0.8189    0.0031     0.8049    0.0017
  4    0.499314  0.011051  0.561232 0.015806   0.8196  0.0025   0.8196  0.0025   0.8196   0.0025    0.8078    0.0021    0.8196    0.0025     0.8101    0.0026

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[862  14   0  55   3   2   1   0  34   5   2   1   7]
 [ 23  20   0  14   1   0   0   0  11   0   0   0   1]
 [ 16  20   0   2   0   0   0   0   0   0   0   0   0]
 [ 53   2   0 506   5   3   1   0   4   0   3   0   4]
 [  7   0   0  10  34   0   0   0   0   0   0   0   0]
 [  3   0   0   8   2 158  14   0   4   0   0   3   0]
 [  0   0   0   4   0   2 503   0   0   0   0   0   0]
 [ 10   0   0   0   0   0   0   0   2   0   0   0   0]
 [ 51   1   0   5   3   0   0   0  82   0   0   0   0]
 [ 41   0   0   1   0   0   0   0   1  26   0   3   0]
 [ 31   0   0  76   0   0   0   0   9   0   0   0   0]
 [  2   0   0   0   0   4   0   0   0  11   0  75   0]
 [ 19   0   0   0   0   0   0   0   3   0   0   1   6]]
Epoch 2:
[[964   0   0   7   0   1   0   0   8   5   0   1   0]
 [ 56   9   0   1   1   0   0   0   2   0   0   0   1]
 [ 26   9   1   2   0   0   0   0   0   0   0   0   0]
 [205   0   0 363   5   4   0   0   1   0   3   0   0]
 [ 10   0   0   5  36   0   0   0   0   0   0   0   0]
 [ 10   0   0   3   2 164   5   0   2   0   0   6   0]
 [  0   0   0   7   0   1 501   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 90   0   0   0   0   0   0   0  50   1   0   1   0]
 [ 49   0   0   0   0   0   0   0   0  18   0   5   0]
 [ 59   0   0  38   0   1   0   0   3   0  13   2   0]
 [  1   0   0   0   0   0   0   0   0   4   0  87   0]
 [ 25   0   0   0   0   0   0   0   0   0   0   0   4]]
Epoch 3:
[[880  10   3  32   1   1   0   0  19  33   3   1   3]
 [ 31  16   7  10   1   0   0   0   4   0   0   0   1]
 [ 11  13  12   2   0   0   0   0   0   0   0   0   0]
 [ 44   6   4 511   6   2   0   0   0   0   4   0   4]
 [  5   0   0   8  38   0   0   0   0   0   0   0   0]
 [  2   0   0   4   1 177   1   0   4   0   0   3   0]
 [  0   0   0   7   0   5 497   0   0   0   0   0   0]
 [ 10   0   1   0   0   0   0   0   0   1   0   0   0]
 [ 54   0   0   4   2   0   0   0  77   3   2   0   0]
 [ 24   0   0   0   0   0   0   0   0  45   0   3   0]
 [ 31   0   0  65   0   1   0   0   3   0  16   0   0]
 [  0   0   0   0   0   1   0   0   0   5   0  86   0]
 [ 13   0   0   1   0   0   0   0   0   2   0   0  13]]
Epoch 4:
[[861  10   3  27   3   2   0   0  23  31  15   0  11]
 [ 30  14   6  10   1   1   0   0   6   0   1   0   1]
 [ 12  11  13   2   0   0   0   0   0   0   0   0   0]
 [ 43   5   3 503   6   3   0   0   0   0  14   0   4]
 [  5   0   0   7  39   0   0   0   0   0   0   0   0]
 [  3   0   0   3   1 177   2   0   3   0   0   3   0]
 [  0   0   0   5   0   3 501   0   0   0   0   0   0]
 [  9   0   1   0   0   0   0   0   2   0   0   0   0]
 [ 43   0   0   4   3   0   0   0  88   2   2   0   0]
 [ 26   0   0   0   0   0   0   0   0  42   0   4   0]
 [ 28   0   0  51   0   0   0   0   0   0  37   0   0]
 [  0   0   0   0   0   2   0   0   0   5   0  85   0]
 [  8   0   0   1   0   0   0   0   0   1   0   1  18]]
=> Iteration 1:
Epoch 1:
[[876   5   1  62   2   1   0   0  12  22   0   3   2]
 [ 37   4   3  20   1   0   0   0   4   0   0   0   1]
 [ 18  13   4   3   0   0   0   0   0   0   0   0   0]
 [ 39   0   0 531   5   3   0   0   0   0   1   0   2]
 [  7   0   0  10  34   0   0   0   0   0   0   0   0]
 [  3   0   0  13   2 152   6   0   4   0   0  12   0]
 [  0   0   0  13   0   0 496   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [ 82   0   0  11   0   0   0   0  45   2   0   2   0]
 [ 24   0   0   1   0   0   0   0   0  24   0  23   0]
 [ 37   0   0  71   0   0   0   0   5   0   1   2   0]
 [  0   0   0   0   0   0   0   0   0   1   0  91   0]
 [ 23   0   0   0   0   0   0   0   0   0   0   2   4]]
Epoch 2:
[[956   6   0  19   0   0   1   0   0   3   0   1   0]
 [ 40  18   0  10   1   0   0   0   0   0   0   0   1]
 [ 19  17   0   2   0   0   0   0   0   0   0   0   0]
 [ 54   6   0 503   5   5   0   0   0   0   5   0   3]
 [  7   0   0   9  35   0   0   0   0   0   0   0   0]
 [ 12   0   0   8   0 164   6   0   0   0   0   2   0]
 [  0   0   0  10   0   0 499   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [133   0   0   0   0   0   0   0   7   2   0   0   0]
 [ 45   0   0   0   0   0   0   0   0  24   0   3   0]
 [ 43   0   0  65   0   0   0   0   0   0   8   0   0]
 [  0   0   0   0   0   2   0   0   0   8   0  82   0]
 [ 23   0   0   0   0   0   0   0   0   0   0   1   5]]
Epoch 3:
[[889  16   2  11   1   1   0   0  13  33   6   3  11]
 [ 30  22   3  10   1   0   0   0   3   0   0   0   1]
 [ 11  16   9   2   0   0   0   0   0   0   0   0   0]
 [ 49   8   0 486   6   4   0   0   0   0  24   0   4]
 [  6   0   0   7  38   0   0   0   0   0   0   0   0]
 [  4   0   0   6   1 173   3   0   3   0   0   2   0]
 [  0   0   0   9   0   4 496   0   0   0   0   0   0]
 [ 11   0   1   0   0   0   0   0   0   0   0   0   0]
 [ 77   0   0   0   0   0   0   0  61   4   0   0   0]
 [ 22   0   0   0   0   0   0   0   0  41   0   9   0]
 [ 27   0   0  38   1   0   0   0   7   0  43   0   0]
 [  0   0   0   0   0   2   0   0   0   7   0  83   0]
 [  9   0   0   1   0   0   0   0   0   1   0   1  17]]
Epoch 4:
[[875  19   2  23   2   1   0   0  23  21   8   2  10]
 [ 27  21   3  11   1   0   0   0   6   0   0   0   1]
 [ 14  14   8   2   0   0   0   0   0   0   0   0   0]
 [ 38   5   0 504   6   4   0   0   0   0  20   0   4]
 [  5   0   0   8  38   0   0   0   0   0   0   0   0]
 [  4   0   0   7   1 171   3   0   3   0   0   3   0]
 [  0   0   0   9   0   3 497   0   0   0   0   0   0]
 [ 10   0   1   0   0   0   0   0   1   0   0   0   0]
 [ 62   0   0   1   0   0   0   0  76   3   0   0   0]
 [ 24   0   0   0   0   0   0   0   0  41   0   7   0]
 [ 25   0   0  41   1   0   0   0   8   0  41   0   0]
 [  0   0   0   0   0   2   0   0   0   9   0  81   0]
 [ 11   0   0   1   0   0   0   0   0   0   0   1  16]]
=> Iteration 2:
Epoch 1:
[[867  48   0  13   3   0   1   0  41   1   1   2   9]
 [ 25  29   3   4   1   0   0   0   7   0   0   0   1]
 [  6  30   0   2   0   0   0   0   0   0   0   0   0]
 [ 98   7   0 453   6   4   0   0   0   0  10   0   3]
 [  6   1   0   7  36   1   0   0   0   0   0   0   0]
 [  4   0   0   9   3 160   9   0   4   0   0   3   0]
 [  0   0   0  16   0   7 486   0   0   0   0   0   0]
 [  6   1   0   0   0   0   0   0   5   0   0   0   0]
 [ 39   4   0   5   2   0   0   0  88   0   2   2   0]
 [ 43   0   0   0   0   0   0   0   2  15   0  12   0]
 [ 38   0   0  68   0   1   0   0   2   0   4   3   0]
 [  2   0   0   0   0   0   0   0   0   3   0  87   0]
 [ 18   1   0   1   0   0   0   0   2   0   0   1   6]]
Epoch 2:
[[791  61   0  74   2  11   0   0  18  21   0   3   5]
 [ 12  39   0  13   1   0   0   0   4   0   0   0   1]
 [  1  35   0   2   0   0   0   0   0   0   0   0   0]
 [ 23  14   0 521   6   5   0   0   0   0   8   0   4]
 [  5   0   0   9  37   0   0   0   0   0   0   0   0]
 [  2   0   0   6   0 176   2   0   4   0   0   2   0]
 [  0   0   0   9   0  15 485   0   0   0   0   0   0]
 [ 10   2   0   0   0   0   0   0   0   0   0   0   0]
 [ 62   4   0   5   2   0   0   0  64   3   0   2   0]
 [ 25   0   0   0   0   0   0   0   0  32   0  15   0]
 [ 25   0   0  70   0   2   0   0   9   0  10   0   0]
 [  0   0   0   0   0   2   0   0   0   3   0  87   0]
 [ 17   1   0   0   0   0   0   0   0   0   0   2   9]]
Epoch 3:
[[909   7   1  33   1   1   0   0  15   9   0   0  10]
 [ 30  18   1  13   1   0   0   0   6   0   0   0   1]
 [ 18  17   1   2   0   0   0   0   0   0   0   0   0]
 [ 36   1   0 516   6   4   0   0   0   0  14   0   4]
 [  5   0   0   8  38   0   0   0   0   0   0   0   0]
 [  2   0   0  11   0 171   2   0   4   0   0   2   0]
 [  0   0   0   6   0   5 498   0   0   0   0   0   0]
 [ 11   0   1   0   0   0   0   0   0   0   0   0   0]
 [ 53   0   0   0   0   0   0   0  86   3   0   0   0]
 [ 38   0   0   0   0   0   0   0   0  31   0   3   0]
 [ 24   0   0  54   0   2   0   0  11   0  25   0   0]
 [  0   0   0   0   0   4   0   0   0  11   0  77   0]
 [ 16   0   0   1   0   0   0   0   0   1   0   0  11]]
Epoch 4:
[[870  20   7  26   1   1   0   0  21  26   1   2  11]
 [ 28  18  10   6   1   0   0   0   6   0   0   0   1]
 [  9  16  11   2   0   0   0   0   0   0   0   0   0]
 [ 40   6   3 498   6   4   0   0   0   0  19   0   5]
 [  5   0   0   7  39   0   0   0   0   0   0   0   0]
 [  2   0   0   7   1 173   3   0   4   0   0   2   0]
 [  0   0   0   6   0   6 497   0   0   0   0   0   0]
 [ 11   0   1   0   0   0   0   0   0   0   0   0   0]
 [ 56   0   0   1   0   0   0   0  80   3   2   0   0]
 [ 25   0   0   0   0   0   0   0   0  41   0   6   0]
 [ 24   0   0  50   0   0   0   0   9   0  33   0   0]
 [  0   0   0   0   0   1   0   0   0   7   0  84   0]
 [ 13   0   0   0   0   0   0   0   0   1   0   1  14]]
=> Iteration 3:
Epoch 1:
[[790  56   1  27   1   7   3   0  56  41   3   1   0]
 [ 11  31   0  12   1   1   1   0  13   0   0   0   0]
 [  5  31   0   2   0   0   0   0   0   0   0   0   0]
 [ 51  28   0 457   6   7   7   0  10   1  11   0   3]
 [  7   1   0   5  35   1   2   0   0   0   0   0   0]
 [  2   0   0   4   2 150  28   0   4   0   0   2   0]
 [  0   0   0   5   0   0 504   0   0   0   0   0   0]
 [  7   1   0   0   0   0   0   0   2   2   0   0   0]
 [ 26   3   1   5   3   0   1   0  96   7   0   0   0]
 [ 21   0   0   0   0   0   0   0   1  46   0   4   0]
 [ 34   1   0  60   0   3   0   0   7   0  11   0   0]
 [  0   0   0   0   0   4   0   0   0   8   0  80   0]
 [ 17   1   0   0   0   0   1   0   6   2   0   0   2]]
Epoch 2:
[[962   0   0  10   0   1   0   0   1   7   0   1   4]
 [ 63   3   0   1   1   0   0   0   1   0   0   0   1]
 [ 30   6   0   2   0   0   0   0   0   0   0   0   0]
 [175   0   0 379   5   6   1   0   0   0  12   0   3]
 [  8   0   0   3  38   2   0   0   0   0   0   0   0]
 [ 11   0   0   1   1 173   3   0   1   0   0   2   0]
 [  0   0   0   1   0   1 507   0   0   0   0   0   0]
 [ 12   0   0   0   0   0   0   0   0   0   0   0   0]
 [125   0   0   0   0   0   0   0  12   5   0   0   0]
 [ 42   0   0   0   0   0   0   0   0  23   0   7   0]
 [ 59   0   0  32   1   1   0   0   0   0  22   1   0]
 [  0   0   0   0   0   1   0   0   0   5   0  86   0]
 [ 21   0   0   0   0   0   0   0   0   0   0   1   7]]
Epoch 3:
[[911   9   3  14   0   1   0   0  19  17   9   1   2]
 [ 33  20   1  10   1   0   0   0   4   0   0   0   1]
 [ 15  21   0   2   0   0   0   0   0   0   0   0   0]
 [ 55   7   0 482   5   5   0   0   0   0  25   0   2]
 [  6   0   0   7  37   1   0   0   0   0   0   0   0]
 [  4   0   0   7   1 171   3   0   4   0   0   2   0]
 [  0   0   0   2   0   2 505   0   0   0   0   0   0]
 [  9   1   0   0   0   0   0   0   2   0   0   0   0]
 [ 67   0   0   1   2   0   0   0  68   4   0   0   0]
 [ 35   0   0   0   0   0   0   0   0  33   0   4   0]
 [ 29   3   0  36   0   1   0   0   5   0  42   0   0]
 [  0   0   0   0   0   1   0   0   0   8   0  83   0]
 [ 20   0   0   0   0   0   0   0   0   0   0   1   8]]
Epoch 4:
[[895  12   8  19   0   1   0   0  14  16   7   2  12]
 [ 29  18   6  10   1   0   0   0   5   0   0   0   1]
 [ 14  14   8   2   0   0   0   0   0   0   0   0   0]
 [ 38   6   1 504   6   4   0   0   0   0  17   0   5]
 [  5   0   0   7  39   0   0   0   0   0   0   0   0]
 [  3   0   0   5   0 176   2   0   4   0   0   2   0]
 [  0   0   0   8   0   2 499   0   0   0   0   0   0]
 [  9   1   0   0   0   0   0   0   2   0   0   0   0]
 [ 68   0   0   1   2   0   0   0  68   3   0   0   0]
 [ 33   0   0   0   0   0   0   0   0  32   0   7   0]
 [ 26   5   0  46   0   1   0   0   8   0  30   0   0]
 [  0   0   0   0   0   1   0   0   0   7   0  84   0]
 [ 11   0   0   0   0   0   0   0   0   0   0   1  17]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.185980   0.691604   0.786159   0.786159    0.786159      0.740629      0.786159       0.759838
Iteration 1    1.152640   0.704049   0.782699   0.782699    0.782699      0.756475      0.782699       0.747967
Iteration 2    1.144249   0.719312   0.771972   0.771972    0.771972      0.752705      0.771972       0.752331
Iteration 3    1.219967   0.744000   0.761938   0.761938    0.761938      0.760312      0.761938       0.752762

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.761399   0.779210   0.764706   0.764706    0.764706      0.788382      0.764706       0.733106
Iteration 1    0.748880   0.704714   0.796194   0.796194    0.796194      0.790865      0.796194       0.753665
Iteration 2    0.750143   0.661709   0.778893   0.778893    0.778893      0.772845      0.778893       0.764321
Iteration 3    0.766701   0.861405   0.765398   0.765398    0.765398      0.767002      0.765398       0.727335

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.603356   0.577656   0.819377   0.819377    0.819377      0.807315      0.819377       0.804043
Iteration 1    0.605668   0.564339   0.815917   0.815917    0.815917      0.808728      0.815917       0.807013
Iteration 2    0.610667   0.558738   0.823875   0.823875    0.823875      0.805369      0.823875       0.806125
Iteration 3    0.630507   0.564293   0.816609   0.816609    0.816609      0.798288      0.816609       0.802605

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.498707   0.552750   0.822837   0.822837    0.822837      0.810314      0.822837       0.813908
Iteration 1    0.484183   0.583700   0.819723   0.819723    0.819723      0.809389      0.819723       0.810949
Iteration 2    0.498958   0.541496   0.815917   0.815917    0.815917      0.806041      0.815917       0.807664
Iteration 3    0.515408   0.566981   0.820069   0.820069    0.820069      0.805473      0.820069       0.807820

