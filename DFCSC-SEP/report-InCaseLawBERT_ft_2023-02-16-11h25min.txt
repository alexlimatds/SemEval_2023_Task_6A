RESULTS REPORT
Model: InCaseLawBERT
Encoder: law-ai/InCaseLawBERT
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 512
Min context length: 350
Batch size: 4
Dropout rate: 0.1
Learning rate: 1e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 02h21m03s
GPU name: NVIDIA GeForce GTX 1080 Ti
GPU memory: 10.92

Averages:
Epoch Train loss    std    Test loss    std    P (micro)  P std  R (micro)  R std  F1 (micro)  F1 std P (weighted)  P std  R (weighted)  R std  F1 (weighted)  F1 std
   1   1.010929   0.007046  0.841243  0.027920   0.7301   0.0022   0.7301   0.0022   0.7301    0.0022    0.7210     0.0114    0.7301     0.0022     0.7073     0.0128
   2   0.792689   0.006465  0.803280  0.014415   0.7449   0.0069   0.7449   0.0069   0.7449    0.0069    0.7344     0.0081    0.7449     0.0069     0.7293     0.0076
   3   0.756727   0.007563  0.799867  0.019599   0.7381   0.0080   0.7381   0.0080   0.7381    0.0080    0.7272     0.0099    0.7381     0.0080     0.7234     0.0089
   4   0.694501   0.007584  0.776795  0.014126   0.7416   0.0058   0.7416   0.0058   0.7416    0.0058    0.7254     0.0066    0.7416     0.0058     0.7280     0.0056

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[812  24  27  26   7   1   1   0  21  14   0  46   7]
 [ 19  18  22   3   3   0   0   0   5   0   0   0   0]
 [  8   9  19   0   2   0   0   0   0   0   0   0   0]
 [ 39  17   4 467  16   5  20   0   0   0   8   0   5]
 [  7   1   0   7  34   0   2   0   0   0   0   0   0]
 [  9   0   0  12   2  71  66   0   1   1   0  30   0]
 [  0   0   0   5   0   0 504   0   0   0   0   0   0]
 [  8   1   0   0   0   0   0   0   3   0   0   0   0]
 [ 67   0   0   0   0   0   3   0  63   9   0   0   0]
 [  6   0   0   0   0   1   0   0   0  25   0  40   0]
 [ 43   1   0  54   3   4   6   0   0   0   5   0   0]
 [  0   0   0   0   0   5   0   0   0   2   0  85   0]
 [ 15   1   0   1   0   0   0   0   0   1   0   1  10]]
Epoch 2:
[[835   1   4  23  12   2   1   0  54  34   1  15   4]
 [ 37   2   6   9   3   0   0   1  12   0   0   0   0]
 [ 19   0  14   1   2   2   0   0   0   0   0   0   0]
 [ 67   0   0 425  20   8  20   0   1   0  35   0   5]
 [  9   0   0   8  32   2   0   0   0   0   0   0   0]
 [  4   0   0   6   3 123  28   0   5   1   0  22   0]
 [  0   0   0   2   0   6 496   0   5   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 38   0   0   0   0   0   0   0  96   8   0   0   0]
 [ 22   0   0   0   0   1   0   0   2  28   0  19   0]
 [ 21   0   0  44   4   6   4   0  16   0  21   0   0]
 [  0   0   0   0   0  11   0   0   2   8   0  71   0]
 [ 10   0   0   0   0   0   0   0   3   0   1   0  15]]
Epoch 3:
[[861  20   0  62   6   1   1   0  24   4   3   2   2]
 [ 35  15   2  10   3   0   0   0   5   0   0   0   0]
 [ 17  14   4   3   0   0   0   0   0   0   0   0   0]
 [ 53  14   0 477  11   6   9   0   0   0  11   0   0]
 [ 10   0   0  15  24   2   0   0   0   0   0   0   0]
 [  7   0   0  16   1 109  28   0   4   5   0  22   0]
 [  0   0   0   6   0   6 492   0   5   0   0   0   0]
 [  8   1   0   0   0   0   0   0   3   0   0   0   0]
 [ 69   0   0   3   0   0   0   0  70   0   0   0   0]
 [ 46   0   0   0   0   1   0   0   0  13   0  12   0]
 [ 29   0   0  63   4   2   0   0   0   0  18   0   0]
 [  7   0   0   0   0   9   0   0   0  14   0  62   0]
 [ 15   1   0   1   0   0   0   0   0   0   0   0  12]]
Epoch 4:
[[854  12   9  45   6   1   1   0  33  20   0   2   3]
 [ 37  12   6   5   3   0   0   0   7   0   0   0   0]
 [ 13   7  15   3   0   0   0   0   0   0   0   0   0]
 [ 58  14   0 459  15   6   9   0   0   0  15   0   5]
 [  8   0   0  12  29   2   0   0   0   0   0   0   0]
 [  7   0   0  14   1 115  27   0   4   1   0  23   0]
 [  0   0   0   7   0   6 496   0   0   0   0   0   0]
 [  8   1   0   0   0   0   0   0   3   0   0   0   0]
 [ 69   0   0   0   0   0   1   0  72   0   0   0   0]
 [ 41   0   0   0   0   2   0   0   2  13   0  14   0]
 [ 26   0   0  49   4   4   0   0   5   0  28   0   0]
 [  5   0   0   0   0  16   0   0   2   9   0  60   0]
 [ 13   1   0   1   0   0   0   0   0   0   0   0  14]]
=> Iteration 1:
Epoch 1:
[[890   6   2  46   7   0   1   0  15   0   0  11   8]
 [ 46   5   0  14   3   0   0   0   2   0   0   0   0]
 [ 26   6   3   3   0   0   0   0   0   0   0   0   0]
 [ 47   3   0 491   8   1   8   0   0   0  18   0   5]
 [  7   0   0  15  27   2   0   0   0   0   0   0   0]
 [ 14   0   0  34   2  74  19   0   0   0   1  48   0]
 [  0   0   0  11   0   9 485   0   0   0   4   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [106   0   0   0   0   0   0   0  33   0   0   3   0]
 [ 54   0   0   0   0   0   0   0   0   0   0  18   0]
 [ 32   0   0  52   3   2   0   0   0   0  27   0   0]
 [ 20   0   0   0   0   0   0   0   0   0   0  72   0]
 [ 16   0   0   0   0   0   0   0   0   0   1   0  12]]
Epoch 2:
[[837  23   5  21   8   0   1   0  35   6   1  40   9]
 [ 21  22   9   3   3   0   0   0  12   0   0   0   0]
 [ 15  15   4   0   2   0   0   0   0   0   0   2   0]
 [ 60  16   0 444  18   6   6   0   1   0  25   0   5]
 [  9   0   0   7  33   2   0   0   0   0   0   0   0]
 [  7   0   0  16   2  92  19   0   5   0   0  51   0]
 [  0   0   0  19   0   9 481   0   0   0   0   0   0]
 [  8   1   0   0   0   0   0   0   3   0   0   0   0]
 [ 58   0   0   0   0   0   0   0  79   4   0   1   0]
 [ 22   0   0   0   0   0   0   0   2  12   0  36   0]
 [ 25   1   0  40   4   6   0   0  16   0  24   0   0]
 [  0   0   0   0   0   0   0   0   2   1   0  89   0]
 [ 10   1   0   0   0   0   0   0   0   0   1   1  16]]
Epoch 3:
[[851   6   2  26   6   0   1   0  43  34   6   9   2]
 [ 41  11   2   3   3   0   0   0  10   0   0   0   0]
 [ 21   8   7   2   0   0   0   0   0   0   0   0   0]
 [ 75  14   0 412  16   8  14   0   5   0  36   0   1]
 [  9   0   0  12  28   2   0   0   0   0   0   0   0]
 [  6   0   0   6   1 124  18   0   5   3   0  29   0]
 [  0   0   0   2   0  20 482   0   5   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 46   0   0   0   0   0   0   0  90   6   0   0   0]
 [ 20   0   0   0   0   0   0   0   2  30   0  20   0]
 [ 23   1   0  33   3   6   3   0  16   0  31   0   0]
 [  2   0   0   0   0   4   0   0   2   8   0  76   0]
 [ 13   0   0   0   0   0   0   0   2   1   1   0  12]]
Epoch 4:
[[829  19  13  45  11   2   1   0  33  18   2   2  11]
 [ 27  11  15  10   3   0   0   0   4   0   0   0   0]
 [ 12   9  13   2   0   2   0   0   0   0   0   0   0]
 [ 54  12   2 465  18   6   9   0   0   0  14   0   1]
 [  9   0   0  12  28   2   0   0   0   0   0   0   0]
 [  6   0   0  12   2 119  25   0   4   1   0  23   0]
 [  0   0   0   8   0   9 492   0   0   0   0   0   0]
 [  5   0   1   0   0   0   0   0   6   0   0   0   0]
 [ 68   0   0   0   0   0   1   0  73   0   0   0   0]
 [ 38   0   0   0   0   2   0   0   2  16   0  14   0]
 [ 32   0   0  53   4   6   0   0   5   0  16   0   0]
 [  4   0   0   0   0  16   0   0   2  11   0  59   0]
 [  9   0   1   1   0   0   0   0   0   0   0   0  18]]
=> Iteration 2:
Epoch 1:
[[915   8   2  22   2   2   1   0   9   9   0  14   2]
 [ 52   8   4   6   0   0   0   0   0   0   0   0   0]
 [ 23   6   7   0   2   0   0   0   0   0   0   0   0]
 [ 80   0   0 470   9   3   8   0   0   0  10   0   1]
 [ 12   0   0  12  25   2   0   0   0   0   0   0   0]
 [ 17   0   0  26   2 108  19   0   0   5   0  15   0]
 [  9   0   0  15   0   9 476   0   0   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [114   0   0   0   0   0   0   0  22   3   0   3   0]
 [ 48   0   0   0   0   3   0   0   0  12   0   9   0]
 [ 38   0   0  58   2   2   0   0   0   0  16   0   0]
 [ 19   0   0   0   0  22   0   0   0  11   0  40   0]
 [ 23   0   0   1   0   0   0   0   0   0   0   0   5]]
Epoch 2:
[[833   7   3  67   6   1   1   0  35   7  10   1  15]
 [ 27   6   3  21   1   0   0   0  10   0   2   0   0]
 [ 19   9   7   3   0   0   0   0   0   0   0   0   0]
 [ 30   0   0 502   4   6   9   0   0   0  25   0   5]
 [  6   0   0  23  19   2   0   0   0   0   0   0   1]
 [  5   0   0  14   0 111  28   0   5   8   0  21   0]
 [  0   0   0   6   0   6 492   0   5   0   0   0   0]
 [  8   1   0   0   0   0   0   0   3   0   0   0   0]
 [ 51   0   0   4   0   0   0   0  84   3   0   0   0]
 [ 46   0   0   0   0   2   0   0   0  19   0   5   0]
 [ 20   0   0  53   2   4   0   0   5   0  32   0   0]
 [ 12   0   0   0   0   9   0   0   0  10   0  61   0]
 [ 10   0   0   2   0   0   0   0   0   0   0   0  17]]
Epoch 3:
[[840  11   2  53  11   1   1   0  51   7   5   2   2]
 [ 28  15   2   9   3   0   0   0  11   0   2   0   0]
 [ 17  11   7   3   0   0   0   0   0   0   0   0   0]
 [ 61  12   0 429  15   7  23   0   1   0  33   0   0]
 [  8   0   0  14  25   3   0   0   1   0   0   0   0]
 [  6   0   0   6   2 109  38   0   5   6   0  20   0]
 [  0   0   0   5   0   2 492   0  10   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 38   0   0   0   0   0   3   0  98   3   0   0   0]
 [ 47   0   0   0   0   2   0   0   2  10   0  11   0]
 [ 21   0   0  36   4   7   7   0  16   0  25   0   0]
 [  7   0   0   0   0  11   0   0   2  12   0  60   0]
 [ 16   1   0   0   0   0   0   0   1   0   1   0  10]]
Epoch 4:
[[844  17   8  51   1   1   1   0  26  26   1   2   8]
 [ 32  12   8   9   2   0   0   0   5   0   2   0   0]
 [ 18  10   8   2   0   0   0   0   0   0   0   0   0]
 [ 57  16   0 454  11   6   8   0   1   0  23   0   5]
 [ 12   0   0  15  22   2   0   0   0   0   0   0   0]
 [  6   0   0  20   1 113  20   0   4   6   0  22   0]
 [  0   0   0   9   0   9 481   0  10   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 71   0   0   0   0   0   4   0  64   3   0   0   0]
 [ 32   0   0   0   0   2   0   0   0  25   0  13   0]
 [ 26   1   0  52   4   4   0   0  11   0  18   0   0]
 [  5   0   0   0   0  10   0   0   0  13   0  64   0]
 [ 12   1   0   0   0   0   0   0   0   0   1   0  15]]
=> Iteration 3:
Epoch 1:
[[784  85   0  29  14   1   1   0  39  11   6   9   7]
 [  4  41   0   9   3   0   0   0  12   0   1   0   0]
 [  5  31   0   0   2   0   0   0   0   0   0   0   0]
 [ 31  20   0 459  18   7  15   0   1   0  25   0   5]
 [  6   1   0   7  34   2   0   0   0   0   1   0   0]
 [  9   0   0   6   4 106  38   0   5   3   3  18   0]
 [  0   0   0   5   0   2 493   0   9   0   0   0   0]
 [  4   2   0   0   0   0   0   0   6   0   0   0   0]
 [ 51  10   0   0   0   0   3   0  74   3   0   1   0]
 [ 29   0   0   0   0   2   0   0   2  32   0   7   0]
 [ 21   0   0  50   3   4   0   0  11   0  27   0   0]
 [ 17   0   0   0   0   9   4   0   4  18   0  40   0]
 [ 13   1   0   0   0   0   0   0   0   0   1   0  14]]
Epoch 2:
[[878  16   4  27   7   0   1   0  23   8   0  19   3]
 [ 43   5   7   5   3   0   0   0   7   0   0   0   0]
 [ 18   7   9   0   2   0   0   0   0   0   0   2   0]
 [ 84   6   4 429  12   8  15   0   0   0  18   0   5]
 [ 10   0   0   6  31   4   0   0   0   0   0   0   0]
 [  9   0   0   4   2 106  39   0   2   0   0  30   0]
 [  0   0   0   5   0   2 493   0   9   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 70   0   0   0   0   0   1   0  67   3   0   1   0]
 [ 42   0   0   0   0   0   0   0   0   8   0  22   0]
 [ 33   0   0  52   2   7   0   0   0   0  22   0   0]
 [  7   0   0   0   0   5   0   0   0   3   0  77   0]
 [ 16   0   0   0   0   0   0   0   0   0   1   0  12]]
Epoch 3:
[[860  10   4  34   2   2   3   0  25  20   0  25   1]
 [ 45  11   3   4   2   0   0   0   5   0   0   0   0]
 [ 19   8   7   0   2   2   0   0   0   0   0   0   0]
 [ 94  12   0 416  16   9   7   0   1   0  26   0   0]
 [ 12   0   0   9  28   2   0   0   0   0   0   0   0]
 [  6   0   0   7   2 143   8   0   4   1   1  20   0]
 [  0   0   0   9   0  35 451   0  10   0   4   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 67   0   0   0   0   0   1   0  67   4   0   3   0]
 [ 23   0   0   0   0   2   0   0   2  22   0  23   0]
 [ 31   1   0  49   4   6   0   0   6   0  19   0   0]
 [  0   0   0   0   0  15   0   0   2   2   0  73   0]
 [ 23   0   0   1   0   0   0   0   0   0   0   0   5]]
Epoch 4:
[[839  17   4  51   6   1   1   0  27  32   1   3   4]
 [ 25  13  10  10   3   0   0   0   7   0   2   0   0]
 [ 18  11   7   2   0   0   0   0   0   0   0   0   0]
 [ 51  14   0 467  11   6   8   0   0   0  19   0   5]
 [ 10   0   0  15  24   2   0   0   0   0   0   0   0]
 [  6   0   0  16   1 116  21   0   4   3   0  25   0]
 [  0   0   0   8   0   9 482   0  10   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 68   0   0   0   0   0   1   0  69   4   0   0   0]
 [ 31   0   0   0   0   2   0   0   2  24   0  13   0]
 [ 26   0   0  52   4   6   0   0   0   0  28   0   0]
 [  6   0   0   0   0   9   0   0   2  12   0  63   0]
 [ 12   1   0   0   0   0   0   0   0   0   1   0  15]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.002683   0.846716   0.731142   0.731142    0.731142      0.730272      0.731142       0.713165
Iteration 1    1.015959   0.814880   0.733218   0.733218    0.733218      0.706632      0.733218       0.696952
Iteration 2    1.005461   0.884666   0.728028   0.728028    0.728028      0.713174      0.728028       0.693625
Iteration 3    1.019612   0.818712   0.728028   0.728028    0.728028      0.734037      0.728028       0.725311

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.792361   0.809219   0.746713   0.746713    0.746713      0.739809      0.746713       0.733266
Iteration 1    0.787043   0.788504   0.738062   0.738062    0.738062      0.742065      0.738062       0.728174
Iteration 2    0.788017   0.791288   0.755363   0.755363    0.755363      0.734558      0.755363       0.738026
Iteration 3    0.803336   0.824108   0.739446   0.739446    0.739446      0.721183      0.739446       0.717590

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.755968   0.802486   0.746367   0.746367    0.746367      0.731117      0.746367       0.725724
Iteration 1    0.744663   0.767096   0.745329   0.745329    0.745329      0.741528      0.745329       0.736553
Iteration 2    0.762643   0.815697   0.733564   0.733564    0.733564      0.719107      0.733564       0.718930
Iteration 3    0.763634   0.814188   0.727336   0.727336    0.727336      0.716938      0.727336       0.712517

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.691270   0.760185   0.749827   0.749827    0.749827      0.733317      0.749827       0.734734
Iteration 1    0.683675   0.766103   0.740138   0.740138    0.740138      0.723082      0.740138       0.725640
Iteration 2    0.702867   0.794640   0.733564   0.733564    0.733564      0.715883      0.733564       0.720099
Iteration 3    0.700195   0.786254   0.742907   0.742907    0.742907      0.729449      0.742907       0.731616

