RESULTS REPORT
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 512
Batch size: 8
Dropout rate: 0.1
Learning rate: 1e-05
Freeze layers: False
Adam Epsilon: 1e-08
LR warmup: False
Use MLP: False
Weight decay: 0.001
Train time: 07h21m36s
GPU name: NVIDIA GeForce GTX 1080 Ti
GPU memory: 10.92

Averages:
Epoch Train loss    std    Test loss    std    P (micro)  P std  R (micro)  R std  F1 (micro)  F1 std P (weighted)  P std  R (weighted)  R std  F1 (weighted)  F1 std
   1   1.094920   0.007311  0.976906  0.011229   0.6961   0.0045   0.6961   0.0045   0.6961    0.0045    0.7014     0.0112    0.6961     0.0045     0.6774     0.0055
   2   0.990634   0.000901  1.032667  0.036898   0.6746   0.0150   0.6746   0.0150   0.6746    0.0150    0.6818     0.0103    0.6746     0.0150     0.6515     0.0171
   3   1.024873   0.004678  1.082172  0.027524   0.6605   0.0050   0.6605   0.0050   0.6605    0.0050    0.6684     0.0089    0.6605     0.0050     0.6396     0.0015
   4   1.002125   0.001510  1.074779  0.004702   0.6653   0.0022   0.6653   0.0022   0.6653    0.0022    0.6610     0.0052    0.6653     0.0022     0.6432     0.0033

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[865  24   0  72   0   4  10   0   6   2   1   1   1]
 [ 38  19   0   9   0   0   0   0   3   0   0   1   0]
 [ 17  19   1   1   0   0   0   0   0   0   0   0   0]
 [188   8   0 366   5   3   4   0   1   0   5   0   1]
 [ 12   0   0   1  36   0   1   0   1   0   0   0   0]
 [ 10   2   0   3   0 163   8   0   1   0   0   5   0]
 [ 50   1   0  17   0  25 411   0   1   0   4   0   0]
 [  8   2   0   0   0   0   0   0   2   0   0   0   0]
 [ 88   2   0   6   0   0   2   0  43   0   0   1   0]
 [ 61   0   0   1   0   0   0   0   1   6   0   3   0]
 [ 53   0   0  35   0   0   2   0   1   0  22   3   0]
 [ 18   0   0   1   0   2   2   0   0   1   0  68   0]
 [ 18   0   0   0   0   0   0   0   0   0   0   0  11]]
Epoch 2:
[[798  20   0 122   0   4   9   0  23   0   2   4   4]
 [ 36  16   0  11   0   0   1   0   4   0   0   2   0]
 [ 19  14   1   3   0   0   0   0   0   0   0   1   0]
 [142   5   0 404   5   3   5   0   4   0  10   1   2]
 [ 13   0   0   3  33   0   1   0   1   0   0   0   0]
 [ 10   2   0   2   1 170   4   0   1   0   0   2   0]
 [ 41   0   0  18   0  31 402   0  10   0   7   0   0]
 [  6   2   0   0   0   0   0   0   4   0   0   0   0]
 [ 71   1   0   7   0   2   3   0  56   0   1   1   0]
 [ 66   0   0   2   0   0   0   0   2   0   0   2   0]
 [ 51   0   0  28   0   0   2   0   4   0  30   1   0]
 [ 20   0   0   1   1   2   0   0   0   1   1  65   1]
 [ 14   0   0   0   0   0   0   0   1   0   0   0  14]]
Epoch 3:
[[795  17   0 135   5   3   8   0   1   8   0   8   6]
 [ 41  14   0  11   0   0   1   0   0   0   1   1   1]
 [ 19   9   1   5   0   0   0   0   0   2   0   2   0]
 [167   6   0 381   5   3   4   0   0   0   6   7   2]
 [ 13   0   0   3  33   0   2   0   0   0   0   0   0]
 [ 10   1   0   5   1 145  26   0   1   0   0   3   0]
 [ 50   0   0  24   0   9 417   0   1   0   4   4   0]
 [  8   2   0   0   0   0   0   0   2   0   0   0   0]
 [ 97   1   0   7   0   2   9   0  19   1   1   1   4]
 [ 56   0   0   2   0   0   0   0   0   9   0   5   0]
 [ 53   0   0  27   1   1   2   0   1   0  21  10   0]
 [ 14   0   0   2   0   2   1   0   0   4   0  68   1]
 [ 12   0   0   1   0   0   0   0   0   0   0   0  16]]
Epoch 4:
[[820  17   1 114   3   3  10   0   6   1   0   5   6]
 [ 41  14   1  10   0   0   2   0   0   0   0   1   1]
 [ 22   7   4   4   0   0   0   0   0   0   0   1   0]
 [195   5   0 352   5   3   9   0   0   0   6   4   2]
 [ 13   0   0   2  34   0   1   0   1   0   0   0   0]
 [ 13   2   0   2   1 148  24   0   1   0   0   1   0]
 [ 45   0   0  24   0  15 414   0   5   1   5   0   0]
 [  8   2   0   0   0   0   0   0   2   0   0   0   0]
 [ 88   1   0   7   0   1   9   0  31   0   0   1   4]
 [ 61   0   0   1   0   0   0   0   2   4   0   4   0]
 [ 55   0   0  31   1   0   4   0   5   0  16   4   0]
 [ 15   0   0   3   0   2   2   0   0   4   0  65   1]
 [ 14   0   0   1   0   0   0   0   0   0   0   0  14]]
=> Iteration 1:
Epoch 1:
[[733   8  26 146  10   7  20   0  23   2   2   2   7]
 [ 27  16   5  13   0   0   1   0   5   0   1   1   1]
 [ 11   7  16   2   0   0   0   0   0   2   0   0   0]
 [114   6  10 416   5   3  12   0   4   0   8   0   3]
 [  7   0   0   3  39   0   1   0   1   0   0   0   0]
 [  7   1   1   2   1 160  14   0   1   0   0   5   0]
 [ 20   1   0  14   0  13 447   0   9   0   3   0   2]
 [  7   2   0   0   0   0   0   0   3   0   0   0   0]
 [ 66   3   1   7   0   0   6   0  57   0   0   1   1]
 [ 49   0   2   5   0   0   3   0   3   7   0   3   0]
 [ 46   0   0  27   1   0   3   0   6   0  30   2   1]
 [ 11   0   0   0   0   1   3   0   0   3   0  73   1]
 [ 10   0   0   0   0   0   0   0   0   0   0   0  19]]
Epoch 2:
[[879  20   0  74   0   2   4   0   1   0   0   1   5]
 [ 40  17   0  10   0   0   0   0   0   0   0   1   2]
 [ 22  14   1   1   0   0   0   0   0   0   0   0   0]
 [234   2   3 323   4   1   3   0   0   0   7   2   2]
 [ 15   0   0   1  34   0   1   0   0   0   0   0   0]
 [ 34   3   0   5   0 135   9   0   0   0   0   6   0]
 [ 82   0   0  32   0  13 371   0   3   0   6   2   0]
 [  9   2   0   0   0   0   0   0   1   0   0   0   0]
 [114   1   0   6   0   0   4   0  15   0   0   1   1]
 [ 66   0   0   1   0   0   0   0   0   3   0   2   0]
 [ 61   0   0  24   1   0   1   0   1   0  24   3   1]
 [ 26   1   0   0   0   1   0   0   0   4   0  59   1]
 [ 14   0   0   0   0   0   0   0   0   0   0   0  15]]
Epoch 3:
[[738  36   0 115   5   3  16   0   3  36   7  25   2]
 [ 33  23   0   9   0   0   2   0   0   0   1   2   0]
 [ 12  17   1   4   0   0   0   0   0   2   0   2   0]
 [155  19   1 355   5   2  17   0   0   2  11  12   2]
 [ 10   0   0   2  37   0   1   0   0   1   0   0   0]
 [ 10   3   0   0   0 149  17   0   1   0   0  12   0]
 [ 35   2   0  18   0  14 427   0   1   2   5   5   0]
 [  7   2   0   0   0   0   0   0   2   1   0   0   0]
 [ 92   7   0   7   0   1  10   0  18   3   1   2   1]
 [ 44   2   0   0   0   0   0   0   0  20   0   6   0]
 [ 48   1   0  18   1   0   4   0   1   1  28  14   0]
 [  5   0   0   1   0   1   1   0   0   7   0  77   0]
 [ 16   0   0   1   0   0   0   0   0   0   0   1  11]]
Epoch 4:
[[790  16   0 134   5   5  12   0   9   2   4   4   5]
 [ 39  13   1  12   0   0   2   0   1   0   0   1   1]
 [ 22  11   0   4   0   0   0   0   0   1   0   0   0]
 [170   5   2 376   5   3   9   0   0   0   8   1   2]
 [ 12   0   0   3  33   0   2   0   1   0   0   0   0]
 [ 12   0   1   3   1 149  24   0   1   0   0   1   0]
 [ 46   0   0  24   0  14 415   0   5   0   4   1   0]
 [  7   2   0   0   0   0   0   0   3   0   0   0   0]
 [ 84   1   0   7   0   1  10   0  35   0   0   1   3]
 [ 59   0   0   1   0   0   0   0   2   7   0   3   0]
 [ 52   0   0  35   1   0   2   0   5   0  18   3   0]
 [ 16   0   0   4   0   2   1   0   0   3   0  66   0]
 [ 13   0   0   1   0   0   0   0   0   0   0   0  15]]
=> Iteration 2:
Epoch 1:
[[856  12   1 100   2   1   6   0   6   0   1   0   1]
 [ 40  13   0  13   0   0   1   0   2   0   0   1   0]
 [ 20  12   5   1   0   0   0   0   0   0   0   0   0]
 [170   3   2 391   4   2   2   0   1   0   5   0   1]
 [ 14   0   0   2  33   0   1   0   1   0   0   0   0]
 [ 33   2   0   2   0 132  15   0   3   0   1   4   0]
 [ 47   0   0  15   0   9 423   0  10   0   5   0   0]
 [  8   2   0   0   0   0   0   0   2   0   0   0   0]
 [ 81   1   0   8   0   0   1   0  49   0   1   1   0]
 [ 62   0   0   2   0   0   1   0   1   6   0   0   0]
 [ 63   1   0  30   0   0   1   0   1   0  20   0   0]
 [ 25   0   0   1   0   1   2   0   0   5   0  58   0]
 [ 22   0   0   0   0   0   0   0   0   0   0   0   7]]
Epoch 2:
[[858  13   3  77   0   2  11   0  12   0   2   3   5]
 [ 43   9   4  11   0   0   0   0   1   0   1   1   0]
 [ 20   5  10   2   0   0   0   0   0   0   0   1   0]
 [212   3   2 337   5   3   5   0   1   0   9   2   2]
 [ 15   0   0   1  33   0   1   0   1   0   0   0   0]
 [ 12   0   1   5   1 151  17   0   1   0   0   4   0]
 [ 40   0   0  20   0  10 426   0   7   0   5   0   1]
 [  8   2   0   0   0   0   0   0   2   0   0   0   0]
 [ 85   0   0   7   0   0   3   0  44   0   0   1   2]
 [ 66   0   0   1   0   0   1   0   2   0   0   2   0]
 [ 58   0   0  24   1   0   3   0   2   0  23   4   1]
 [ 26   0   0   1   1   2   2   0   0   0   0  60   0]
 [ 13   0   0   0   0   0   0   0   0   0   0   0  16]]
Epoch 3:
[[791  19   0 142   2   5  13   0   5   0   3   3   3]
 [ 41  14   0  13   0   0   1   0   0   0   0   1   0]
 [ 19  14   0   4   0   1   0   0   0   0   0   0   0]
 [161   7   1 380   4   5  11   0   1   0   8   1   2]
 [ 10   0   0   5  34   0   1   0   1   0   0   0   0]
 [ 13   1   0   1   1 150  24   0   1   0   0   1   0]
 [ 44   0   0  22   0  14 422   0   3   0   4   0   0]
 [  7   2   0   0   0   0   0   0   3   0   0   0   0]
 [ 84   3   0   9   0   1   8   0  33   0   0   1   3]
 [ 60   0   0   3   0   0   1   0   2   4   0   2   0]
 [ 53   0   0  34   1   0   5   0   3   0  16   4   0]
 [ 16   1   0   5   1   3   2   0   0   2   0  61   1]
 [ 16   0   0   1   0   0   0   0   0   0   0   0  12]]
Epoch 4:
[[791  15   0 137   2   5  11   0  10   1   4   5   5]
 [ 41  13   1  12   0   0   1   0   0   0   1   1   0]
 [ 21   7   3   5   0   0   0   0   0   0   0   2   0]
 [160   4   2 386   5   4   8   0   1   0   8   1   2]
 [ 13   0   0   3  33   0   1   0   1   0   0   0   0]
 [ 14   1   0   2   1 158  13   0   1   0   0   2   0]
 [ 46   0   0  25   1  17 407   0   6   0   6   1   0]
 [  7   2   0   0   0   0   0   0   3   0   0   0   0]
 [ 85   1   0   7   0   1   7   0  36   0   0   1   4]
 [ 58   0   0   3   0   0   0   0   3   5   0   3   0]
 [ 52   0   0  32   1   0   3   0   3   0  20   5   0]
 [ 14   0   0   4   0   3   1   0   0   4   0  65   1]
 [ 14   0   0   1   0   0   0   0   0   0   0   0  14]]
=> Iteration 3:
Epoch 1:
[[856  21   0  84   0   6   3   0  10   0   1   0   5]
 [ 33  20   0  11   0   0   1   0   3   0   0   1   1]
 [ 19  18   0   1   0   0   0   0   0   0   0   0   0]
 [176   5   0 381   4   3   2   0   0   0   6   1   3]
 [ 11   0   0   3  35   0   1   0   1   0   0   0   0]
 [  8   2   0   1   0 165  10   0   1   0   0   5   0]
 [ 49   0   0  16   0  15 417   0   8   0   2   0   2]
 [  8   2   0   0   0   0   0   0   2   0   0   0   0]
 [ 81   4   0   6   0   1   1   0  48   0   0   1   0]
 [ 67   0   0   2   0   0   0   0   0   0   0   3   0]
 [ 55   0   0  30   0   0   2   0   2   0  23   3   1]
 [ 20   0   0   0   0   2   0   0   0   0   0  70   0]
 [ 14   0   0   0   0   0   0   0   0   0   0   0  15]]
Epoch 2:
[[763  20   0 167   4   2   8   0   4   0   0   6  12]
 [ 32  18   0  17   0   0   1   0   0   0   0   1   1]
 [ 18  16   1   2   0   0   0   0   0   0   0   1   0]
 [121   8   1 430   5   2   4   0   0   0   5   2   3]
 [ 10   0   0   3  37   0   1   0   0   0   0   0   0]
 [ 16   2   0   2   1 148  17   0   1   0   0   5   0]
 [ 42   0   0  20   0   6 433   0   1   0   5   1   1]
 [  9   2   0   0   0   0   0   0   1   0   0   0   0]
 [ 93   2   0  11   0   1   7   0  23   0   0   1   4]
 [ 62   0   0   3   0   0   0   0   0   3   0   4   0]
 [ 48   0   0  38   1   0   3   0   1   0  18   6   1]
 [ 17   0   0   2   0   1   0   0   0   0   0  72   0]
 [  9   0   0   0   0   0   0   0   0   0   0   0  20]]
Epoch 3:
[[762  17   0 159   2   3   8   0  26   0   2   3   4]
 [ 37  14   0  12   0   0   2   0   4   0   0   1   0]
 [ 20  12   2   4   0   0   0   0   0   0   0   0   0]
 [138   5   0 412   4   2   4   0   8   0   5   1   2]
 [ 11   0   0   4  34   0   1   0   1   0   0   0   0]
 [ 11   2   0   5   1 144  26   0   1   0   0   2   0]
 [ 49   0   0  29   0   7 410   0  10   0   3   1   0]
 [  5   2   0   0   0   0   0   0   5   0   0   0   0]
 [ 74   1   0   6   0   1   7   0  51   0   0   1   1]
 [ 59   0   0   4   0   0   0   0   4   2   0   3   0]
 [ 49   0   0  42   1   0   2   0   8   0  12   2   0]
 [ 21   0   0   5   1   4   1   0   1   0   0  58   1]
 [ 11   0   0   1   0   0   0   0   3   0   0   0  14]]
Epoch 4:
[[791  16   0 136   3   3  10   0  10   4   3   6   4]
 [ 37  15   0  11   0   0   2   0   2   0   1   1   1]
 [ 19  11   1   4   0   0   0   0   0   2   0   1   0]
 [165   6   0 382   5   3   7   0   1   0   8   2   2]
 [ 12   0   0   3  34   0   1   0   1   0   0   0   0]
 [ 14   1   0   3   1 153  17   0   1   0   0   2   0]
 [ 42   0   0  25   0  18 411   0   5   0   4   3   1]
 [  7   2   0   0   0   0   0   0   3   0   0   0   0]
 [ 86   1   0   6   0   1   8   0  35   0   0   1   4]
 [ 57   0   0   3   0   0   0   0   3   6   0   3   0]
 [ 53   0   0  32   1   0   2   0   4   0  19   5   0]
 [ 18   0   0   3   0   2   1   0   0   2   0  66   0]
 [ 14   0   0   1   0   0   0   0   0   0   0   0  14]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.105280   0.980326   0.695848   0.695848    0.695848      0.719080      0.695848       0.675004
Iteration 1    1.091187   0.968873   0.696540   0.696540    0.696540      0.691083      0.696540       0.684466
Iteration 2    1.085666   0.993660   0.689619   0.689619    0.689619      0.702980      0.689619       0.669842
Iteration 3    1.097547   0.964765   0.702422   0.702422    0.702422      0.692344      0.702422       0.680202

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.990763   1.010705   0.688235   0.688235    0.688235      0.681447      0.688235       0.669699
Iteration 1    0.989467   1.093495   0.649135   0.649135    0.649135      0.676618      0.649135       0.623500
Iteration 2    0.990336   0.997294   0.680623   0.680623    0.680623      0.670863      0.680623       0.657523
Iteration 3    0.991968   1.029173   0.680277   0.680277    0.680277      0.698351      0.680277       0.655325

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.020974   1.080374   0.664014   0.664014    0.664014      0.675155      0.664014       0.639719
Iteration 1    1.031495   1.122295   0.651903   0.651903    0.651903      0.663199      0.651903       0.637910
Iteration 2    1.019994   1.044531   0.663322   0.663322    0.663322      0.656613      0.663322       0.638875
Iteration 3    1.027031   1.081490   0.662630   0.662630    0.662630      0.678690      0.662630       0.641929

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    1.001140   1.075668   0.662976   0.662976    0.662976      0.661408      0.662976       0.638730
Iteration 1    1.003788   1.070037   0.663322   0.663322    0.663322      0.652783      0.663322       0.641320
Iteration 2    1.000181   1.071332   0.668166   0.668166    0.668166      0.662847      0.668166       0.647131
Iteration 3    1.003391   1.082078   0.666782   0.666782    0.666782      0.666949      0.666782       0.645499

